{"version":3,"file":"edit-advanced-coupon.js","mappings":"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","sources":["webpack://edit_advanced_coupon/./src/cart_conditions/templates/condition_field_options.ts","webpack://edit_advanced_coupon/./src/cart_conditions/toggles.ts","webpack://edit_advanced_coupon/./src/helper.ts","webpack://edit_advanced_coupon/./src/cart_conditions/templates/condition_logic.ts","webpack://edit_advanced_coupon/./src/cart_conditions/templates/condition_group.ts","webpack://edit_advanced_coupon/./src/cart_conditions/groups.ts","webpack://edit_advanced_coupon/./src/cart_conditions/templates/logic.ts","webpack://edit_advanced_coupon/./src/cart_conditions/templates/product_category.ts","webpack://edit_advanced_coupon/./src/cart_conditions/templates/customer_logged_in_status.ts","webpack://edit_advanced_coupon/./src/cart_conditions/templates/customer_user_role.ts","webpack://edit_advanced_coupon/./src/cart_conditions/templates/disallowed_customer_user_role.ts","webpack://edit_advanced_coupon/./src/cart_conditions/templates/cart_quantity.ts","webpack://edit_advanced_coupon/./src/cart_conditions/fields.ts","webpack://edit_advanced_coupon/./src/cart_conditions/templates/cart_subtotal.ts","webpack://edit_advanced_coupon/./src/cart_conditions/scrapers.ts","webpack://edit_advanced_coupon/./src/cart_conditions/save.ts","webpack://edit_advanced_coupon/./src/cart_conditions/table.ts","webpack://edit_advanced_coupon/./src/cart_conditions/restrictions.ts","webpack://edit_advanced_coupon/./src/cart_conditions/tabs.ts","webpack://edit_advanced_coupon/./src/cart_conditions/index.ts","webpack://edit_advanced_coupon/./src/bogo_deals/templates/upsell.ts","webpack://edit_advanced_coupon/./src/bogo_deals/templates/combination_products.ts","webpack://edit_advanced_coupon/./src/bogo_deals/templates/category_first_column.ts","webpack://edit_advanced_coupon/./src/bogo_deals/templates/placeholder_row.ts","webpack://edit_advanced_coupon/./src/bogo_deals/templates/product_categories.ts","webpack://edit_advanced_coupon/./src/bogo_deals/templates/product_first_column.ts","webpack://edit_advanced_coupon/./src/bogo_deals/templates/specific_products.ts","webpack://edit_advanced_coupon/./src/bogo_deals/templates/any_products.ts","webpack://edit_advanced_coupon/./src/bogo_deals/toggles.ts","webpack://edit_advanced_coupon/./src/bogo_deals/save.ts","webpack://edit_advanced_coupon/./src/bogo_deals/templates/add_edit_row.ts","webpack://edit_advanced_coupon/./src/bogo_deals/templates/table_row.ts","webpack://edit_advanced_coupon/./src/bogo_deals/table.ts","webpack://edit_advanced_coupon/./src/bogo_deals/index.ts","webpack://edit_advanced_coupon/./src/toggle_fields.ts","webpack://edit_advanced_coupon/./src/url_coupons.ts","webpack://edit_advanced_coupon/./src/upsell.ts","webpack://edit_advanced_coupon/./src/help_modal/templates/links_list_template.ts","webpack://edit_advanced_coupon/./src/help_modal/templates/search_widget_template.ts","webpack://edit_advanced_coupon/./src/help_modal/templates/modal_template.ts","webpack://edit_advanced_coupon/./src/help_modal/templates/permission_template.ts","webpack://edit_advanced_coupon/./src/help_modal/templates/placeholder_template.ts","webpack://edit_advanced_coupon/./src/help_modal/templates/video_gallery_template.ts","webpack://edit_advanced_coupon/./src/help_modal/videos.ts","webpack://edit_advanced_coupon/./src/help_modal/modal.ts","webpack://edit_advanced_coupon/./src/help_modal/templates/error_template.ts","webpack://edit_advanced_coupon/./src/help_modal/search.ts","webpack://edit_advanced_coupon/./src/help_modal/permission.ts","webpack://edit_advanced_coupon/./src/help_modal/index.ts","webpack://edit_advanced_coupon/./src/index.ts"],"sourcesContent":["declare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\ninterface IFieldGroup {\r\n  group: string;\r\n  label: string;\r\n}\r\n\r\ninterface IConditionFieldOption {\r\n  key: string;\r\n  group: string;\r\n  title: string;\r\n}\r\n\r\nexport default function conditionFieldOptionsTemplate() {\r\n  const {\r\n    cart_condition_fields,\r\n    cart_condition_field_groups: fieldGroups,\r\n    product_table_buttons: btnLabels,\r\n    add_new_and_rule,\r\n  } = acfw_edit_coupon;\r\n\r\n  const conditionFields = Object.keys(cart_condition_fields).map(\r\n    (key) => cart_condition_fields[key]\r\n  );\r\n\r\n  return `\r\n    <div class=\"condition-group-actions\">\r\n      <div class=\"add-condition-form\" style=\"display: none;\">\r\n        <select class=\"condition-types\" data-placeholder=\"Search/select condition fields\">\r\n          <option value=\"\">Search</option>\r\n          ${fieldGroups\r\n            .map((f: IFieldGroup) =>\r\n              conditionFieldGroupTemplate(f, conditionFields)\r\n            )\r\n            .join(\"\")}\r\n        </select>\r\n        <button type=\"button\" class=\"add-condition-field button-primary\">${\r\n          btnLabels.add\r\n        }</button>\r\n        <button type=\"button\" class=\"cancel-add-condition-field button\">${\r\n          btnLabels.cancel\r\n        }</button>\r\n      </div>\r\n      <button type=\"button\" class=\"add-condition-trigger button\">\r\n        <i class=\"dashicons dashicons-plus\"></i>\r\n        ${add_new_and_rule}\r\n      </button>\r\n    </div>\r\n  `;\r\n}\r\n\r\nfunction conditionFieldGroupTemplate(\r\n  fieldGroup: IFieldGroup,\r\n  conditionFields: IConditionFieldOption[]\r\n) {\r\n  const { group, label } = fieldGroup;\r\n  const matchedFields = conditionFields.filter(\r\n    (c: IConditionFieldOption) =>\r\n      c.group === group || (group === \"others\" && c.group === undefined)\r\n  );\r\n\r\n  if (!matchedFields.length) return;\r\n\r\n  return `\r\n    <optgroup label=\"${label}\">\r\n      ${matchedFields\r\n        .map((c) => `<option value=\"${c.key}\">${c.title}</option>`)\r\n        .join(\"\")}\r\n    </optgroup>\r\n  `;\r\n}\r\n\r\nexport function enhanceConditionFieldSelector() {\r\n  jQuery(\"select.condition-types\").select2();\r\n}\r\n","import { enhanceConditionFieldSelector } from \"./templates/condition_field_options\";\r\n\r\ndeclare var jQuery: any;\r\nconst $ = jQuery;\r\nconst module_block: HTMLElement = document.querySelector(\r\n  \"#acfw_cart_conditions\"\r\n);\r\n\r\n/**\r\n * Toggle add condition form.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function toggle_add_condition_form(): void {\r\n  const $button: JQuery = $(this),\r\n    $condition_actions: JQuery = $button.closest(\"div.condition-group-actions\");\r\n\r\n  if ($button.hasClass(\"add-condition-trigger\")) {\r\n    $condition_actions.find(\".add-condition-form\").show();\r\n    enhanceConditionFieldSelector();\r\n    $button.hide();\r\n  } else {\r\n    $condition_actions.find(\".add-condition-form\").hide();\r\n    $condition_actions.find(\".add-condition-trigger\").show();\r\n  }\r\n}\r\n\r\n/**\r\n * Toggle editing mode.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function toggle_editing_mode(toggle: boolean): void {\r\n  $(module_block).data(\"editing\", toggle);\r\n  $(module_block).find(\"#save-cart-conditions\").prop(\"disabled\", !toggle);\r\n}\r\n\r\n/**\r\n * Populate custom taxonomy options.\r\n *\r\n * @since 1.4\r\n */\r\nexport function popuplate_taxonomy_term_options() {\r\n  const $taxonomy: JQuery = $(this),\r\n    $condition_block: JQuery = $taxonomy.closest(\".condition-field\"),\r\n    $tax_terms: JQuery = $condition_block.find(\"select.condition-value\"),\r\n    taxonomy: string = $taxonomy.val() + \"\",\r\n    terms: any[] = $condition_block.data(\"selected_terms\"),\r\n    tax_options: any[] = $(module_block).data(\"custom_tax_options\"),\r\n    taxonomy_data: any[] = tax_options.filter((t) => t.slug == taxonomy),\r\n    taxonomy_terms: any[] = taxonomy_data.length ? taxonomy_data[0].terms : [];\r\n\r\n  $tax_terms.val(null).find(\"option\").remove();\r\n\r\n  if (!taxonomy_terms.length) return;\r\n\r\n  for (let term of taxonomy_terms) {\r\n    let { name, term_id } = term;\r\n    let optionObj: HTMLOptionElement = new Option(name, term_id);\r\n    $tax_terms.append(optionObj);\r\n  }\r\n\r\n  $tax_terms.val(terms).trigger(\"change\");\r\n}\r\n\r\n/**\r\n * Populate shipping zone region options.\r\n *\r\n * @since 1.4\r\n */\r\nexport function popuplate_shipping_region_options() {\r\n  const $shipping_zone: JQuery = $(this),\r\n    $condition_block: JQuery = $shipping_zone.closest(\".condition-field\"),\r\n    $shipping_region: JQuery = $condition_block.find(\"select.condition-value\"),\r\n    zone_id: string = $shipping_zone.val() + \"\";\r\n\r\n  if (!zone_id) return;\r\n\r\n  const regions: any = $condition_block.data(\"regions\"),\r\n    region_labels: any = $(module_block).data(\"shipping_regions\"),\r\n    region_options: any = $condition_block.data(\"zones\")[zone_id][\"regions\"];\r\n\r\n  $shipping_region.val(null).find(\"option\").remove();\r\n\r\n  if (typeof region_options != \"object\" || !region_options.length) return;\r\n\r\n  for (let code of region_options) {\r\n    const optionObj: HTMLOptionElement = new Option(region_labels[code], code);\r\n    $shipping_region.append(optionObj);\r\n  }\r\n\r\n  $shipping_region.val(regions).trigger(\"change\");\r\n}\r\n","declare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\n/**\r\n * Toggle overlay block.\r\n *\r\n * @since 1.0.0\r\n *\r\n * @param object overlay Overlay html element.\r\n * @param string type    Toggle type (show/hide).\r\n */\r\nexport function toggle_overlay(overlay: HTMLElement, type: string = \"\"): void {\r\n  if (!type) type = \"show\";\r\n\r\n  let display = type === \"show\" ? \"block\" : \"none\";\r\n  jQuery(overlay).css(\"display\", display);\r\n}\r\n\r\n/**\r\n * Escape string to be used on an attribute.\r\n *\r\n * @since 1.0.0\r\n * @param string text String to escape.\r\n */\r\nexport function esc_attr(text: string): string {\r\n  const map: any = {\r\n    \"&\": \"&amp;\",\r\n    \"<\": \"&lt;\",\r\n    \">\": \"&gt;\",\r\n    '\"': \"&quot;\",\r\n    \"'\": \"&#039\",\r\n  };\r\n\r\n  return text.replace(/[&<>\"']/g, (m) => map[m]);\r\n}\r\n\r\n/**\r\n * Remove leading zeros from an input field.\r\n *\r\n * @since 1.2\r\n */\r\nexport function remove_leading_zeros() {\r\n  const { decimal_separator } = acfw_edit_coupon;\r\n\r\n  const $input: JQuery = jQuery(this);\r\n  let value: string = $input.val() + \"\";\r\n\r\n  if (value == \"0\" + decimal_separator) $input.val(\"0\");\r\n  if (value == \"0\" || value.substring(0, 2) == \"0\" + decimal_separator) return;\r\n\r\n  value = value.replace(/^0+/, \"\");\r\n  value = value.substring(0, 1) == decimal_separator ? \"0\" + value : value;\r\n\r\n  $input.val(value);\r\n}\r\n\r\n/**\r\n * Array to select options markup.\r\n *\r\n * @param options\r\n * @param value\r\n * @param key\r\n * @param label\r\n */\r\nexport function array_to_select_options(\r\n  options: any,\r\n  value: string,\r\n  key: string = \"value\",\r\n  label: string = \"label\"\r\n): string {\r\n  return options\r\n    .map(\r\n      (option: any) =>\r\n        `<option value=\"${option[key]}\" ${\r\n          option[key] == value ? \"selected\" : \"\"\r\n        }>${option[label]}</option>`\r\n    )\r\n    .toString()\r\n    .replace(/>,</g, \"><\");\r\n}\r\n\r\n/**\r\n * Get allowed minimum value.\r\n *\r\n * @since 1.0.0\r\n * @since 1.2   Remove unused property.\r\n *\r\n * @param {string} condition\r\n */\r\nexport function get_allowed_minimum_value(condition: string): number {\r\n  return condition == \"<\" ? 1 : 0;\r\n}\r\n\r\n/**\r\n * Compare option values to mark option as selected.\r\n *\r\n * @param value_1\r\n * @param value_2\r\n */\r\nexport function selected(value_1: string, value_2: string) {\r\n  return value_1 == value_2 ? \"selected\" : \"\";\r\n}\r\n\r\nexport function selected_multiple(array: any[], value: string) {\r\n  return array.indexOf(value) >= 0 ? \"selected\" : \"\";\r\n}\r\n\r\n/**\r\n * Get discount type select options markup.\r\n *\r\n * @since 1.15\r\n *\r\n * @param value\r\n */\r\nexport function discount_type_options(\r\n  value: string = \"\",\r\n  show_nodiscount: boolean = false\r\n): string {\r\n  const { nodiscount, override, percent, fixed } =\r\n    acfw_edit_coupon.discount_field_options;\r\n  const nodiscount_markup = `<option value=\"nodiscount\" ${selected(\r\n    value,\r\n    \"nodiscount\"\r\n  )}>= : ${nodiscount}</option>`;\r\n\r\n  return `\r\n        ${show_nodiscount ? nodiscount_markup : \"\"}\r\n        <option value=\"override\" ${selected(\r\n          value,\r\n          \"override\"\r\n        )}>$ : ${override}</option>\r\n        <option value=\"percent\" ${selected(\r\n          value,\r\n          \"percent\"\r\n        )}>% : ${percent}</option>\r\n        <option value=\"fixed\" ${selected(value, \"fixed\")}>-$ : ${fixed}</option>\r\n    `;\r\n}\r\n\r\n/**\r\n * Get condition options markup.\r\n *\r\n * @sinc 1.15\r\n * @param condition\r\n */\r\nexport function condition_options(condition: string = \"\"): string {\r\n  const { exactly, anyexcept, morethan, lessthan } =\r\n    acfw_edit_coupon.condition_field_options;\r\n\r\n  return `\r\n        <option value=\"=\" ${selected(condition, \"=\")}>${exactly}</option>\r\n        <option value=\"!=\" ${selected(condition, \"!=\")}>${anyexcept}</option>\r\n        <option value=\">\" ${selected(condition, \">\")}>${morethan}</option>\r\n        <option value=\"<\" ${selected(condition, \"<\")}>${lessthan}</option>\r\n    `;\r\n}\r\n\r\n/**\r\n * Validate url.\r\n *\r\n * @since 1.15\r\n */\r\nexport function validate_url(url: string): boolean {\r\n  const pattern =\r\n    /(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-\\/]))?/;\r\n\r\n  return pattern.test(url);\r\n}\r\n\r\n/**\r\n * Format price string to float.\r\n *\r\n * @since 1.3.3\r\n */\r\nexport function price_to_float(price: string): number {\r\n  const { decimal_separator } = acfw_edit_coupon;\r\n  return parseFloat(price.replace(decimal_separator, \".\"));\r\n}\r\n\r\n/**\r\n * Validate discount value by type.\r\n * Make sure that percent and fixed type discounts is not valid when value is not greater than 0.\r\n *\r\n * @param type\r\n * @param value\r\n * @returns\r\n */\r\nexport function validateDiscount(type: string, value: string): boolean {\r\n  if (\"percent\" === type || \"fixed\" === type) {\r\n    return 0 < price_to_float(value);\r\n  }\r\n\r\n  return true;\r\n}\r\n","import { selected } from \"../../helper\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\n\r\n/**\r\n * Return logic template markup.\r\n * \r\n * @since 1.15\r\n */\r\nexport default function condition_logic_template( value: string = \"\" ): string {\r\n\r\n    const { logic_field_options } = acfw_edit_coupon;\r\n    const { and , or } = logic_field_options;\r\n    \r\n    return `\r\n        <div class=\"condition-group-logic\">\r\n            <div class=\"field-control\">\r\n                <select class=\"cgroup-logic\">\r\n                    <option value=\"and\" ${ selected( value , \"and\" ) }>${ and }</option>\r\n                    <option value=\"or\" ${ selected( value , \"or\" ) }>${ or }</option>\r\n                </select>\r\n            </div>\r\n        </div>\r\n    `;\r\n}","import conditionFieldOptionsTemplate from \"./condition_field_options\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\n/**\r\n * Return condition group template markup.\r\n *\r\n * @since 1.15\r\n */\r\nexport default function condition_group_template(\r\n  fields_markup: string = \"\"\r\n): string {\r\n  const { empty_cart_conditions_field } = acfw_edit_coupon;\r\n  const cgroup_actions: string = conditionFieldOptionsTemplate();\r\n  const empty_conditions_markup: string = `<div class=\"empty-conditions\">${empty_cart_conditions_field}</div>`;\r\n\r\n  return `\r\n        <div class=\"condition-group ${!fields_markup ? \"new\" : \"\"}\">\r\n            <a class=\"remove-condition-group\" href=\"javascript:void(0);\">\r\n                <i class=\"dashicons dashicons-trash\"></i>\r\n            </a>\r\n            <div class=\"condition-group-fields\">\r\n                ${fields_markup ? fields_markup : empty_conditions_markup}\r\n            </div>\r\n            ${cgroup_actions}\r\n        </div>\r\n    `;\r\n}\r\n","import { toggle_editing_mode } from \"./toggles\";\r\nimport condition_logic_template from \"./templates/condition_logic\";\r\nimport condition_group_template from \"./templates/condition_group\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\nvar $: any = jQuery;\r\n\r\n/**\r\n * Add condition group callback.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function add_condition_group() {\r\n  const condition_groups: HTMLElement = document.querySelector(\r\n    \"#acfw_cart_conditions .condition-data-wrap .condition-groups\"\r\n  );\r\n\r\n  if ($(condition_groups).find(\".condition-group\").length)\r\n    $(condition_groups).append(condition_logic_template(\"or\"));\r\n\r\n  $(condition_groups).find(\".no-condition-group\").remove();\r\n  $(condition_groups).append(condition_group_template());\r\n\r\n  $(this).blur();\r\n  $(condition_groups)\r\n    .find(\".condition-group.new .add-condition-trigger\")\r\n    .trigger(\"click\");\r\n  $(condition_groups).find(\".condition-group\").removeClass(\"new\");\r\n\r\n  toggle_editing_mode(true);\r\n}\r\n\r\n/**\r\n * Remove condition group callback.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function remove_condition_group() {\r\n  const $button: JQuery = $(this),\r\n    module_block: HTMLElement = document.querySelector(\"#acfw_cart_conditions\"),\r\n    $condition_group: JQuery = $button.closest(\".condition-group\"),\r\n    $cgroup_logic: JQuery =\r\n      $condition_group.index() == 0\r\n        ? $condition_group.next(\".condition-group-logic\")\r\n        : $condition_group.prev(\".condition-group-logic\");\r\n\r\n  const { no_condition_group_msg } = acfw_edit_coupon;\r\n\r\n  $condition_group.remove();\r\n  $cgroup_logic.remove();\r\n\r\n  if ($(module_block).find(\".condition-group\").length < 1) {\r\n    $(module_block).find(\".condition-groups\").append(`\r\n            <div class=\"no-condition-group\">\r\n                ${no_condition_group_msg}\r\n            </div>\r\n        `);\r\n  }\r\n\r\n  toggle_editing_mode(true);\r\n}\r\n","import { selected } from \"../../helper\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\n\r\n/**\r\n * Return logic template markup.\r\n * \r\n * @since 1.15 \r\n * \r\n * @param data \r\n */\r\nexport default function logic_template( value: string = \"\" ): string {\r\n\r\n    const { logic_field_options } = acfw_edit_coupon;\r\n    const { and , or } = logic_field_options;\r\n\r\n    return `<div class=\"logic-condition-field condition-field\" data-type=\"logic\">\r\n        <div class=\"field-control\">\r\n            <select class=\"condition-logic\">\r\n                <option value=\"and\" ${ selected( value , \"and\" ) }>${ and }</option>\r\n                <option value=\"or\" ${ selected( value , \"or\" ) }>${ or }</option>\r\n            </select>\r\n        </div>\r\n    </div>`;\r\n}","import { selected_multiple } from \"../../helper\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\nconst { cart_condition_fields , condition_field_options } = acfw_edit_coupon;\r\n\r\n/**\r\n * Return product category condition field template markup.\r\n * \r\n * @since 1.15 \r\n * \r\n * @param data \r\n */\r\nexport default function product_category_template( data: any ): string {\r\n\r\n    const { value: categories , condition , quantity } = data;\r\n    const { title, placeholder, field } = cart_condition_fields.product_category;\r\n    const { field: quantityLabel } = cart_condition_fields.cart_quantity;\r\n    const { condition_label } = acfw_edit_coupon;\r\n    const { exactly, anyexcept, morethan, lessthan } = condition_field_options;\r\n\r\n    const condOption = condition ? condition : \">\";\r\n\r\n    return `\r\n    <div class=\"product-category-field condition-field\" data-type=\"product-category\">\r\n        <a class=\"remove-condition-field\" href=\"javascript:void(0);\"><i class=\"dashicons dashicons-trash\"></i></a>\r\n        <h3 class=\"condition-field-title\">${ title }</h3>\r\n        <div class=\"field-control categories\">\r\n            <label>${ field }</label>\r\n            <select class=\"condition-value wc-enhanced-select\" multiple data-placeholder=\"${ placeholder }\">\r\n                ${ category_options( categories ) }\r\n            </select>\r\n        </div>\r\n        <div class=\"field-control condition\">\r\n            <label>${ condition_label }</label>\r\n            <select class=\"condition-select\">\r\n                <option value=\"=\" ${ condOption == \"=\" ? \"selected\" : \"\" }>${ exactly }</option>\r\n                <option value=\"!=\" ${ condOption == \"!=\" ? \"selected\" : \"\" }>${ anyexcept }</option>\r\n                <option value=\">\" ${ condOption == \">\" ? \"selected\" : \"\" }>${ morethan }</option>\r\n                <option value=\"<\" ${ condOption == \"<\" ? \"selected\" : \"\" }>${ lessthan }</option>\r\n            </select>\r\n        </div>\r\n        <div class=\"field-control quantity\">\r\n            <label>${ quantityLabel }</label>\r\n            <input type=\"number\" class=\"condition-quantity\" value=\"${ typeof quantity ? quantity : 0 }\" min=\"${ condition == \"<\" ? 1 : 0 }\">\r\n        </div>\r\n    </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Get category options markup.\r\n * \r\n * @since 1.15\r\n * \r\n * @param data \r\n */\r\nfunction category_options( data: number[] = [] ): string {\r\n\r\n    const { options } = cart_condition_fields.product_category;\r\n    let markup: string = '';\r\n\r\n    for ( let x in options ) {\r\n        markup += `<option value=\"${ x }\" ${ selected_multiple( data , x ) }>${ options[x] }</option>`\r\n    }\r\n        \r\n    return markup;\r\n}","import { selected } from \"../../helper\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\nconst { cart_condition_fields } = acfw_edit_coupon;\r\n\r\n/**\r\n * Return customer logged in status condition field template markup.\r\n * \r\n * @since 1.15 \r\n * \r\n * @param data \r\n */\r\nexport default function customer_logged_in_status_template( data:string ): string {\r\n\r\n    const { title } = cart_condition_fields.customer_logged_in_status;\r\n\r\n    return `\r\n        <div class=\"customer-logged-in-status-field condition-field\" data-type=\"customer-logged-in-status\">\r\n\r\n        <a class=\"remove-condition-field\" href=\"javascript:void(0);\"><i class=\"dashicons dashicons-trash\"></i></a>\r\n\r\n        <h3 class=\"condition-field-title\">${ title }</h3>\r\n\r\n        <div class=\"field-control\">\r\n            <select class=\"condition-value\">\r\n                ${ get_options( data ) }\r\n            </select>\r\n        </div>\r\n    </div>`;\r\n}\r\n\r\n/**\r\n * Get condition field options.\r\n * \r\n * @since 1.15 \r\n * \r\n * @param data \r\n */\r\nfunction get_options( data: string ): string {\r\n\r\n    const { options } = cart_condition_fields.customer_logged_in_status;\r\n    let markup = '';\r\n\r\n    for ( let x in options ) {\r\n        markup += `<option value=\"${ x }\" ${ selected( x , data ) }>${ options[ x ] }</option>`;\r\n    }\r\n\r\n    return markup;\r\n}","import { selected_multiple } from \"../../helper\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\nconst { cart_condition_fields } = acfw_edit_coupon;\r\n\r\n/**\r\n * Return customer user role condition field template markup.\r\n * \r\n * @since 1.15 \r\n * \r\n * @param data \r\n */\r\nexport default function customer_user_role_template( data: string[] ): string {\r\n\r\n    const { title , placeholder } = cart_condition_fields.customer_user_role;\r\n\r\n    return `\r\n        <div class=\"customer-user-role-field condition-field\" data-type=\"customer-user-role\">\r\n            <a class=\"remove-condition-field\" href=\"javascript:void(0);\"><i class=\"dashicons dashicons-trash\"></i></a>\r\n            <h3 class=\"condition-field-title\">${ title }</h3>\r\n            <div class=\"field-control\">\r\n                <select class=\"wc-enhanced-select condition-value\" multiple data-placeholder=\"${ placeholder }\">\r\n                    ${ get_options( data ) }\r\n                </select>\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Get condition field options markup.\r\n * \r\n * @since 1.15\r\n * \r\n * @param data \r\n */\r\nfunction get_options( data: string[] ) {\r\n\r\n    const { user_role_options } = acfw_edit_coupon;\r\n    let markup = '';\r\n    \r\n    for ( let x in user_role_options )\r\n        markup += `<option value=\"${ x }\" ${ selected_multiple( data , x ) }>${ user_role_options[x] }</option>`;\r\n\r\n    return markup;\r\n}","import { selected_multiple } from \"../../helper\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\nconst { cart_condition_fields } = acfw_edit_coupon;\r\n\r\n/**\r\n * Return disallowed customer user role condition field template markup.\r\n * \r\n * @since 1.15 \r\n * \r\n * @param data \r\n */\r\nexport default function disallowed_customer_user_role_template( data: string[] ): string {\r\n\r\n    const { title , placeholder } = cart_condition_fields.disallowed_customer_user_role;\r\n\r\n    return `\r\n        <div class=\"disallowed-customer-user-role-field condition-field\" data-type=\"disallowed-customer-user-role\">\r\n            <a class=\"remove-condition-field\" href=\"javascript:void(0);\"><i class=\"dashicons dashicons-trash\"></i></a>\r\n            <h3 class=\"condition-field-title\">${ title }</h3>\r\n            <div class=\"field-control\">\r\n                <select class=\"wc-enhanced-select condition-value\" multiple data-placeholder=\"${ placeholder }\">\r\n                    ${ get_options( data ) }\r\n                </select>\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Get condition field options markup.\r\n * \r\n * @since 1.15\r\n * \r\n * @param data\r\n */\r\nfunction get_options( data: string[] ) {\r\n\r\n    const { user_role_options } = acfw_edit_coupon;\r\n    let markup = '';\r\n    \r\n    for ( let x in user_role_options )\r\n        markup += `<option value=\"${ x }\" ${ selected_multiple( data , x ) }>${ user_role_options[x] }</option>`;\r\n\r\n    return markup;\r\n}","import { condition_options } from \"../../helper\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\nconst { cart_condition_fields } = acfw_edit_coupon;\r\n\r\n/**\r\n * Return cart quantity condition field template markup.\r\n * \r\n * @since 1.15 \r\n * \r\n * @param data \r\n */\r\nexport default function cart_quantity_template( data: any ): string {\r\n\r\n    const { condition , value } = data;\r\n    const { title, desc, field } = cart_condition_fields.cart_quantity;\r\n    const { condition_label } = acfw_edit_coupon;\r\n\r\n    return `\r\n    <div class=\"cart-quantity-field condition-field\" data-type=\"cart-quantity\">\r\n        <a class=\"remove-condition-field\" href=\"javascript:void(0);\"><i class=\"dashicons dashicons-trash\"></i></a>\r\n        <h3 class=\"condition-field-title\">${ title }</h3>\r\n        <label>${ desc }</label>\r\n        <div class=\"field-control\">\r\n            <label>${ condition_label }</label>\r\n            <select class=\"condition-select\">\r\n                ${ condition_options( condition ) }\r\n            </select>\r\n        </div>\r\n        <div class=\"field-control\">\r\n            <label>${ field }</label>\r\n            <input class=\"condition-value\" type=\"number\" min=\"0\" value=\"${ value >= 0 ? value : \"\" }\">\r\n        </div>\r\n    </div>\r\n    `;\r\n}","import { toggle_overlay } from \"../helper\";\r\nimport { toggle_editing_mode } from \"./toggles\";\r\n\r\n// templates\r\nimport logic_template from \"./templates/logic\";\r\nimport product_category_template from \"./templates/product_category\";\r\nimport customer_logged_in_status_template from \"./templates/customer_logged_in_status\";\r\nimport customer_user_role_template from \"./templates/customer_user_role\";\r\nimport disallowed_customer_user_role_template from \"./templates/disallowed_customer_user_role\";\r\nimport cart_quantity_template from \"./templates/cart_quantity\";\r\nimport cart_subtotal_template from \"./templates/cart_subtotal\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\ndeclare var vex: any;\r\n\r\nconst $: any = jQuery;\r\nconst { cart_condition_fields, upsell } = acfw_edit_coupon;\r\n\r\n/**\r\n * Add condition field.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function add_condition_field(): void {\r\n  const $button: JQuery = $(this),\r\n    $condition_type: JQuery = $button\r\n      .closest(\".condition-group-actions\")\r\n      .find(\"select.condition-types\"),\r\n    $condition_group: JQuery = $button.closest(\".condition-group\"),\r\n    $condition_fields: JQuery = $condition_group.find(\r\n      \".condition-group-fields\"\r\n    ),\r\n    overlay: HTMLElement = document.querySelector(\r\n      \"#acfw_cart_conditions .acfw-overlay\"\r\n    );\r\n  const premiumConditions: string[] = $(\"#acfw_cart_conditions\").data(\r\n    \"premium-conditions\"\r\n  );\r\n\r\n  const condition_type: string = $condition_type.val() + \"\";\r\n  const fields_count: number = $condition_fields.find(\r\n    \".condition-field,.condition-set\"\r\n  ).length;\r\n\r\n  toggle_overlay(overlay, \"show\");\r\n\r\n  if (premiumConditions && premiumConditions.indexOf(condition_type) > -1) {\r\n    // upsell\r\n    vex.dialog.alert({ unsafeMessage: upsell.cart_condition_field });\r\n  } else {\r\n    const condition_field_markup: string = get_condition_field(\r\n      condition_type,\r\n      null,\r\n      fields_count\r\n    );\r\n\r\n    if (condition_field_markup) {\r\n      $condition_fields.find(\".empty-conditions\").remove();\r\n      $condition_fields.show().append(condition_field_markup);\r\n      $condition_fields\r\n        .find(`.${condition_type}-field`)\r\n        .find(\"input,select\")\r\n        .trigger(\"change\");\r\n      $(\"body\").trigger(\"wc-enhanced-select-init\");\r\n\r\n      toggle_editing_mode(true);\r\n    } else vex.dialog.alert(acfw_edit_coupon.fail_add_condition_field);\r\n  }\r\n\r\n  toggle_overlay(overlay, \"hide\");\r\n\r\n  $condition_group.find(\".condition-group-actions .add-condition-form\").hide();\r\n  $condition_group\r\n    .find(\".condition-group-actions .add-condition-trigger\")\r\n    .show();\r\n}\r\n\r\n/**\r\n * Remove condition field.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function remove_condition_field(): void {\r\n  const $button: JQuery = $(this),\r\n    $condition_field: JQuery = $button.closest(\r\n      \".condition-field,.condition-set\"\r\n    ),\r\n    $condition_group: JQuery = $condition_field.closest(\".condition-group\"),\r\n    $cfield_logic: JQuery =\r\n      $condition_field.index() == 0\r\n        ? $condition_field.next(\".logic-condition-field\")\r\n        : $condition_field.prev(\".logic-condition-field\");\r\n\r\n  const { empty_cart_conditions_field } = acfw_edit_coupon;\r\n\r\n  $condition_field.remove();\r\n  $cfield_logic.remove();\r\n\r\n  if ($condition_group.find(\".condition-field,.condition-set\").length < 1) {\r\n    $condition_group.find(\".condition-group-fields\").append(`\r\n            <div class=\"empty-conditions\">\r\n                ${empty_cart_conditions_field}\r\n            </div>\r\n        `);\r\n  }\r\n\r\n  toggle_editing_mode(true);\r\n}\r\n\r\n/**\r\n * Get condition field markup.\r\n *\r\n * @param condition_type string\r\n * @param fields_count number\r\n * @return string\r\n */\r\nexport function get_condition_field(\r\n  condition_type: string,\r\n  data: any = null,\r\n  fields_count: number = 0\r\n): string {\r\n  let markup: string = \"\";\r\n  switch (condition_type) {\r\n    case \"product-category\":\r\n      data = data ? data : {};\r\n\r\n      // if data is an array (old format) then we build\r\n      if (data.length) data = { condition: \">\", value: data, quantity: 0 };\r\n\r\n      markup += product_category_template(data);\r\n      break;\r\n\r\n    case \"customer-logged-in-status\":\r\n      markup += customer_logged_in_status_template(data);\r\n      break;\r\n\r\n    case \"customer-user-role\":\r\n      data = data ? data : [];\r\n      markup += customer_user_role_template(data);\r\n      break;\r\n\r\n    case \"disallowed-customer-user-role\":\r\n      data = data ? data : [];\r\n      markup += disallowed_customer_user_role_template(data);\r\n      break;\r\n\r\n    case \"cart-quantity\":\r\n      data = data ? data : {};\r\n      markup += cart_quantity_template(data);\r\n      break;\r\n\r\n    case \"cart-subtotal\":\r\n      data = data ? data : {};\r\n      markup += cart_subtotal_template(data);\r\n      break;\r\n\r\n    default:\r\n      const field_key: string = condition_type.replace(/-/g, \"_\");\r\n      if (cart_condition_fields[field_key]) {\r\n        const { template_callback, default_data_value } =\r\n          cart_condition_fields[field_key];\r\n        if (default_data_value) data = data ? data : default_data_value;\r\n\r\n        if (template_callback) markup += template_callback(data, field_key);\r\n      }\r\n      break;\r\n  }\r\n\r\n  return markup && fields_count ? logic_template() + markup : markup;\r\n}\r\n\r\n/**\r\n * Check if condition field type is supported.\r\n *\r\n * @param type string\r\n */\r\nexport function is_condition_field(type: string) {\r\n  return acfw_edit_coupon.cart_conditon_field_options.indexOf(type) > -1;\r\n}\r\n","import { condition_options } from \"../../helper\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\n\r\n/**\r\n * Return cart subtotal condition field template markup.\r\n *\r\n * @since 1.15\r\n *\r\n * @param data\r\n */\r\nexport default function cart_subtotal_template(data: any): string {\r\n  const { condition, value } = data;\r\n  const { cart_condition_fields, condition_label } = acfw_edit_coupon;\r\n  const { title, desc, field } = cart_condition_fields.cart_subtotal;\r\n\r\n  return `\r\n    <div class=\"cart-subtotal-field condition-field\" data-type=\"cart-subtotal\">\r\n        <a class=\"remove-condition-field\" href=\"javascript:void(0);\"><i class=\"dashicons dashicons-trash\"></i></a>\r\n        <h3 class=\"condition-field-title\">${title}</h3>\r\n        <label>${desc}</label>\r\n        <div class=\"field-control\">\r\n            <label>${condition_label}</label>\r\n            <select class=\"condition-select\">\r\n                ${condition_options(condition)}\r\n            </select>\r\n        </div>\r\n        <div class=\"field-control\">\r\n            <label>${field}</label>\r\n            <input class=\"condition-value wc_input_price\" type=\"text\" value=\"${\r\n              value ? value : \"\"\r\n            }\">\r\n        </div>\r\n    </div>\r\n    `;\r\n}\r\n","declare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\nconst $: any = jQuery;\r\nconst { cart_condition_fields } = acfw_edit_coupon;\r\n\r\n/**\r\n * Scrape condition group data.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function scrape_condition_group_data(condition_group: Element): any {\r\n  const condition_fields: NodeList = condition_group.querySelectorAll(\r\n    \".condition-set,.condition-field\"\r\n  );\r\n  let fields: any[] = [];\r\n\r\n  if (condition_group.classList.contains(\"condition-group-logic\"))\r\n    return {\r\n      type: \"group_logic\",\r\n      value: condition_group.querySelector(\"select\").value,\r\n    };\r\n\r\n  condition_fields.forEach((condition_field: HTMLElement) =>\r\n    fields.push(scrape_condition_field_data(condition_field))\r\n  );\r\n\r\n  return fields.length ? { type: \"group\", fields: fields } : null;\r\n}\r\n\r\n/**\r\n * Scrape condition field data.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function scrape_condition_field_data(condition_field: HTMLElement): any {\r\n  const { type } = condition_field.dataset;\r\n  let field_data: any = { type: type, data: null };\r\n  let temp: any, temp2: any, temp3: any, temp4: any;\r\n\r\n  switch (type) {\r\n    case \"logic\":\r\n      temp = condition_field.querySelector(\"select.condition-logic\");\r\n      field_data.data = temp.value;\r\n      break;\r\n\r\n    case \"product-category\":\r\n      temp = condition_field.querySelector(\".condition-value\");\r\n      temp2 = condition_field.querySelector(\".condition-select\");\r\n      temp3 = condition_field.querySelector(\".condition-quantity\");\r\n      field_data.data = {\r\n        condition: $(temp2).val(),\r\n        value: $(temp).val(),\r\n        quantity: $(temp3).val(),\r\n      };\r\n      break;\r\n\r\n    case \"customer-logged-in-status\":\r\n    case \"customer-user-role\":\r\n    case \"disallowed-customer-user-role\":\r\n      temp = condition_field.querySelector(\".condition-value\");\r\n      field_data.data = $(temp).val();\r\n      break;\r\n\r\n    case \"cart-quantity\":\r\n    case \"cart-subtotal\":\r\n      temp = condition_field.querySelector(\".condition-select\");\r\n      temp2 = condition_field.querySelector(\".condition-value\");\r\n      field_data.data = {\r\n        condition: $(temp).val(),\r\n        value:\r\n          type == \"cart-subtotal\" ? $(temp2).val() : parseInt($(temp2).val()),\r\n      };\r\n      break;\r\n\r\n    default:\r\n      const field_key: string = type.replace(/-/g, \"_\");\r\n      if (cart_condition_fields[field_key]) {\r\n        const { scraper_callback } = cart_condition_fields[field_key];\r\n\r\n        field_data.data = scraper_callback(condition_field);\r\n      }\r\n      break;\r\n  }\r\n\r\n  return field_data;\r\n}\r\n","import {\r\n  get_allowed_minimum_value,\r\n  toggle_overlay,\r\n  validate_url,\r\n} from \"../helper\";\r\nimport { toggle_editing_mode } from \"./toggles\";\r\nimport { scrape_condition_group_data } from \"./scrapers\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\ndeclare var ajaxurl: string;\r\ndeclare var woocommerce_admin_meta_boxes: any;\r\ndeclare var vex: any;\r\n\r\nconst $: any = jQuery;\r\nconst { post_id } = woocommerce_admin_meta_boxes;\r\n\r\n/**\r\n * Save cart conditions.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function save_cart_conditions() {\r\n  const module_block: HTMLElement = document.querySelector(\r\n      \"#acfw_cart_conditions\"\r\n    ),\r\n    condition_groups: NodeList = module_block.querySelectorAll(\r\n      \".condition-groups .condition-group, .condition-groups .condition-group-logic\"\r\n    ),\r\n    overlay: HTMLElement = module_block.querySelector(\".acfw-overlay\");\r\n\r\n  const { post_status } = acfw_edit_coupon;\r\n  const { post_id } = woocommerce_admin_meta_boxes;\r\n\r\n  let form_data: any[] = [];\r\n\r\n  // remove product table edit form rows.\r\n  $(module_block)\r\n    .find(\".acfw-styled-table tr.add-edit-form button.cancel\")\r\n    .trigger(\"click\");\r\n\r\n  condition_groups.forEach((condition_group: HTMLElement) => {\r\n    const data = scrape_condition_group_data(condition_group);\r\n    if (data) form_data.push(data);\r\n  });\r\n\r\n  if (!validate_form_data(form_data)) {\r\n    vex.dialog.alert(acfw_edit_coupon.cart_conditions_invalid);\r\n\r\n    // Add save error flag class in #acfw_cart_conditions\r\n    $(module_block).addClass(\"save-error\");\r\n    return;\r\n  }\r\n\r\n  const notice_settings = {\r\n    message: $(module_block)\r\n      .find(\".text-input.non-qualifying-message-field\")\r\n      .val(),\r\n    btn_text: $(module_block)\r\n      .find(\".text-input.non-qualifying-btn-text-field\")\r\n      .val(),\r\n    btn_url: $(module_block)\r\n      .find(\".text-input.non-qualifying-btn-url-field\")\r\n      .val(),\r\n  };\r\n  const auto_apply_display = $(module_block)\r\n    .find(\".display-notice-auto-apply-field\")\r\n    .is(\":checked\")\r\n    ? \"yes\"\r\n    : \"\";\r\n\r\n  if (notice_settings.btn_url && !validate_url(notice_settings.btn_url)) {\r\n    vex.dialog.alert(acfw_edit_coupon.cart_notice_url_invalid);\r\n    $(module_block).addClass(\"save-error\");\r\n    return;\r\n  }\r\n\r\n  toggle_overlay(overlay, \"show\");\r\n\r\n  ajax_save(\r\n    {\r\n      cart_conditions: form_data,\r\n      notice_settings: notice_settings,\r\n      auto_apply_display: auto_apply_display,\r\n    },\r\n    (response: any) => {\r\n      if (response.status == \"success\") {\r\n        // if coupon is not published yet, then save it as draft.\r\n        if (post_status !== \"publish\") {\r\n          if (!$(\"input[name='post_title']\").val())\r\n            $(\"input[name='post_title']\").val(\"coupon-\" + post_id);\r\n\r\n          $(\"select[name='post_status']\")\r\n            .append(new Option(\"Published\", \"publish\"))\r\n            .val(\"publish\");\r\n\r\n          $(\"#publishing-action\").append(`\r\n                    <input type=\"hidden\" name=\"publish\" value=\"Publish\">\r\n                `);\r\n          $(\"input#publish\").click();\r\n        }\r\n      } else {\r\n        if (response.error_msg) vex.dialog.alert(response.error_msg);\r\n      }\r\n\r\n      toggle_editing_mode(false);\r\n      $(module_block).find(\"#save-cart-conditions\").prop(\"disabled\", true);\r\n      toggle_overlay(overlay, \"hide\");\r\n    }\r\n  );\r\n}\r\n\r\n/**\r\n * Save on coupon publish.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function save_on_coupon_publish(e: any) {\r\n  const module_block: HTMLElement = document.querySelector(\r\n    \"#acfw_cart_conditions\"\r\n  );\r\n\r\n  if (!$(module_block).data(\"editing\")) return;\r\n\r\n  e.preventDefault();\r\n  $(module_block).find(\"#save-cart-conditions\").trigger(\"click\");\r\n\r\n  // delay for 1 second to give time for\r\n  setTimeout(() => {\r\n    // If Cart Condition displays an error message then don't save the coupon\r\n    if ($(module_block).hasClass(\"save-error\"))\r\n      $(module_block).removeClass(\"save-error\");\r\n    else $(\"form#post\").submit();\r\n  }, 1000);\r\n}\r\n\r\n/**\r\n * Trigger AJAX save.\r\n *\r\n * @since 1.0.0\r\n *\r\n * @param form_data\r\n * @param callback\r\n * @return jQuery AJAX\r\n */\r\nfunction ajax_save(data: any, callback: CallableFunction) {\r\n  data.action = \"acfw_save_cart_conditions\";\r\n  data.coupon_id = post_id;\r\n\r\n  return $.post(ajaxurl, data, callback, \"json\");\r\n}\r\n\r\n/**\r\n * Validate cart conditions form data.\r\n *\r\n * @since 1.0.0\r\n */\r\nfunction validate_form_data(form_data: any[]): boolean {\r\n  let group, field, data, type, objects, condition, value, min;\r\n\r\n  // return true if form data has a single empty group (initial layout).\r\n  if (form_data.length === 1 && form_data[0].fields?.length < 1) return true;\r\n\r\n  let prevGroupType = \"\";\r\n\r\n  for (group of form_data) {\r\n    if (group[\"type\"] === \"group_logic\") {\r\n      // invalidate if the previous group of the logic is still a logic or non-existent.\r\n      if (!prevGroupType || prevGroupType === \"group_logic\") {\r\n        return false;\r\n      }\r\n\r\n      prevGroupType = \"group_logic\";\r\n\r\n      // skip validation for group logic fields.\r\n      continue;\r\n    }\r\n\r\n    prevGroupType = group[\"type\"];\r\n\r\n    // invalidate if no fields detected.\r\n    if (group[\"fields\"] === undefined || group[\"fields\"].length < 1)\r\n      return false;\r\n\r\n    for (field of group[\"fields\"]) {\r\n      type = field[\"type\"];\r\n      data = field[\"data\"];\r\n\r\n      // invalidate if atleast a single field has invalid data.\r\n      if (data === undefined || data === \"\" || data === null) return false;\r\n\r\n      if (typeof data == \"object\" && typeof data.length == \"number\")\r\n        // product quantities field validation\r\n        objects = data;\r\n      else if (type === \"product-category\") {\r\n        // product category validation\r\n\r\n        objects = data[\"value\"];\r\n        condition = data[\"condition\"];\r\n        value = data[\"quantity\"];\r\n      } else if (typeof data == \"object\" && data.length === undefined) {\r\n        // has ordered before validation\r\n\r\n        objects = data[\"products\"];\r\n        condition = data[\"condition\"];\r\n        value = data[\"value\"];\r\n      } else value = data;\r\n\r\n      min = get_allowed_minimum_value(condition);\r\n\r\n      if (\r\n        (objects !== undefined && objects.length < 1) ||\r\n        (condition !== undefined && !condition) ||\r\n        (!Number.isInteger(value) && value !== undefined && !value) ||\r\n        (Number.isInteger(value) && value < min) ||\r\n        (typeof value == \"number\" && value < min)\r\n      )\r\n        return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n","import { esc_attr } from \"../helper\";\r\nimport { toggle_editing_mode } from \"./toggles\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\ndeclare var vex: any;\r\n\r\nconst $: any = jQuery;\r\nconst {\r\n  product_table_buttons,\r\n  condition_field_options,\r\n  bogo_form_fields,\r\n} = acfw_edit_coupon;\r\n\r\n/**\r\n * Trigger the add table row form event.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport function trigger_add_table_row_form() {\r\n  const $button: JQuery = $(this),\r\n    $table: JQuery = $button.closest(\".acfw-styled-table\"),\r\n    $tbody: JQuery = $table.find(\"tbody\"),\r\n    exclude: number[] = $table.data(\"exclude\");\r\n\r\n  $tbody.find(\"tr.no-result\").remove();\r\n\r\n  $tbody.append(get_add_edit_form_row_markup(exclude));\r\n  $(\"body\").trigger(\"wc-enhanced-select-init\");\r\n}\r\n\r\n/**\r\n * Trigger the edit table row form event.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport function trigger_edit_table_row_form() {\r\n  const $button: JQuery = $(this),\r\n    $row: JQuery = $button.closest(\"tr\"),\r\n    $table: JQuery = $button.closest(\"table\"),\r\n    $tbody: JQuery = $row.closest(\"tbody\"),\r\n    data: any = $row.find(\"td.product\").data(\"product\");\r\n\r\n  let exclude: number[] = $table.data(\"exclude\");\r\n\r\n  exclude.splice(exclude.indexOf(data.product_id), 1);\r\n  $tbody.find(\"tr.no-result\").remove();\r\n  $row.replaceWith(get_add_edit_form_row_markup(exclude, data));\r\n  $table.data(\"exclude\", exclude);\r\n  $table.find(\".wc-product-search\").data(\"exclude\", exclude);\r\n  $(\"body\").trigger(\"wc-enhanced-select-init\");\r\n}\r\n\r\n/**\r\n * Actual function that saves/edits the table row.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport function add_edit_table_row() {\r\n  const $button: JQuery = $(this),\r\n    $row: JQuery = $button.closest(\"tr\"),\r\n    $table: JQuery = $button.closest(\"table.acfw-styled-table\"),\r\n    $search: JQuery = $row.find(\".wc-product-search\"),\r\n    $condition: JQuery = $row.find(\".condition-select\"),\r\n    $quantity: JQuery = $row.find(\".condition-quantity\"),\r\n    minimum: number = $condition.val() === \"<\" ? 1 : 0;\r\n\r\n  let exclude: any = $table.data(\"exclude\");\r\n\r\n  if (\r\n    !$search.val() ||\r\n    !$condition.val() ||\r\n    !$quantity.val() ||\r\n    $quantity.val() < minimum\r\n  ) {\r\n    vex.dialog.alert(acfw_edit_coupon.fill_form_propery_error_msg);\r\n    return;\r\n  }\r\n\r\n  const productId: number = parseInt($search.val().toString());\r\n\r\n  // don't proceed if product has already been added to the table.\r\n  // this happens when the same product has been added to a new row and trying to cancel the row that already has the same value.\r\n  if (exclude.includes(productId)) {\r\n    vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);\r\n    return;\r\n  }\r\n\r\n  const data: any = {\r\n    product_id: productId,\r\n    condition: $condition.val(),\r\n    quantity: parseInt($quantity.val() + \"\"),\r\n    product_label: $search.find(\"option:selected\").text(),\r\n    condition_label: $condition.find(\"option:selected\").text(),\r\n  };\r\n\r\n  let markup: string = `\r\n        <tr>\r\n            <td class=\"product\" data-product=\"${esc_attr(\r\n              JSON.stringify(data)\r\n            )}\">${data.product_label}</td>\r\n            <td class=\"condition\">${data.condition_label}</td>\r\n            <td class=\"quantity\">${data.quantity}</td>\r\n            <td class=\"actions\">\r\n                <a class=\"edit\" href=\"javascript:void(0)\"><span class=\"dashicons dashicons-edit\"></span></a>\r\n                <a class=\"remove\" href=\"javascript:void(0)\"><span class=\"dashicons dashicons-no\"></span></a>\r\n            </td>\r\n        </tr>\r\n    `;\r\n\r\n  exclude.push(data.product_id);\r\n  $row.replaceWith(markup);\r\n  $table.data(\"exclude\", exclude);\r\n  $table.find(\".wc-product-search\").data(\"exclude\", exclude);\r\n  toggle_editing_mode(true);\r\n}\r\n\r\n/**\r\n * Trigger the cancel add/edit table row form event.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport function cancel_add_edit_table_row() {\r\n  const $button: JQuery = jQuery(this),\r\n    $row: JQuery = $button.closest(\"tr\"),\r\n    $table: JQuery = $button.closest(\"table\"),\r\n    $tbody: JQuery = $row.closest(\"tbody\"),\r\n    data: any = $row.find(\"td.product\").data(\"product\"),\r\n    colspan: number = $row.find(\"td\").length;\r\n\r\n  let exclude: number[] = $table.data(\"exclude\");\r\n\r\n  // don't proceed if product has already been added to the table.\r\n  // this happens when the same product has been added to a new row and trying to cancel the row that already has the same value.\r\n  if (exclude.includes(data.product_id)) {\r\n    vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);\r\n    return;\r\n  }\r\n\r\n  if (typeof data == \"object\") {\r\n    const { product_id, product_label, condition_label, quantity } = data;\r\n\r\n    let markup = `\r\n            <tr>\r\n                <td class=\"product\" data-product=\"${esc_attr(\r\n                  JSON.stringify(data)\r\n                )}\">${product_label}</td>\r\n                <td class=\"condition\">${condition_label}</td>\r\n                <td class=\"quantity\">${quantity}</td>\r\n                <td class=\"actions\">\r\n                    <a class=\"edit\" href=\"javascript:void(0)\"><span class=\"dashicons dashicons-edit\"></span></a>\r\n                    <a class=\"remove\" href=\"javascript:void(0)\"><span class=\"dashicons dashicons-no\"></span></a>\r\n                </td>\r\n            </tr>\r\n        `;\r\n\r\n    exclude.push(product_id);\r\n    $row.replaceWith(markup);\r\n    $table.data(\"exclude\", exclude);\r\n    $table.find(\".wc-product-search\").data(\"exclude\", exclude);\r\n  } else {\r\n    $row.remove();\r\n    append_blank_placeholder_table_row($tbody, colspan);\r\n  }\r\n}\r\n\r\n/**\r\n * Remove product in table.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function product_table_remove_product() {\r\n  const $button: JQuery = jQuery(this),\r\n    $row: JQuery = $button.closest(\"tr\"),\r\n    $table: JQuery = $row.closest(\"table\"),\r\n    $tbody: JQuery = $table.find(\"tbody\"),\r\n    colspan: number = $row.find(\"td\").length;\r\n\r\n  $row.remove();\r\n\r\n  let data: any = $row.find(\"td.product\").data(\"product\"),\r\n    exclude: number[] = $table.data(\"exclude\"),\r\n    index: number = exclude.indexOf(parseInt(data.product_id));\r\n\r\n  if (index !== -1) exclude.splice(index, 1);\r\n  $table.data(\"exclude\", exclude);\r\n  $table.find(\".wc-product-search\").data(\"exclude\", exclude);\r\n\r\n  append_blank_placeholder_table_row($tbody, colspan);\r\n  toggle_editing_mode(true);\r\n}\r\n\r\n/**\r\n * Append blank placeholder row on tables that are empty.\r\n *\r\n * @param {object} $tbody  Table tbody jQuery object.\r\n * @param {int}    colspan Number of row columns.\r\n */\r\nfunction append_blank_placeholder_table_row(\r\n  $tbody: JQuery,\r\n  colspan: number = 3\r\n) {\r\n  if ($tbody.find(\"tr\").length > 0) return;\r\n\r\n  $tbody.append(`\r\n        <tr class=\"no-result\">\r\n            <td colspan=\"${colspan}\">${acfw_edit_coupon.no_products_added}</td>\r\n        </tr>\r\n    `);\r\n}\r\n\r\n/**\r\n * Get add/edit form row markup.\r\n *\r\n * @since 1.0.0\r\n *\r\n * @param {object} exclude Array of excluded product ids.\r\n * @param {object} data    Product data.\r\n * @return {string} Add/edit form row markup.\r\n */\r\nfunction get_add_edit_form_row_markup(\r\n  exclude: number[] = [],\r\n  data: any = false\r\n): string {\r\n  let prodOption: string = \"\",\r\n    condOption: string = \"\";\r\n\r\n  if (typeof data == \"object\") {\r\n    const { product_id, product_label } = data;\r\n\r\n    prodOption = `<option value=\"${product_id}\">${product_label}</option>`;\r\n    condOption = data.condition;\r\n  }\r\n\r\n  const { add, edit, cancel } = product_table_buttons;\r\n  const { exactly, anyexcept, morethan, lessthan } = condition_field_options;\r\n  const { type_to_search } = bogo_form_fields;\r\n\r\n  const btnText = typeof data == \"object\" ? edit : add,\r\n    markup = `\r\n        <tr class=\"add-edit-form adding\">\r\n            <td class=\"product\" data-product=\"${\r\n              typeof data == \"object\" ? esc_attr(JSON.stringify(data)) : 0\r\n            }\">\r\n                <div class=\"object-search-wrap\">\r\n                    <select class=\"product-in-cart wc-product-search\"\r\n                        data-placeholder=\"${type_to_search}\"\r\n                        data-action=\"acfw_search_products\"\r\n                        data-exclude=\"${esc_attr(\r\n                          JSON.stringify(exclude)\r\n                        )}\">${prodOption}</select>\r\n                </div>\r\n            </td>\r\n            <td class=\"condition\">\r\n                <select class=\"condition-select\">\r\n                    <option value=\"=\" ${\r\n                      condOption == \"=\" ? \"selected\" : \"\"\r\n                    }>${exactly}</option>\r\n                    <option value=\"!=\" ${\r\n                      condOption == \"!=\" ? \"selected\" : \"\"\r\n                    }>${anyexcept}</option>\r\n                    <option value=\">\" ${\r\n                      condOption == \">\" ? \"selected\" : \"\"\r\n                    }>${morethan}</option>\r\n                    <option value=\"<\" ${\r\n                      condOption == \"<\" ? \"selected\" : \"\"\r\n                    }>${lessthan}</option>\r\n                </select>\r\n            </td>\r\n            <td class=\"quantity\">\r\n                <input type=\"number\" class=\"condition-quantity\" value=\"${\r\n                  typeof data == \"object\" ? data.quantity : 1\r\n                }\" min=\"${condOption == \"<\" ? 1 : 0}\">\r\n            </td>\r\n            <td class=\"actions\">\r\n                <button type=\"button\" class=\"condition-product-add button-primary\">${btnText}</button>\r\n                <button type=\"button\" class=\"cancel button\">${cancel}</button>\r\n            </td>\r\n        </tr>\r\n        `;\r\n\r\n  return markup;\r\n}\r\n","import { get_allowed_minimum_value } from \"../helper\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\nconst $: any = jQuery;\r\n\r\n/**\r\n * Restrict number input minimum value.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function restrict_number_min_value() {\r\n  const $input: JQuery = $(this),\r\n    min: number = parseInt($input.attr(\"min\")),\r\n    value: number = parseFloat($input.val() + \"\");\r\n\r\n  if (value < min) $input.val(min);\r\n}\r\n\r\n/**\r\n * Restrict number input minimum value.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function update_input_minimum_value() {\r\n  const $select: JQuery = $(this),\r\n    $field: JQuery = $select.closest(\".condition-field,.condition-set\"),\r\n    field_type: string = $field.data(\"type\"),\r\n    selector: string =\r\n      field_type == \"product-quantity\" ||\r\n      field_type == \"has-ordered-before\" ||\r\n      field_type == \"product-category\"\r\n        ? \"input.condition-quantity\"\r\n        : \"input.condition-value\",\r\n    $input: JQuery = $field.find(selector),\r\n    condition: string = $select.val() + \"\";\r\n\r\n  let min: number = get_allowed_minimum_value(condition);\r\n\r\n  $input.attr(\"min\", min).trigger(\"change\");\r\n}\r\n\r\n/**\r\n * Updated has ordered before condition label.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function update_has_ordered_before_condition_label() {\r\n  const { within_a_period_label, number_of_orders_label } = acfw_edit_coupon;\r\n\r\n  const $select: JQuery = $(this),\r\n    $field: JQuery = $select.closest(\".cart-quantity-field\"),\r\n    $label: JQuery = $field.find(\".condition-type-value label\");\r\n\r\n  if ($select.val() == \"within-a-period\") $label.text(within_a_period_label);\r\n  else $label.text(number_of_orders_label);\r\n}\r\n\r\n/**\r\n * Validate price field value on change.\r\n *\r\n * @since 1.2\r\n */\r\nexport function validate_price_field_value() {\r\n  const $input: JQuery = $(this),\r\n    $condition_block: JQuery = $input.closest(\".condition-field\"),\r\n    $condition_field: JQuery = $condition_block.find(\"select.condition-select\"),\r\n    condition_type: string = $condition_field.val() + \"\";\r\n\r\n  let input_price: string = $input.val() + \"\",\r\n    minimum_price: number = get_allowed_minimum_value(condition_type);\r\n\r\n  if (acfw_edit_coupon.decimal_separator !== \".\")\r\n    input_price = input_price.replace(acfw_edit_coupon.decimal_separator, \".\");\r\n\r\n  if (!$condition_field || parseFloat(input_price) > minimum_price - 1) return;\r\n\r\n  $input.val(minimum_price);\r\n}\r\n\r\n/**\r\n * Remove leading zeros from an input field.\r\n *\r\n * @since 1.2\r\n */\r\nexport function remove_leading_zeros(): void {\r\n  const $input: any = $(this);\r\n  let value: string = $input.val();\r\n\r\n  if (value == \"0\" + acfw_edit_coupon.decimal_separator) $input.val(\"0\");\r\n  if (\r\n    value == \"0\" ||\r\n    value.substring(0, 2) == \"0\" + acfw_edit_coupon.decimal_separator\r\n  )\r\n    return;\r\n\r\n  value = value.replace(/^0+/, \"\");\r\n  value =\r\n    value.substring(0, 1) == acfw_edit_coupon.decimal_separator\r\n      ? \"0\" + value\r\n      : value;\r\n\r\n  $input.val(value);\r\n}\r\n\r\n/**\r\n * Condition value type change (used in user and cart item meta condition fields).\r\n *\r\n * @since 1.4\r\n */\r\nexport function condition_value_type_change() {\r\n  const $type: JQuery = $(this),\r\n    $field: JQuery = $type.closest(\".condition-field\"),\r\n    $condition: JQuery = $field.find(\"select.condition-select\"),\r\n    $value: JQuery = $field.find(\"input.condition-value\");\r\n\r\n  switch ($type.val()) {\r\n    case \"string\":\r\n      $value.prop(\"type\", \"text\");\r\n      $value.removeClass(\"wc_input_price\");\r\n      if ($condition.val() == \">\" || $condition.val() == \"<\")\r\n        $condition.val(\"=\");\r\n      $condition\r\n        .find(\"option[value='>'],option[value='<']\")\r\n        .prop(\"disabled\", true);\r\n      break;\r\n\r\n    case \"number\":\r\n      $value.prop(\"type\", \"number\");\r\n      $value.removeClass(\"wc_input_price\");\r\n      $condition\r\n        .find(\"option[value='>'],option[value='<']\")\r\n        .prop(\"disabled\", false);\r\n      break;\r\n\r\n    case \"price\":\r\n      $value.prop(\"type\", \"text\");\r\n      $value.addClass(\"wc_input_price\");\r\n      $condition\r\n        .find(\"option[value='>'],option[value='<']\")\r\n        .prop(\"disabled\", false);\r\n      break;\r\n  }\r\n\r\n  $condition.trigger(\"change\");\r\n}\r\n","declare var jQuery: any;\r\n\r\nconst $: any = jQuery;\r\n\r\nexport function navigate_tabs(): void {\r\n  const $tab: JQuery = $(this),\r\n    $module_block = $tab.closest(\".woocommerce\").find(\"#acfw_cart_conditions\"),\r\n    tab: string = $tab.data(\"tab\");\r\n\r\n  $module_block.find(\".panel\").hide();\r\n  $module_block.find(`.panel[data-tab=\"${tab}\"]`).show();\r\n  set_active_tab($tab);\r\n}\r\n\r\nfunction set_active_tab($tab: JQuery): void {\r\n  $(\".acfw-cart-condition-tabs li\").removeClass(\"active\");\r\n  $tab.closest(\"li\").addClass(\"active\");\r\n}\r\n","import { add_condition_group, remove_condition_group } from \"./groups\";\r\nimport {\r\n  add_condition_field,\r\n  remove_condition_field,\r\n  get_condition_field,\r\n  is_condition_field,\r\n} from \"./fields\";\r\nimport { save_cart_conditions, save_on_coupon_publish } from \"./save\";\r\nimport {\r\n  toggle_add_condition_form,\r\n  toggle_editing_mode,\r\n  popuplate_taxonomy_term_options,\r\n  popuplate_shipping_region_options,\r\n} from \"./toggles\";\r\nimport {\r\n  trigger_add_table_row_form,\r\n  trigger_edit_table_row_form,\r\n  add_edit_table_row,\r\n  cancel_add_edit_table_row,\r\n  product_table_remove_product,\r\n} from \"./table\";\r\nimport {\r\n  restrict_number_min_value,\r\n  update_input_minimum_value,\r\n  update_has_ordered_before_condition_label,\r\n  validate_price_field_value,\r\n  remove_leading_zeros,\r\n  condition_value_type_change,\r\n} from \"./restrictions\";\r\n\r\nimport logic_template from \"./templates/logic\";\r\nimport condition_logic_template from \"./templates/condition_logic\";\r\nimport condition_group_template from \"./templates/condition_group\";\r\nimport { navigate_tabs } from \"./tabs\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\nconst $: any = jQuery;\r\nconst module_block: HTMLElement = document.querySelector(\r\n  \"#acfw_cart_conditions\"\r\n);\r\n\r\n/**\r\n * Add free products module events script.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport default function cart_conditions_module_events() {\r\n  $(module_block).on(\"click\", \"#add-cart-condition-group\", add_condition_group);\r\n  $(module_block).on(\r\n    \"click\",\r\n    \"a.remove-condition-group\",\r\n    remove_condition_group\r\n  );\r\n  $(module_block).on(\"click\", \".add-condition-field\", add_condition_field);\r\n  $(module_block).on(\r\n    \"click\",\r\n    \"a.remove-condition-field\",\r\n    remove_condition_field\r\n  );\r\n  $(module_block).on(\r\n    \"click\",\r\n    \".add-condition-trigger\",\r\n    toggle_add_condition_form\r\n  );\r\n  $(module_block).on(\r\n    \"click\",\r\n    \".cancel-add-condition-field\",\r\n    toggle_add_condition_form\r\n  );\r\n  $(module_block).on(\r\n    \"click\",\r\n    \".acfw-styled-table tfoot .add-table-row\",\r\n    trigger_add_table_row_form\r\n  );\r\n  $(module_block).on(\r\n    \"click\",\r\n    \".acfw-styled-table td.actions a.edit\",\r\n    trigger_edit_table_row_form\r\n  );\r\n  $(module_block).on(\r\n    \"click\",\r\n    \"tr.add-edit-form .actions .condition-product-add\",\r\n    add_edit_table_row\r\n  );\r\n  $(module_block).on(\r\n    \"click\",\r\n    \"tr.add-edit-form .actions .cancel\",\r\n    cancel_add_edit_table_row\r\n  );\r\n  $(module_block).on(\r\n    \"click\",\r\n    \".acfw-styled-table td.actions a.remove\",\r\n    product_table_remove_product\r\n  );\r\n  $(module_block).on(\"click\", \"#save-cart-conditions\", save_cart_conditions);\r\n  $(module_block).on(\r\n    \"change\",\r\n    \"input[type='number']\",\r\n    restrict_number_min_value\r\n  );\r\n  $(module_block).on(\r\n    \"change\",\r\n    \"select.condition-select\",\r\n    update_input_minimum_value\r\n  );\r\n  $(module_block).on(\r\n    \"change\",\r\n    \"select.has-ordered-before-type\",\r\n    update_has_ordered_before_condition_label\r\n  );\r\n  $(module_block).on(\"change\", \".wc_input_price\", validate_price_field_value);\r\n  $(module_block).on(\r\n    \"change\",\r\n    \"select.custom-taxonomy\",\r\n    popuplate_taxonomy_term_options\r\n  );\r\n  $(module_block).on(\r\n    \"change\",\r\n    \".shipping-zone-region-field select.condition-select\",\r\n    popuplate_shipping_region_options\r\n  );\r\n  $(module_block).on(\"blur\", \".wc_input_price\", remove_leading_zeros);\r\n  $(module_block).on(\r\n    \"change\",\r\n    \"select.value-type\",\r\n    condition_value_type_change\r\n  );\r\n  $(\"form#post\").on(\"submit\", save_on_coupon_publish);\r\n\r\n  $(module_block).find(\"select\").trigger(\"change\");\r\n  $(module_block).css(\"min-height\", $(\"#coupon_options\").height());\r\n\r\n  $(module_block).on(\"change\", \"input,select,textarea\", () => {\r\n    toggle_editing_mode(true);\r\n  });\r\n\r\n  $(module_block)\r\n    .find(\".condition-groups\")\r\n    .each(function () {\r\n      if ($(this).find(\".condition-group-fields\").length) $(this).show();\r\n    });\r\n\r\n  $(\".acfw-cart-condition-tabs\").on(\"click\", \"li a\", navigate_tabs);\r\n\r\n  setTimeout(init_cart_conditions, 500);\r\n}\r\n\r\n/**\r\n * Init cart conditions. Save the current cart conditions data.\r\n *\r\n * @since 1.0.0\r\n */\r\nfunction init_cart_conditions(): void {\r\n  const condition_groups = module_block.querySelector(\".condition-groups\");\r\n  const data: any = $(module_block).data(\"cart_conditions\");\r\n\r\n  const asyncFunc = async () => {\r\n    let cart_conditions: any[] = [];\r\n    let markup: string = \"\";\r\n\r\n    if (data.length) {\r\n      for (let row of data) {\r\n        if (row.type == \"group\") {\r\n          const fields_markup = load_condition_group_fields(row.fields);\r\n          markup += condition_group_template(fields_markup);\r\n        } else markup += condition_logic_template(row.value);\r\n      }\r\n    } else markup = condition_group_template();\r\n\r\n    $(condition_groups).html(markup);\r\n    $(condition_groups).find(\"input,select\").trigger(\"change\");\r\n\r\n    $(condition_groups)\r\n      .find(\".condition-group.new .add-condition-trigger\")\r\n      .trigger(\"click\");\r\n    $(condition_groups).find(\".condition-group\").removeClass(\"new\");\r\n  };\r\n\r\n  asyncFunc().then(() => {\r\n    setTimeout(() => $(\"body\").trigger(\"wc-enhanced-select-init\"), 1500);\r\n    toggle_editing_mode(false);\r\n  });\r\n}\r\n\r\n/**\r\n * Load condition group fields.\r\n *\r\n * @since 1.0.0\r\n *\r\n * @param fields\r\n */\r\nfunction load_condition_group_fields(fields: any[]): string {\r\n  let markup: string = \"\";\r\n  let temp: string = \"\";\r\n  let addLogic: boolean = true;\r\n\r\n  for (let field of fields) {\r\n    const { type, data } = field;\r\n\r\n    if (!is_condition_field(type)) {\r\n      addLogic = false;\r\n      continue;\r\n    }\r\n\r\n    if (type == \"logic\") {\r\n      temp = addLogic ? logic_template(data) : \"\";\r\n      continue;\r\n    }\r\n\r\n    const field_markup = get_condition_field(type, data);\r\n\r\n    if (field_markup) {\r\n      markup += temp + field_markup;\r\n      addLogic = true;\r\n    } else {\r\n      addLogic = false;\r\n    }\r\n\r\n    temp = \"\";\r\n  }\r\n\r\n  return markup;\r\n}\r\n","declare var acfw_edit_coupon: any;\r\n\r\nexport default function upsell_template() {\r\n\r\n    const { upsell } = acfw_edit_coupon;\r\n\r\n    if ( ! upsell ) return '';\r\n\r\n    return `\r\n    <div class=\"upsell\">\r\n        ${ upsell.bogo_deals_type }\r\n    </div>`;\r\n}","import { esc_attr } from \"../../helper\";\r\nimport upsell_template from \"./upsell\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\n\r\n/**\r\n * Specific products condition type.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport default function combination_products_template(\r\n  data: any,\r\n  is_deals = false\r\n) {\r\n  const { products, quantity, discount_type, discount_value } = data;\r\n  const { bogo_form_fields, bogo_instructions } = acfw_edit_coupon;\r\n  const {\r\n    quantity: quantityLabel,\r\n    products: productsLabel,\r\n    price_discount: priceDiscountLabel,\r\n    type_to_search,\r\n  } = bogo_form_fields;\r\n\r\n  const priceType: string = discount_type ? data.discount_type : \"override\";\r\n  const priceCol: string = is_deals\r\n    ? get_price_column(priceType, discount_value)\r\n    : \"\";\r\n  const priceTh: string = is_deals\r\n    ? `<th class=\"price\">${priceDiscountLabel}</th>`\r\n    : \"\";\r\n  const options: string = get_options(products);\r\n  const instructions: string = is_deals\r\n    ? `${bogo_instructions.apply_default} ${bogo_instructions.multiple_items}`\r\n    : bogo_instructions.trigger_default;\r\n\r\n  const markup = `\r\n      <p class=\"instructions\">${instructions}</p>\r\n      <table class=\"acfw-styled-table combined-products-form\" \r\n          data-combined=\"${esc_attr(JSON.stringify(data))}\"\r\n          data-isdeals=\"${is_deals}\">\r\n          <thead>\r\n              <tr>\r\n                  <th class=\"products-list\">${productsLabel}</th>\r\n                  <th class=\"quantity\">${quantityLabel}</th>\r\n                  ${priceTh}\r\n              </tr>\r\n          </thead>\r\n          <tbody>\r\n              <tr>\r\n                  <td class=\"products-list object\">\r\n                      <select class=\"combined-products-list wc-product-search\"\r\n                      data-placeholder=\"${type_to_search}\"\r\n                      data-action=\"acfw_search_products\"\r\n                      data-exclude=\"\" multiple>${options}</select>\r\n                  </td>\r\n                  <td class=\"quantity\">\r\n                      <input type=\"number\" class=\"condition-quantity\" value=\"${quantity}\" min=\"1\">\r\n                  </td>\r\n                  ${priceCol}\r\n              </tr>\r\n          </tbody>\r\n      </table>\r\n      ${upsell_template()}\r\n    `;\r\n\r\n  return markup;\r\n}\r\n\r\n/**\r\n * Get product(s) price column.\r\n *\r\n * @since 1.15\r\n *\r\n * @param priceType\r\n * @param discount_value\r\n */\r\nfunction get_price_column(\r\n  priceType: string,\r\n  discount_value: string = \"0\"\r\n): string {\r\n  const { currency_symbol, discount_field_options } = acfw_edit_coupon;\r\n  const { override, percent, fixed } = discount_field_options;\r\n\r\n  return `\r\n    <td class=\"price\">\r\n        <div>\r\n        <select class=\"discount_type\">\r\n            <option value=\"override\" ${\r\n              priceType == \"override\" ? \"selected\" : \"\"\r\n            }>${currency_symbol} : ${override}</option>\r\n            <option value=\"percent\" ${\r\n              priceType == \"percent\" ? \"selected\" : \"\"\r\n            }>% : ${percent}</option>\r\n            <option value=\"fixed\" ${\r\n              priceType == \"fixed\" ? \"selected\" : \"\"\r\n            }>-${currency_symbol} : ${fixed}</option>\r\n        </select>\r\n        <input type=\"text\" class=\"discount_value short wc_input_price\" value=\"${discount_value}\">\r\n        </div>\r\n    </td>\r\n    `;\r\n}\r\n\r\n/**\r\n * Get product(s) row options.\r\n *\r\n * @since 1.15\r\n *\r\n * @param products\r\n */\r\nfunction get_options(products: any): string {\r\n  if (typeof products != \"object\" || !products.length) return;\r\n\r\n  let options = \"\";\r\n  for (let p of products)\r\n    options += `<option value=\"${p.product_id}\" selected>${p.label}</option>`;\r\n\r\n  return options;\r\n}\r\n","import { esc_attr } from \"../../helper\";\r\n\r\n/**\r\n * Category table row first column template.\r\n * \r\n * @param data \r\n */\r\nexport default function category_first_column_template( data: any ): string {\r\n\r\n    const { category_id , category_label } = data;\r\n\r\n    return `\r\n    <td class=\"category category-${ category_id } object\" data-category=\"${ esc_attr( JSON.stringify(data) ) }\">\r\n        ${ category_label }\r\n    </td>\r\n    `;\r\n}","declare var acfw_edit_coupon: any;\r\n\r\n/**\r\n * Placeholder table row.\r\n * \r\n * @since 1.15\r\n * \r\n * @param colspan \r\n */\r\nexport default function placeholder_table_row_template( colspan: number = 3, type: string = \"product\" ): string {\r\n\r\n    const { no_products_added , no_categories_added } = acfw_edit_coupon;\r\n    return `\r\n    <tr class=\"no-result\">\r\n        <td colspan=\"${ colspan }\">${ type == \"category\" ? no_categories_added : no_products_added }</td>\r\n    </tr>\r\n    `;\r\n}","import { esc_attr } from \"../../helper\";\r\nimport category_first_column_template from \"./category_first_column\";\r\nimport placeholder_row_template from \"./placeholder_row\";\r\nimport upsell_template from \"./upsell\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\n\r\n/**\r\n * Product cagtegories condition type.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport default function product_categories_template(\r\n  data: any,\r\n  data_type: string,\r\n  is_deals = false\r\n) {\r\n  const {\r\n    add_prod_cat_label,\r\n    bogo_form_fields,\r\n    bogo_instructions,\r\n  } = acfw_edit_coupon;\r\n  const {\r\n    quantity: quantityLabel,\r\n    product_cat: categoryLabel,\r\n  } = bogo_form_fields;\r\n\r\n  const colspan: number = is_deals ? 4 : 3;\r\n  const priceTh: string = is_deals\r\n    ? `<th class=\"price\">Price/Discount</th>`\r\n    : \"\";\r\n  const instructions: string = is_deals\r\n    ? `${bogo_instructions.apply_default} ${bogo_instructions.multiple_items}`\r\n    : bogo_instructions.trigger_default;\r\n\r\n  let tbody: string = \"\";\r\n  let exclude: number[] = [];\r\n\r\n  if (data.length >= 1 && data_type == \"product-categories\") {\r\n    for (let product_cat of data) {\r\n      let {\r\n        category_id,\r\n        quantity,\r\n        discount_type,\r\n        discount_value,\r\n      } = product_cat;\r\n      let priceCol: string = is_deals\r\n        ? get_price_column(discount_type, discount_value)\r\n        : \"\";\r\n\r\n      exclude.push(category_id);\r\n      tbody += `\r\n                <tr>\r\n                    ${category_first_column_template(product_cat)}\r\n                    <td class=\"quantity\">${quantity}</td>\r\n                    ${priceCol}\r\n                    <td class=\"actions\">\r\n                        <a class=\"edit\" href=\"javascript:void(0)\"><span class=\"dashicons dashicons-edit\"></span></a>\r\n                        <a class=\"remove\" href=\"javascript:void(0)\"><span class=\"dashicons dashicons-no\"></span></a>\r\n                    </td>\r\n                </tr>\r\n            `;\r\n    }\r\n  } else {\r\n    tbody = placeholder_row_template(colspan, \"category\");\r\n  }\r\n\r\n  return `\r\n        <p class=\"instructions\">${instructions}</p>\r\n        <table class=\"acfw-styled-table\" \r\n            data-type=\"category\" \r\n            data-exclude=\"${esc_attr(JSON.stringify(exclude))}\" \r\n            data-isdeals=\"${is_deals}\">\r\n            <thead>\r\n                <tr>\r\n                    <th class=\"product-cat\">${categoryLabel}</th>\r\n                    <th class=\"quantity\">${quantityLabel}</th>\r\n                    ${priceTh}\r\n                    <th class=\"actions\"></th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>${tbody}</tbody>\r\n            <tfoot>\r\n                <tr>\r\n                    <td colspan=\"${colspan}\">\r\n                        <a class=\"add-table-row\" href=\"javascript:void(0);\">\r\n                            <i class=\"dashicons dashicons-plus\"></i>\r\n                            ${add_prod_cat_label}\r\n                        </a>\r\n                    </td>\r\n                </tr>\r\n            </tfoot>\r\n        </table>\r\n        ${upsell_template()}\r\n    `;\r\n}\r\n\r\n/**\r\n * Get price column.\r\n *\r\n * @param discount_type\r\n * @param discount_value\r\n */\r\nfunction get_price_column(\r\n  discount_type: string = \"override\",\r\n  discount_value: string = \"0\"\r\n) {\r\n  return `<td class=\"price\">\r\n        (${discount_type}) ${discount_value}\r\n    </td>`;\r\n}\r\n","import { esc_attr } from \"../../helper\";\r\n\r\n/**\r\n * Product table row first column template.\r\n * \r\n * @param data \r\n */\r\nexport default function product_first_column_template( data: any ): string {\r\n\r\n    const { product_id , product_label } = data;\r\n\r\n    return `\r\n    <td class=\"product product-${ product_id } object\" data-product=\"${ esc_attr( JSON.stringify(data) ) }\">\r\n        ${ product_label }\r\n    </td>\r\n    `\r\n}","import { esc_attr } from \"../../helper\";\r\nimport product_first_column_template from \"./product_first_column\";\r\nimport placeholder_row_template from \"./placeholder_row\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\n\r\n/**\r\n * Specific products condition type.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport default function specific_products_template(\r\n  data: any,\r\n  data_type: string,\r\n  is_deals: boolean = false\r\n) {\r\n  const { add_product_label, bogo_form_fields, bogo_instructions } =\r\n    acfw_edit_coupon;\r\n  const { quantity: quantityLabel, product: productLabel } = bogo_form_fields;\r\n\r\n  const instructions: string = is_deals\r\n    ? `${bogo_instructions.apply_default}`\r\n    : bogo_instructions.trigger_default;\r\n\r\n  const colspan: number = is_deals ? 4 : 3;\r\n  const priceTh: string = is_deals\r\n    ? `<th class=\"price\">Price/Discount</th>`\r\n    : \"\";\r\n\r\n  let tbody: string = \"\";\r\n  let exclude: number[] = [];\r\n\r\n  if (data.length >= 1 && data_type == \"specific-products\") {\r\n    for (let product of data) {\r\n      let { quantity, discount_type, discount_value } = product;\r\n      let priceCol: string = is_deals\r\n        ? get_price_column(discount_type, discount_value)\r\n        : \"\";\r\n\r\n      exclude.push(product.product_id);\r\n      tbody += `\r\n        <tr>\r\n          ${product_first_column_template(product)}\r\n          <td class=\"quantity\">${quantity}</td>\r\n          ${priceCol}\r\n          <td class=\"actions\">\r\n            <a class=\"edit\" href=\"javascript:void(0)\"><span class=\"dashicons dashicons-edit\"></span></a>\r\n            <a class=\"remove\" href=\"javascript:void(0)\"><span class=\"dashicons dashicons-no\"></span></a>\r\n          </td>\r\n        </tr>\r\n      `;\r\n    }\r\n  } else {\r\n    tbody = placeholder_row_template(colspan);\r\n  }\r\n\r\n  const markup = `\r\n    <p class=\"instructions\">${instructions}</p>\r\n    <table class=\"product-quantity-condition-table acfw-styled-table\" \r\n      data-type=\"product\" data-exclude=\"${esc_attr(JSON.stringify(exclude))}\" \r\n      data-isdeals=\"${is_deals}\">\r\n      <thead>\r\n        <tr>\r\n          <th class=\"product\">${productLabel}</th>\r\n          <th class=\"quantity\">${quantityLabel}</th>\r\n          ${priceTh}\r\n          <th class=\"actions\"></th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>${tbody}</tbody>\r\n      <tfoot>\r\n        <tr>\r\n          <td colspan=\"${colspan}\">\r\n            <a class=\"add-table-row\" href=\"javascript:void(0);\">\r\n              <i class=\"dashicons dashicons-plus\"></i>\r\n              ${add_product_label}\r\n            </a>\r\n          </td>\r\n        </tr>\r\n      </tfoot>\r\n    </table>\r\n  `;\r\n\r\n  return markup;\r\n}\r\n\r\n/**\r\n * Get price column.\r\n *\r\n * @param discount_type\r\n * @param discount_value\r\n */\r\nfunction get_price_column(\r\n  discount_type: string = \"override\",\r\n  discount_value: string = \"0\"\r\n) {\r\n  return `<td class=\"price\">\r\n    (${discount_type}) ${discount_value}\r\n  </td>`;\r\n}\r\n","import { esc_attr } from \"../../helper\";\r\nimport upsell_template from \"./upsell\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\n\r\n/**\r\n * Any Products template.\r\n */\r\nexport default function any_products_template(data: any, isDeals = false) {\r\n  if (isDeals) return apply_template(data);\r\n  else return trigger_template(data);\r\n}\r\n\r\n/**\r\n * Any products trigger template.\r\n *\r\n * @since 2.6\r\n *\r\n * @param data\r\n */\r\nfunction trigger_template(data: any) {\r\n  const { quantity } = data;\r\n  const { bogo_instructions, bogo_form_fields } = acfw_edit_coupon;\r\n\r\n  return `\r\n    <p class=\"instructions\">${bogo_instructions.anyproducts_trigger}</p>\r\n    <div class=\"any-products-trigger-form any-products-form\" data-anyproducts=\"${esc_attr(\r\n      JSON.stringify(data)\r\n    )}\">\r\n      <div class=\"trigger-field-row trigger-quantity-field-row\">\r\n        <label for=\"any_products_trigger_qty\">${\r\n          bogo_form_fields.trigger_quantity\r\n        }</label>\r\n        <input type=\"number\" id=\"any_products_trigger_qty\" class=\"condition-quantity\" value=\"${\r\n          quantity ?? \"1\"\r\n        }\" min=\"1\" />\r\n      </div>\r\n    </div>\r\n    ${upsell_template()}\r\n  `;\r\n}\r\n\r\n/**\r\n * Any products apply template.\r\n *\r\n * @since 2.6\r\n *\r\n * @param data\r\n */\r\nfunction apply_template(data: any) {\r\n  const { quantity, discount_type, discount_value } = data;\r\n  const {\r\n    currency_symbol,\r\n    discount_field_options,\r\n    bogo_form_fields,\r\n    bogo_instructions,\r\n  } = acfw_edit_coupon;\r\n  const { override, percent, fixed } = discount_field_options;\r\n  const {\r\n    quantity: quantityLabel,\r\n    price_discount: priceDiscountLabel,\r\n    discount_type: discountTypeLabel,\r\n  } = bogo_form_fields;\r\n\r\n  const priceType: string = discount_type ? data.discount_type : \"override\";\r\n\r\n  return `\r\n    <p class=\"instructions\">${bogo_instructions.anyproducts_apply}</p>\r\n    <table class=\"acfw-styled-table any-products-apply-form any-products-form\" data-anyproducts=\"${esc_attr(\r\n      JSON.stringify(data)\r\n    )}\">\r\n      <thead>\r\n        <tr>\r\n          <th class=\"quantity\">${quantityLabel}</th>\r\n          <th class=\"type\">${discountTypeLabel}</th>\r\n          <th class=\"price\">${priceDiscountLabel}</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr>\r\n          <td class=\"quantity object\">\r\n            <input type=\"number\" class=\"condition-quantity\" value=\"${\r\n              quantity ?? \"1\"\r\n            }\" min=\"1\">\r\n          </td>\r\n          <td class=\"type\">\r\n            <select class=\"discount_type\">\r\n              <option value=\"override\" ${\r\n                priceType == \"override\" ? \"selected\" : \"\"\r\n              }>${currency_symbol} : ${override}</option>\r\n              <option value=\"percent\" ${\r\n                priceType == \"percent\" ? \"selected\" : \"\"\r\n              }>% : ${percent}</option>\r\n              <option value=\"fixed\" ${\r\n                priceType == \"fixed\" ? \"selected\" : \"\"\r\n              }>-${currency_symbol} : ${fixed}</option>\r\n            </select>\r\n          </td>\r\n          <td class=\"price\">\r\n            <input type=\"text\" class=\"discount_value short wc_input_price\" value=\"${\r\n              discount_value ?? \"0\"\r\n            }\">\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n    ${upsell_template()}\r\n  `;\r\n}\r\n","import combination_products_template from \"./templates/combination_products\";\r\nimport product_categories_template from \"./templates/product_categories\";\r\nimport specific_products_template from \"./templates/specific_products\";\r\nimport any_products_template from \"./templates/any_products\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\ndeclare var vex: any;\r\n\r\nconst $: any = jQuery;\r\nconst module_block: HTMLElement = document.querySelector(\"#acfw_bogo_deals\");\r\n\r\n/**\r\n * Toggle editing mode.\r\n *\r\n * @since 1.0.0\r\n *\r\n * @param {toggle} bool True to toggle editing mode, false otherwise.\r\n */\r\nexport function toggle_editing_mode(toggle: boolean) {\r\n  $(module_block).data(\"editing\", toggle);\r\n  $(module_block).find(\"#save-bogo-deals\").prop(\"disabled\", !toggle);\r\n}\r\n\r\n/**\r\n * Toggle condition type.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport function toggle_block_data_type(e: JQuery.Event) {\r\n  const $select: JQuery = $(this),\r\n    block_type: string = $select.data(\"block\"),\r\n    condition_block: HTMLElement = module_block.querySelector(\r\n      \".bogo-conditions-block\"\r\n    ),\r\n    deals_block: HTMLElement = module_block.querySelector(\r\n      \".bogo-product-deals-block\"\r\n    ),\r\n    bogo_deals: any = $(module_block).data(\"bogo_deals\"),\r\n    conditions: any = bogo_deals.conditions ? bogo_deals.conditions : null,\r\n    deals: any = bogo_deals.deals ? bogo_deals.deals : null,\r\n    block_data_type: string =\r\n      block_type == \"conditions\"\r\n        ? bogo_deals.conditions_type\r\n        : bogo_deals.deals_type;\r\n\r\n  // get correct block data.\r\n  let block_data: any = null;\r\n  if (\"conditions\" === block_type)\r\n    block_data =\r\n      bogo_deals.conditions_type == $select.val() ? conditions : block_data;\r\n  else block_data = bogo_deals.deals_type == $select.val() ? deals : block_data;\r\n\r\n  const isDeal = block_type == \"deals\";\r\n\r\n  let isPremium = false,\r\n    markup,\r\n    tempBlock;\r\n\r\n  switch ($select.val()) {\r\n    case \"combination-products\":\r\n      markup = combination_products_template(block_data ?? {}, isDeal);\r\n      isPremium = true;\r\n      break;\r\n\r\n    case \"product-categories\":\r\n      markup = product_categories_template(\r\n        block_data ?? [],\r\n        block_data_type,\r\n        isDeal\r\n      );\r\n      isPremium = true;\r\n      break;\r\n\r\n    case \"any-products\":\r\n      markup = any_products_template(block_data ?? {}, isDeal);\r\n      isPremium = true;\r\n      break;\r\n\r\n    case \"specific-products\":\r\n    default:\r\n      markup = specific_products_template(\r\n        block_data ?? [],\r\n        block_data_type,\r\n        isDeal\r\n      );\r\n      isPremium = false;\r\n      break;\r\n  }\r\n\r\n  if (block_type == \"conditions\") {\r\n    $(condition_block)\r\n      .html(markup)\r\n      .find(\"input.condition-quantity\")\r\n      .trigger(\"change\" === e.type ? \"change\" : \"acfw_fetch_data\");\r\n    tempBlock = condition_block;\r\n  } else {\r\n    const $multipleDesc = $(module_block).find(\".multiple-items-desc\");\r\n\r\n    if (\"specific-products\" !== $select.val()) $multipleDesc.show();\r\n    else $multipleDesc.hide();\r\n\r\n    $(deals_block)\r\n      .html(markup)\r\n      .find(\"input.condition-quantity\")\r\n      .trigger(\"change\" === e.type ? \"change\" : \"acfw_fetch_data\");\r\n    tempBlock = deals_block;\r\n  }\r\n\r\n  if (isPremium && undefined !== acfw_edit_coupon.upsell)\r\n    $(tempBlock).addClass(\"premium-only\");\r\n  else $(tempBlock).removeClass(\"premium-only\");\r\n\r\n  $(\"body\").trigger(\"wc-enhanced-select-init\");\r\n  $(\"body\").trigger(\"init_tooltips\");\r\n}\r\n\r\n/**\r\n * Force apply type to \"Same Product\" block when \"each-product\" is selected as base for Any Products trigger.\r\n *\r\n * @since 1.4\r\n */\r\nexport function forceApplyToSameProductForEachProductBase() {\r\n  const $this = $(this);\r\n  const $module = $this.closest(\"#acfw_bogo_deals\");\r\n  const $applySelect = $module.find(\"#bogo-deals-type\");\r\n  const base = $this.val();\r\n\r\n  if (\"each-product\" === base) {\r\n    $applySelect.val(\"same-products\").trigger(\"change\");\r\n  }\r\n}\r\n\r\nfunction validateTriggerApplyCompatibility($select: JQuery, isDeals: boolean) {\r\n  const $module: JQuery = $select.closest(\"#acfw_bogo_deals\");\r\n  const triggerType: string = $module\r\n    .find(\"select#bogo-condition-type\")\r\n    .val()\r\n    .toString();\r\n  const applyType: string = $module\r\n    .find(\"select#bogo-deals-type\")\r\n    .val()\r\n    .toString();\r\n  const baseType = $module\r\n    .find(\"input[name='acfw_bogo_trigger_base']:checked\")\r\n    .val();\r\n\r\n  if (\r\n    isDeals &&\r\n    \"any-products\" === triggerType &&\r\n    \"each-product\" === baseType &&\r\n    \"same-products\" !== applyType\r\n  ) {\r\n    $select.val(\"same-products\");\r\n    vex.dialog.alert({\r\n      unsafeMessage: `Any products trigger type based on each product's quantity can only work with <code>Same Products</code> apply type.`,\r\n    });\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n","import { toggle_overlay, validateDiscount } from \"../helper\";\r\nimport { toggle_editing_mode } from \"./toggles\";\r\nimport placeholder_table_row_template from \"./templates/placeholder_row\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\ndeclare var woocommerce_admin_meta_boxes: any;\r\ndeclare var ajaxurl: string;\r\ndeclare var vex: any;\r\n\r\nconst $: any = jQuery;\r\nconst module_block: HTMLElement = document.querySelector(\"#acfw_bogo_deals\");\r\nconst { post_id } = woocommerce_admin_meta_boxes;\r\n\r\n/**\r\n * Save BOGO Deals.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function save_bogo_deals() {\r\n  // cancel product table edit form rows.\r\n  $(\"#acfw_bogo_deals\")\r\n    .find(\".acfw-styled-table tr.add-edit-form button.cancel\")\r\n    .trigger(\"click\");\r\n\r\n  const { post_status, upsell } = acfw_edit_coupon;\r\n\r\n  const condition_rows: NodeList = module_block.querySelectorAll(\r\n      \".bogo-conditions-block table.acfw-styled-table tbody td.object,.bogo-conditions-block .any-products-trigger-form\"\r\n    ),\r\n    deal_rows: NodeList = module_block.querySelectorAll(\r\n      \".bogo-product-deals-block table.acfw-styled-table tbody td.object\"\r\n    ),\r\n    overlay: HTMLElement = module_block.querySelector(\".acfw-overlay\"),\r\n    type_field: HTMLInputElement = module_block.querySelector(\r\n      \"input[name='bogo_type']:checked\"\r\n    ),\r\n    conditions_type: string = $(module_block)\r\n      .find(\"#bogo-condition-type\")\r\n      .val(),\r\n    deals_type: string = $(module_block).find(\"#bogo-deals-type\").val(),\r\n    $notice_options: JQuery = $(module_block).find(\".notice-option\");\r\n\r\n  const conditions: any = get_data(condition_rows, conditions_type);\r\n  const deals: any = get_data(deal_rows, deals_type);\r\n  const type: string = type_field ? type_field.value : null;\r\n\r\n  // error flag variables.\r\n  let isTriggerError: boolean = false;\r\n  let isApplyError: boolean = false;\r\n\r\n  // validate any products trigger data.\r\n  if (\"any-products\" === conditions_type) {\r\n    isTriggerError = conditions?.quantity < 1;\r\n  }\r\n\r\n  // validate any products apply data.\r\n  if (\"any-products\" === deals_type) {\r\n    isApplyError =\r\n      !deals?.discount_type || !deals?.discount_value || deals?.quantity < 1;\r\n  }\r\n\r\n  // validate combination products trigger data.\r\n  if (\"combination-products\" === conditions_type) {\r\n    isTriggerError = !conditions?.products?.length || conditions?.quantity < 1;\r\n  }\r\n\r\n  // validate combination products apply data.\r\n  if (\"combination-products\" === deals_type) {\r\n    isApplyError =\r\n      !deals?.products?.length ||\r\n      !deals?.discount_type ||\r\n      !deals?.discount_value ||\r\n      deals?.quantity < 1;\r\n  }\r\n\r\n  if (\r\n    conditions?.length < 1 ||\r\n    deals?.length < 1 ||\r\n    !type ||\r\n    isTriggerError ||\r\n    isApplyError\r\n  ) {\r\n    vex.dialog.alert(acfw_edit_coupon.bogo_deals_save_error_msg);\r\n\r\n    // Add save error flag class in #acfw_bogo_deals\r\n    $(module_block).addClass(\"save-error\");\r\n    return;\r\n  }\r\n\r\n  if (\r\n    upsell !== undefined &&\r\n    (conditions_type !== \"specific-products\" ||\r\n      deals_type !== \"specific-products\")\r\n  ) {\r\n    vex.dialog.alert(acfw_edit_coupon.bogo_deals_save_error_msg);\r\n\r\n    // Add save error flag class in #acfw_bogo_deals\r\n    $(module_block).addClass(\"save-error\");\r\n    return;\r\n  }\r\n\r\n  // validate discount by type for any products and combination products deal type.\r\n  if (\r\n    [\"any-products\", \"combination-products\"].includes(deals_type) &&\r\n    !validateDiscount(deals?.discount_type, deals?.discount_value)\r\n  ) {\r\n    vex.dialog.alert(acfw_edit_coupon.discount_type_value_error_msg);\r\n\r\n    // Add save error flag class in #acfw_bogo_deals\r\n    $(module_block).addClass(\"save-error\");\r\n    return;\r\n  }\r\n\r\n  const notice_settings = {\r\n    message: $notice_options\r\n      .find(\"textarea[name='acfw_bogo_notice_message_text']\")\r\n      .val(),\r\n    button_text: $notice_options\r\n      .find(\"input[name='acfw_bogo_notice_button_text']\")\r\n      .val(),\r\n    button_url: $notice_options\r\n      .find(\"input[name='acfw_bogo_notice_button_url']\")\r\n      .val(),\r\n    notice_type: $notice_options\r\n      .find(\"select[name='acfw_bogo_notice_type']\")\r\n      .val(),\r\n  };\r\n\r\n  toggle_overlay(overlay, \"show\");\r\n\r\n  $(module_block).trigger(\"save_bogo_deals\");\r\n\r\n  const dataToSave = {\r\n    conditions: conditions,\r\n    deals: deals,\r\n    conditions_type: conditions_type,\r\n    deals_type: deals_type,\r\n    type: type,\r\n    notice_settings: notice_settings,\r\n  };\r\n\r\n  $.post(\r\n    ajaxurl,\r\n    {\r\n      action: \"acfw_save_bogo_deals\",\r\n      coupon_id: post_id,\r\n      ...dataToSave,\r\n    },\r\n    (response: any) => {\r\n      if (response.status == \"success\") {\r\n        // replace data in state with latest one.\r\n        $(module_block).data(\"bogo_deals\", dataToSave);\r\n\r\n        // if coupon is not published yet, then save it as draft.\r\n        if (post_status !== \"publish\") {\r\n          if (!$(\"input[name='post_title']\").val())\r\n            $(\"input[name='post_title']\").val(\"coupon-\" + post_id);\r\n\r\n          $(\"select[name='post_status']\")\r\n            .append(new Option(\"Published\", \"publish\"))\r\n            .val(\"publish\");\r\n\r\n          $(\"#publishing-action\").append(`\r\n                    <input type=\"hidden\" name=\"publish\" value=\"Publish\">\r\n                `);\r\n          $(\"input#publish\").click();\r\n        }\r\n      } else {\r\n        if (response.error_msg) vex.dialog.alert(response.error_msg);\r\n      }\r\n\r\n      $(module_block).find(\"#clear-bogo-deals\").prop(\"disabled\", false);\r\n      toggle_editing_mode(false);\r\n      toggle_overlay(overlay, \"hide\");\r\n    },\r\n    \"json\"\r\n  );\r\n}\r\n\r\n/**\r\n * Get BOGO Deals data.\r\n *\r\n * @since 1.0.0\r\n *\r\n * @param rows\r\n * @param type\r\n */\r\nfunction get_data(rows: NodeList, type: string): any {\r\n  let data = [],\r\n    temp;\r\n\r\n  switch (type) {\r\n    case \"any-products\":\r\n      data = $(rows).closest(\".any-products-form\").data(\"anyproducts\");\r\n      break;\r\n\r\n    case \"combination-products\":\r\n      data = $(rows).closest(\"table.combined-products-form\").data(\"combined\");\r\n      break;\r\n\r\n    case \"product-categories\":\r\n      rows.forEach((row: HTMLElement) => {\r\n        temp = jQuery(row).data(\"category\");\r\n        if (temp) data.push(temp);\r\n      });\r\n      break;\r\n\r\n    case \"specific-products\":\r\n    default:\r\n      rows.forEach((row: HTMLElement) => {\r\n        temp = jQuery(row).data(\"product\");\r\n        if (temp) data.push(temp);\r\n      });\r\n      break;\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\n/**\r\n * Clear BOGO Deals.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function clear_bogo_deals() {\r\n  const $button: JQuery = $(this);\r\n\r\n  if (!confirm($button.data(\"prompt\"))) return;\r\n\r\n  const condition_rows: HTMLElement = module_block.querySelector(\r\n      \".bogo-conditions-block table.acfw-styled-table tbody\"\r\n    ),\r\n    deal_rows: HTMLElement = module_block.querySelector(\r\n      \".bogo-product-deals-block table.acfw-styled-table tbody\"\r\n    ),\r\n    overlay: HTMLElement = module_block.querySelector(\".acfw-overlay\"),\r\n    type_field: HTMLInputElement = module_block.querySelector(\r\n      \"input[name='bogo_type']:checked\"\r\n    );\r\n\r\n  toggle_overlay(overlay, \"show\");\r\n\r\n  $.post(\r\n    ajaxurl,\r\n    {\r\n      action: \"acfw_clear_bogo_deals\",\r\n      coupon_id: post_id,\r\n      _wpnonce: $button.data(\"nonce\"),\r\n    },\r\n    (response: any) => {\r\n      if (response.status == \"success\") {\r\n        $(condition_rows).html(placeholder_table_row_template(3));\r\n        $(deal_rows).html(placeholder_table_row_template(4));\r\n        $(type_field).prop(\"checked\", false);\r\n\r\n        $button.prop(\"disabled\", true);\r\n        toggle_editing_mode(false);\r\n\r\n        // if coupon is not published yet, then save it as draft.\r\n        if ($(\"#post-status-display\").text() != \"Published\") {\r\n          if (!$(\"input[name='post_title']\").val())\r\n            $(\"input[name='post_title']\").val(\"coupon-\" + post_id);\r\n\r\n          $(\"input#publish\").click();\r\n        }\r\n      } else {\r\n        if (response.error_msg) vex.dialog.alert(response.error_msg);\r\n      }\r\n\r\n      toggle_overlay(overlay, \"hide\");\r\n    },\r\n    \"json\"\r\n  );\r\n}\r\n\r\n/**\r\n * Update combined products list.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport function update_combined_products_list() {\r\n  const $table: JQuery = $(this).closest(\"table.combined-products-form\"),\r\n    current_data: any = $table.data(\"combined\"),\r\n    $options: JQuery = $table.find(\".wc-product-search option:selected\"),\r\n    quantity: number = parseInt(\r\n      $table.find(\"input.condition-quantity\").val() + \"\"\r\n    ),\r\n    conditions: any = { products: [], quantity: quantity },\r\n    is_deals: string = $table.data(\"isdeals\");\r\n\r\n  if (is_deals) {\r\n    const $discount_type: JQuery = $table.find(\"select.discount_type\"),\r\n      $discount_value: JQuery = $table.find(\"input.discount_value\"),\r\n      discount_val: number = parseFloat($discount_value.val().toString());\r\n\r\n    if (discount_val < 0 || isNaN(discount_val)) {\r\n      $discount_value.val(current_data ? current_data.discount_value : \"\");\r\n      vex.dialog.alert(acfw_edit_coupon.fill_form_propery_error_msg);\r\n      return;\r\n    } else {\r\n      conditions.discount_type = $discount_type.val();\r\n      conditions.discount_value = $discount_value.val();\r\n    }\r\n  }\r\n\r\n  let $temp, x;\r\n\r\n  for (x = 0; x < $options.length; x++) {\r\n    $temp = $($options[x]);\r\n    conditions.products.push({ product_id: $temp.val(), label: $temp.text() });\r\n  }\r\n\r\n  $table.data(\"combined\", conditions);\r\n  toggle_editing_mode(true);\r\n}\r\n\r\n/**\r\n * Save on coupon publish.\r\n *\r\n * @since 1.1.0\r\n *\r\n * @param {e} object Event Object.\r\n */\r\nexport function save_on_coupon_publish(e: Event) {\r\n  if (!$(module_block).data(\"editing\")) return;\r\n\r\n  e.preventDefault();\r\n  $(module_block).find(\"#save-bogo-deals\").trigger(\"click\");\r\n\r\n  // delay for 1 second to give time for\r\n  setTimeout(() => {\r\n    // If BOGO Deals displays an error message then don't save the coupon\r\n    if ($(module_block).hasClass(\"save-error\"))\r\n      $(module_block).removeClass(\"save-error\");\r\n    else $(\"form#post\").submit();\r\n  }, 1000);\r\n}\r\n\r\n/**\r\n * Update any products trigger data when an input in the block's value is changed.\r\n *\r\n * @since 1.4\r\n */\r\nexport function update_any_products_trigger_data(e: JQuery.Event) {\r\n  const $block = $(this).closest(\".any-products-trigger-form\");\r\n  const quantity: number = parseInt(\r\n    $block.find(\"input#any_products_trigger_qty\").val()\r\n  );\r\n  const data = {\r\n    quantity: quantity && !isNaN(quantity) ? quantity : 0,\r\n  };\r\n\r\n  $block.data(\"anyproducts\", data);\r\n  if (e.type === \"change\") toggle_editing_mode(true);\r\n}\r\n\r\n/**\r\n * Update any products apply data when an input in the block's value is changed.\r\n *\r\n * @since 1.4\r\n */\r\nexport function update_any_products_apply_data(e: JQuery.Event) {\r\n  const $block = $(this).closest(\".any-products-apply-form\");\r\n  const quantity: number = parseInt(\r\n    $block.find(\"input.condition-quantity\").val()\r\n  );\r\n  const discountType: string = $block\r\n    .find(\"select.discount_type\")\r\n    .val()\r\n    .toString();\r\n  const discountValue: string = $block\r\n    .find(\"input.discount_value\")\r\n    .val()\r\n    .toString();\r\n\r\n  const data = {\r\n    quantity: quantity && !isNaN(quantity) ? quantity : 0,\r\n    discount_type: discountType ?? \"\",\r\n    discount_value: discountValue ?? \"\",\r\n  };\r\n\r\n  $block.data(\"anyproducts\", data);\r\n  if (e.type === \"change\") toggle_editing_mode(true);\r\n}\r\n","import { esc_attr } from \"../../helper\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\n\r\n/**\r\n * Add edit row template.\r\n *\r\n * @since 1.15\r\n *\r\n * @param type\r\n * @param exclude\r\n * @param is_deals\r\n */\r\nexport default function add_edit_row_template(\r\n  type: string,\r\n  exclude: number[],\r\n  is_deals: string,\r\n  data: any = false\r\n): string {\r\n  const { type_to_search } = acfw_edit_coupon.bogo_form_fields;\r\n  const { add, edit, cancel } = acfw_edit_coupon.product_table_buttons;\r\n  const { quantity } = data;\r\n\r\n  const option: string = typeof data == \"object\" ? get_option(type, data) : \"\";\r\n  const priceCol: string = is_deals ? get_price_column(data) : \"\";\r\n  const btnText: string = typeof data == \"object\" ? edit : add;\r\n\r\n  return `\r\n    <tr class=\"add-edit-form adding\">\r\n        <td class=\"product\" data-object=\"${\r\n          typeof data == \"object\" ? esc_attr(JSON.stringify(data)) : 0\r\n        }\">\r\n            <div class=\"object-search-wrap\">\r\n                <select class=\"${\r\n                  type == \"category\"\r\n                    ? \"product-category-in-cart\"\r\n                    : \"product-in-cart\"\r\n                } wc-product-search\"\r\n                    data-placeholder=\"${type_to_search}\"\r\n                    data-action=\"${\r\n                      type == \"category\"\r\n                        ? \"acfw_search_product_category\"\r\n                        : \"acfw_search_products\"\r\n                    }\"\r\n                    data-exclude=\"${esc_attr(\r\n                      JSON.stringify(exclude)\r\n                    )}\">${option}</select>\r\n            </div>\r\n        </td>\r\n        <td class=\"quantity\">\r\n            <input type=\"number\" class=\"condition-quantity\" value=\"${\r\n              typeof data == \"object\" ? quantity : 1\r\n            }\" min=\"1\">\r\n        </td>\r\n        ${priceCol}\r\n        <td class=\"actions\">\r\n            <button type=\"button\" class=\"condition-product-add button-primary\">${btnText}</button>\r\n            <button type=\"button\" class=\"cancel button\">${cancel}</button>\r\n        </td>\r\n    </tr>\r\n    `;\r\n}\r\n\r\n/**\r\n * Get option markup.\r\n *\r\n * @since 1.15\r\n *\r\n * @param type\r\n * @param data\r\n */\r\nfunction get_option(type: string, data: any): string {\r\n  const { category_id, product_id, category_label, product_label } = data;\r\n  const value: string = type == \"category\" ? category_id : product_id;\r\n  const label: string = type == \"category\" ? category_label : product_label;\r\n\r\n  return `<option value=\"${value}\">${label}</option>`;\r\n}\r\n\r\nfunction get_price_column(data: any): string {\r\n  const { currency_symbol, discount_field_options } = acfw_edit_coupon;\r\n  const { override, percent, fixed } = discount_field_options;\r\n  const { discount_type, discount_value } = data;\r\n  const value: string =\r\n    typeof data == \"object\" && discount_value ? discount_value : \"0\";\r\n\r\n  return `\r\n    <td class=\"price\">\r\n        <div>\r\n        <select class=\"discount_type\">\r\n            <option value=\"override\" ${\r\n              discount_type == \"override\" ? \"selected\" : \"\"\r\n            }>${currency_symbol} : ${override}</option>\r\n            <option value=\"percent\" ${\r\n              discount_type == \"percent\" ? \"selected\" : \"\"\r\n            }>% : ${percent}</option>\r\n            <option value=\"fixed\" ${\r\n              discount_type == \"fixed\" ? \"selected\" : \"\"\r\n            }>-${currency_symbol} : ${fixed}</option>\r\n        </select>\r\n        <input type=\"text\" class=\"discount_value short wc_input_price\" value=\"${value}\">\r\n        </div>\r\n    </td>\r\n    `;\r\n}\r\n","\r\nimport category_first_column_template from \"./category_first_column\";\r\nimport product_first_column_template from \"./product_first_column\";\r\n\r\n/**\r\n * Table single row markup.\r\n * \r\n * @since 1.15\r\n * \r\n * @param data \r\n * @param type \r\n * @param is_deals \r\n */\r\nexport default function table_row_template( data: any , type: string , is_deals: string ): string {\r\n\r\n    const { quantity , discount_type ,discount_value } = data;\r\n    const priceCol: string = is_deals ? `<td class=\"price\">(${ discount_type }) ${ discount_value }</td>` : \"\";\r\n\r\n    return `\r\n    <tr>\r\n        ${ get_first_column_markup( data , type ) }\r\n        <td class=\"quantity\">${ quantity }</td>\r\n        ${ priceCol }\r\n        <td class=\"actions\">\r\n            <a class=\"edit\" href=\"javascript:void(0)\"><span class=\"dashicons dashicons-edit\"></span></a>\r\n            <a class=\"remove\" href=\"javascript:void(0)\"><span class=\"dashicons dashicons-no\"></span></a>\r\n        </td>\r\n    </tr>`;\r\n}\r\n\r\n/**\r\n * Get first column markup.\r\n * \r\n * @since 1.15\r\n * \r\n * @param data \r\n * @param type \r\n */\r\nfunction get_first_column_markup( data: any, type: string ): string {\r\n\r\n    switch ( type ) {\r\n        case \"category\" :\r\n            return category_first_column_template( data );\r\n        case \"product\" :\r\n            return product_first_column_template( data );\r\n    }\r\n}","import { toggle_editing_mode } from \"./toggles\";\r\nimport { price_to_float, validateDiscount } from \"../helper\";\r\n\r\nimport add_edit_row_template from \"./templates/add_edit_row\";\r\nimport table_row_template from \"./templates/table_row\";\r\nimport placeholder_table_row_template from \"./templates/placeholder_row\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\ndeclare var vex: any;\r\n\r\nconst $: any = jQuery;\r\nconst { bogo_form_fields } = acfw_edit_coupon;\r\n\r\n/**\r\n * Trigger the add table row form event.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport function trigger_add_table_row_form() {\r\n  const $button: JQuery = $(this),\r\n    $table: JQuery = $button.closest(\".acfw-styled-table\"),\r\n    $tbody: JQuery = $table.find(\"tbody\"),\r\n    is_deals: string = $table.data(\"isdeals\"),\r\n    type: string = $table.data(\"type\"),\r\n    exclude: number[] = $table.data(\"exclude\");\r\n\r\n  $tbody.find(\"tr.no-result\").remove();\r\n\r\n  $tbody.append(add_edit_row_template(type, exclude, is_deals));\r\n  $(\"body\").trigger(\"wc-enhanced-select-init\");\r\n\r\n  $tbody.find(\"tr.add-edit-form select.enhanced\").trigger(\"focus\");\r\n}\r\n\r\n/**\r\n * Trigger the edit table row form event.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport function trigger_edit_table_row_form() {\r\n  const $button: JQuery = jQuery(this),\r\n    $row: JQuery = $button.closest(\"tr\"),\r\n    $table: JQuery = $button.closest(\".acfw-styled-table\"),\r\n    $tbody: JQuery = $table.find(\"tbody\"),\r\n    is_deals: string = $table.data(\"isdeals\"),\r\n    type: string = $table.data(\"type\"),\r\n    data: any = $row.find(\".object\").data(type);\r\n\r\n  const { category_id, product_id } = data;\r\n  const exclude: number[] = $table.data(\"exclude\");\r\n  const object_id: number = type == \"category\" ? category_id : product_id;\r\n\r\n  exclude.splice(exclude.indexOf(object_id), 1);\r\n  $tbody.find(\"tr.no-result\").remove();\r\n  $row.replaceWith(add_edit_row_template(type, exclude, is_deals, data));\r\n  $table.data(\"exclude\", exclude);\r\n  $table.find(\".wc-product-search\").data(\"exclude\", exclude);\r\n  $(\"body\").trigger(\"wc-enhanced-select-init\");\r\n}\r\n\r\n/**\r\n * Trigger the cancel add/edit table row form event.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport function cancel_add_edit_table_row() {\r\n  const $button: JQuery = $(this),\r\n    $row: JQuery = $button.closest(\"tr\"),\r\n    $table: JQuery = $button.closest(\"table\"),\r\n    $tbody: JQuery = $row.closest(\"tbody\"),\r\n    is_deals: string = $table.data(\"isdeals\"),\r\n    colspan: number = $row.find(\"td\").length,\r\n    type: string = $table.data(\"type\"),\r\n    data: any = $row.find(\"td.product\").data(\"object\");\r\n\r\n  const { category_id, product_id } = data;\r\n  const exclude: number[] = $table.data(\"exclude\");\r\n  const object_id = type == \"category\" ? category_id : product_id;\r\n\r\n  // don't proceed if product has already been added to the table.\r\n  // this happens when the same product/category has been added to a new row and trying to cancel the row that already has the same value.\r\n  if (exclude.includes(object_id)) {\r\n    vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);\r\n    return;\r\n  }\r\n\r\n  if (typeof data == \"object\") {\r\n    exclude.push(object_id);\r\n    $row.replaceWith(table_row_template(data, type, is_deals));\r\n    $table.data(\"exclude\", exclude);\r\n    $table.find(\".wc-product-search\").data(\"exclude\", exclude);\r\n  } else {\r\n    $row.remove();\r\n\r\n    if ($tbody.find(\"tr\").length <= 0)\r\n      $tbody.append(placeholder_table_row_template(colspan, type));\r\n  }\r\n}\r\n\r\n/**\r\n * Actual function that saves/edits the table row.\r\n *\r\n * @since 1.1.0\r\n */\r\nexport function add_edit_table_row() {\r\n  const $button: JQuery = $(this),\r\n    $row: JQuery = $button.closest(\"tr\"),\r\n    $table: JQuery = $button.closest(\"table.acfw-styled-table\"),\r\n    is_deals: string = $table.data(\"isdeals\"),\r\n    type: string = $table.data(\"type\"),\r\n    $search: JQuery = $row.find(\".wc-product-search\"),\r\n    $quantity: JQuery = $row.find(\".condition-quantity\");\r\n\r\n  const exclude = $table.data(\"exclude\");\r\n\r\n  if (!$search.val() || !$quantity.val() || $quantity.val() < 1) {\r\n    vex.dialog.alert(acfw_edit_coupon.fill_form_propery_error_msg);\r\n    return;\r\n  }\r\n\r\n  // don't proceed if product has already been added to the table.\r\n  if (exclude.includes(parseInt($search.val().toString()))) {\r\n    vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);\r\n    return;\r\n  }\r\n\r\n  // dont allow negative value for discount/price field.\r\n  if (is_deals) {\r\n    const discount_val = $row.find(\"input.discount_value\").val().toString();\r\n\r\n    // validate discount by type.\r\n    if (\r\n      !validateDiscount(\r\n        $row.find(\"select.discount_type\").val().toString(),\r\n        discount_val\r\n      )\r\n    ) {\r\n      vex.dialog.alert(acfw_edit_coupon.discount_type_value_error_msg);\r\n      return;\r\n    }\r\n\r\n    if (\r\n      price_to_float(discount_val) < 0 ||\r\n      isNaN(price_to_float(discount_val))\r\n    ) {\r\n      vex.dialog.alert(acfw_edit_coupon.fill_form_propery_error_msg);\r\n      return;\r\n    }\r\n  }\r\n\r\n  const data: any = get_table_row_data($row, type, is_deals);\r\n  const { category_id, product_id } = data;\r\n\r\n  exclude.push(type == \"category\" ? category_id : product_id);\r\n  $row.replaceWith(table_row_template(data, type, is_deals));\r\n  $table.data(\"exclude\", exclude);\r\n  $table.find(\".wc-product-search\").data(\"exclude\", exclude);\r\n  toggle_editing_mode(true);\r\n}\r\n\r\n/**\r\n * Remove product in table.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport function product_table_remove_product() {\r\n  const $button: JQuery = $(this),\r\n    $object_row: JQuery = $button.closest(\"tr\"),\r\n    $table: JQuery = $object_row.closest(\"table\"),\r\n    $tbody: JQuery = $object_row.closest(\"tbody\"),\r\n    colspan: number = $object_row.find(\"td\").length,\r\n    type: string = $table.data(\"type\");\r\n\r\n  const data = $object_row.find(\"td.object\").data(type);\r\n  const exclude = $table.data(\"exclude\");\r\n  let index: number;\r\n\r\n  switch (type) {\r\n    case \"category\":\r\n      index = exclude.indexOf(parseInt(data.category_id));\r\n      break;\r\n\r\n    case \"product\":\r\n    default:\r\n      index = exclude.indexOf(parseInt(data.product_id));\r\n      break;\r\n  }\r\n\r\n  if (index !== -1) exclude.splice(index, 1);\r\n  $table.data(\"exclude\", exclude);\r\n  $table.find(\".wc-product-search\").data(\"exclude\", exclude);\r\n\r\n  $object_row.remove();\r\n\r\n  if ($tbody.find(\"tr\").length <= 0)\r\n    $tbody.append(placeholder_table_row_template(colspan, type));\r\n\r\n  toggle_editing_mode(true);\r\n}\r\n\r\n/**\r\n * Get table row data.\r\n *\r\n * @since 1.15\r\n *\r\n * @param $row\r\n * @param type\r\n * @param is_deals\r\n */\r\nfunction get_table_row_data($row: JQuery, type: string, is_deals: string): any {\r\n  let object: any = {};\r\n\r\n  if (type == \"category\") {\r\n    object = {\r\n      category_id: parseInt($row.find(\".wc-product-search\").val() + \"\"),\r\n      quantity: parseInt($row.find(\".condition-quantity\").val() + \"\"),\r\n      category_label: $row.find(\".wc-product-search option:selected\").text(),\r\n    };\r\n  } else {\r\n    object = {\r\n      product_id: parseInt($row.find(\".wc-product-search\").val() + \"\"),\r\n      quantity: parseInt($row.find(\".condition-quantity\").val() + \"\"),\r\n      product_label: $row.find(\".wc-product-search option:selected\").text(),\r\n    };\r\n  }\r\n\r\n  if (is_deals) {\r\n    object.discount_type = $row.find(\"select.discount_type\").val();\r\n    object.discount_value = $row.find(\"input.discount_value\").val().toString();\r\n  }\r\n\r\n  return object;\r\n}\r\n","import { remove_leading_zeros } from \"../helper\";\r\nimport {\r\n  toggle_editing_mode,\r\n  toggle_block_data_type,\r\n  forceApplyToSameProductForEachProductBase,\r\n} from \"./toggles\";\r\nimport {\r\n  save_bogo_deals,\r\n  clear_bogo_deals,\r\n  update_combined_products_list,\r\n  update_any_products_trigger_data,\r\n  update_any_products_apply_data,\r\n  save_on_coupon_publish,\r\n} from \"./save\";\r\nimport {\r\n  trigger_add_table_row_form,\r\n  trigger_edit_table_row_form,\r\n  cancel_add_edit_table_row,\r\n  add_edit_table_row,\r\n  product_table_remove_product,\r\n} from \"./table\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\nconst $: any = jQuery;\r\nconst module_block: HTMLElement = document.querySelector(\"#acfw_bogo_deals\");\r\n\r\n/**\r\n * Export functions to be accessed by ACFWP.\r\n */\r\nacfw_edit_coupon = {\r\n  ...acfw_edit_coupon,\r\n  bogo_toggle_editing_mode: toggle_editing_mode,\r\n};\r\n\r\n/**\r\n * Add free products module events script.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport default function bogo_deals_module_events(): void {\r\n  $(module_block).on(\r\n    \"click\",\r\n    \".acfw-styled-table tfoot .add-table-row\",\r\n    trigger_add_table_row_form\r\n  );\r\n  $(module_block).on(\r\n    \"click\",\r\n    \".acfw-styled-table td.actions a.edit\",\r\n    trigger_edit_table_row_form\r\n  );\r\n  $(module_block).on(\r\n    \"click\",\r\n    \"tr.add-edit-form .actions .cancel\",\r\n    cancel_add_edit_table_row\r\n  );\r\n  $(module_block).on(\r\n    \"click\",\r\n    \"tr.add-edit-form .actions .condition-product-add\",\r\n    add_edit_table_row\r\n  );\r\n  $(module_block).on(\r\n    \"click\",\r\n    \".acfw-styled-table td.actions a.remove\",\r\n    product_table_remove_product\r\n  );\r\n  $(module_block).on(\"click\", \"button#save-bogo-deals\", save_bogo_deals);\r\n  $(module_block).on(\"click\", \"button#clear-bogo-deals\", clear_bogo_deals);\r\n  $(module_block).on(\r\n    \"change acfw_load\",\r\n    \"select#bogo-condition-type,select#bogo-deals-type\",\r\n    toggle_block_data_type\r\n  );\r\n  $(module_block).on(\r\n    \"change acfw_fetch_data\",\r\n    \".combined-products-form select,.combined-products-form input\",\r\n    update_combined_products_list\r\n  );\r\n  $(module_block).on(\r\n    \"change acfw_fetch_data\",\r\n    \".any-products-trigger-form input\",\r\n    update_any_products_trigger_data\r\n  );\r\n  $(module_block).on(\r\n    \"change acfw_fetch_data\",\r\n    \".any-products-apply-form input,.any-products-apply-form select\",\r\n    update_any_products_apply_data\r\n  );\r\n  $(module_block).on(\"change\", \".condition-quantity\", restrict_quantity_value);\r\n  $(module_block).on(\"blur\", \".wc_input_price\", remove_leading_zeros);\r\n  $(module_block).css(\"min-height\", $(\"#coupon_options\").height());\r\n  $(module_block).on(\"change\", \"input[name='bogo_type']\", trigger_toggle);\r\n  $(module_block).on(\r\n    \"click\",\r\n    \".acfw-styled-table .actions .remove\",\r\n    trigger_toggle\r\n  );\r\n  $(module_block)\r\n    .find(\".notice-option\")\r\n    .on(\"change\", \"input,textarea,select\", trigger_toggle);\r\n  $(\"form#post\").on(\"submit\", save_on_coupon_publish);\r\n\r\n  $(module_block)\r\n    .find(\"select#bogo-condition-type,select#bogo-deals-type\")\r\n    .trigger(\"acfw_load\");\r\n\r\n  $(\"#woocommerce-coupon-data\").on(\r\n    \"change acfw_load\",\r\n    \"select#discount_type\",\r\n    toggleBogoInterface\r\n  );\r\n\r\n  $(\"#woocommerce-coupon-data select#discount_type\").trigger(\"acfw_load\");\r\n}\r\n\r\nfunction toggleBogoInterface() {\r\n  const $discountType = $(this);\r\n  const $general = $discountType.closest(\"#general_coupon_data\");\r\n  const $inputs = $general.find(\"p.form-field input\");\r\n\r\n  if (\"acfw_bogo\" === $discountType.val()) {\r\n    $general.addClass(\"acfw-bogo-type\");\r\n    $(\"#acfw_bogo_deals\").show();\r\n\r\n    // disable fields under general tab that cannot be used in conjunction with BOGO\r\n    for (let x = 0; x <= $inputs.length; x++) {\r\n      if (\r\n        ![\r\n          \"expiry_date\",\r\n          \"_acfw_coupon_sort_priority\",\r\n          \"coupon_amount\", // we don't disable the coupon_amount field as it will trigger a PHP notice log in WC\r\n        ].includes($($inputs[x]).prop(\"name\"))\r\n      ) {\r\n        $($inputs[x]).prop(\"disabled\", true);\r\n      }\r\n    }\r\n  } else {\r\n    $general.removeClass(\"acfw-bogo-type\");\r\n    $(\"#acfw_bogo_deals\").hide();\r\n\r\n    // reenable fields under general tab when discount type is not BOGO anymore\r\n    for (let x = 0; x <= $inputs.length; x++) {\r\n      if (\r\n        ![\r\n          \"expiry_date\",\r\n          \"_acfw_coupon_sort_priority\",\r\n          \"coupon_amount\",\r\n        ].includes($($inputs[x]).prop(\"name\"))\r\n      ) {\r\n        $($inputs[x]).prop(\"disabled\", false);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Trigger toggle editing mode.\r\n *\r\n * @since 1.0.0\r\n */\r\nfunction trigger_toggle(): void {\r\n  toggle_editing_mode(true);\r\n}\r\n\r\n/**\r\n * Restrict condition quantity value.\r\n *\r\n * @since 1.0.0\r\n */\r\nfunction restrict_quantity_value() {\r\n  const $field: JQuery = jQuery(this);\r\n\r\n  if ($field.val() < 1) $field.val(1);\r\n}\r\n","declare var jQuery: any;\r\nvar $: any = jQuery;\r\n\r\n/**\r\n * Toggle field events script.\r\n * Used by Roles Restriction and other similar modules.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport default function toggle_fields_events() {\r\n  const $module_block: JQuery = $(\".toggle-enable-fields\");\r\n\r\n  $module_block.on(\r\n    \"change\",\r\n    \".toggle-trigger-field\",\r\n    toggle_disable_enable_fields\r\n  );\r\n  $module_block.find(\".toggle-trigger-field\").trigger(\"change\");\r\n}\r\n\r\n/**\r\n * Toggle disable/enable fields.\r\n *\r\n * @since 1.0.0\r\n */\r\nfunction toggle_disable_enable_fields() {\r\n  const $button: JQuery = $(this),\r\n    $module_block: JQuery = $button.closest(\".toggle-enable-fields\"),\r\n    $fields: JQuery = $module_block.find(\r\n      \"select,textarea,input:not(.toggle-trigger-field)\"\r\n    ),\r\n    toggle: boolean = !$button.prop(\"checked\");\r\n\r\n  $fields.prop(\"disabled\", toggle);\r\n\r\n  if (toggle) $fields.closest(\".form-field\").addClass(\"disabled\");\r\n  else $fields.closest(\".form-field\").removeClass(\"disabled\");\r\n}\r\n","declare var jQuery: any;\r\ndeclare var ClipboardJS: any;\r\ndeclare var acfw_edit_coupon: any;\r\nvar $: any = jQuery;\r\n\r\n/**\r\n * URL Coupon events.\r\n *\r\n * @since 4.3.1\r\n */\r\nexport default function url_coupon_events() {\r\n  const moduleBlock = document.querySelector(\"#acfw_url_coupon\");\r\n\r\n  $(moduleBlock).on(\"click\", \".copy-coupon-url\", showCopiedText);\r\n\r\n  initCouponUrlClipboard();\r\n}\r\n\r\n/**\r\n * Initialize coupon URL field copy to clipboard button.\r\n *\r\n * @since 4.3.1\r\n */\r\nfunction initCouponUrlClipboard() {\r\n  const $couponUrl = $(\"input#_acfw_coupon_url\");\r\n\r\n  $couponUrl.after(\r\n    `<button type=\"button\" class=\"copy-coupon-url\" data-clipboard-target=\"#_acfw_coupon_url\">\r\n    <svg width=\"15\" height=\"15\" version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 460 460\" style=\"enable-background:new 0 0 460 460;\" xml:space=\"preserve\">\r\n      <g>\r\n        <path d=\"M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272\r\n          c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729\r\n          c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z\"/>\r\n        <path d=\"M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272\r\n          c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068\r\n          c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001\r\n          C291.206,428.715,289.92,430,288.341,430z\"/>\r\n      </g>\r\n    </svg>\r\n    </button>`\r\n  );\r\n\r\n  new ClipboardJS(\".copy-coupon-url\");\r\n}\r\n\r\n/**\r\n * Display a \"Copied\" text after clicking the copy button.\r\n *\r\n * @since 4.3.1\r\n */\r\nfunction showCopiedText() {\r\n  const $button = $(this);\r\n\r\n  $button.after(\r\n    `<span class=\"coupon-url-copied\">${acfw_edit_coupon.copied_label}</span>`\r\n  );\r\n\r\n  setTimeout(() => {\r\n    $(\"span.coupon-url-copied\").fadeOut(500);\r\n  }, 1000);\r\n}\r\n","declare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\ndeclare var vex: any;\r\n\r\nconst $: any = jQuery;\r\nlet exludeCouponShown = false;\r\n\r\n/**\r\n * Add upsell events script.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport default function upsell_events() {\r\n  $(\"#usage_limit_coupon_data\").on(\r\n    \"change\",\r\n    \"#reset_usage_limit_period\",\r\n    upsell_advance_usage_limits\r\n  );\r\n  $(\r\n    \"#usage_restriction_coupon_data .acfw_exclude_coupons_field,#usage_restriction_coupon_data .acfw_allowed_customers_field\"\r\n  ).on(\r\n    \"click change focus\",\r\n    \"input,select\",\r\n    upsell_exclude_coupons_restriction\r\n  );\r\n  $(\"#acfw-auto-apply-coupon\").on(\r\n    \"change\",\r\n    \"#acfw_auto_apply_coupon_field\",\r\n    upsell_auto_apply\r\n  );\r\n  $(\"#acfw-virtual-coupon\").on(\r\n    \"change\",\r\n    \"#acfw_enable_virtual_coupons\",\r\n    upsell_virtual_coupons\r\n  );\r\n  $(\"#acfw_cart_conditions\").on(\r\n    \"change\",\r\n    \".condition-types\",\r\n    cart_condition_select_notice\r\n  );\r\n  $(\"#woocommerce-coupon-data\").on(\r\n    \"change acfw_load\",\r\n    \"#discount_type\",\r\n    hideGeneralUpsellOnBogo\r\n  );\r\n\r\n  $(\"#acfw_bogo_deals\").on(\r\n    \"change acfw_load\",\r\n    \"select#bogo-deals-type\",\r\n    toggle_bogo_auto_add_products_field\r\n  );\r\n\r\n  $(\"#acfw_bogo_deals\").on(\r\n    \"change\",\r\n    \"input[name='acfw_bogo_auto_add_products']\",\r\n    upsell_bogo_auto_add_get_products\r\n  );\r\n\r\n  $(\"#woocommerce-coupon-data #discount_type\").trigger(\"acfw_load\");\r\n\r\n  initExcludeCouponField();\r\n}\r\n\r\nfunction initExcludeCouponField() {\r\n  const $excludeField = $(\"p.acfw_exclude_coupons_field\");\r\n\r\n  $excludeField.insertAfter(\"p.form-field.individual_use_field\");\r\n}\r\n\r\n/**\r\n * Usage limits upsell vex dialog.\r\n *\r\n * @since 1.1\r\n */\r\nfunction upsell_advance_usage_limits() {\r\n  const { usage_limits } = acfw_edit_coupon.upsell;\r\n\r\n  vex.dialog.alert({\r\n    unsafeMessage: `<div class=\"upsell-alert usage-limits\">${usage_limits}</div>`,\r\n  });\r\n  $(this).val(\"none\");\r\n}\r\n\r\n/**\r\n * Usage restriction for exclude coupons upsell vex dialog.\r\n *\r\n * @since 1.1\r\n */\r\nfunction upsell_exclude_coupons_restriction() {\r\n  // prevent duplicate dialogs showing up.\r\n  if (exludeCouponShown) return;\r\n  exludeCouponShown = true;\r\n\r\n  const { usage_restriction } = acfw_edit_coupon.upsell;\r\n\r\n  vex.dialog.alert({\r\n    unsafeMessage: `<div class=\"upsell-alert exclude-coupon\">${usage_restriction}</div>`,\r\n    afterClose: () => (exludeCouponShown = false),\r\n  });\r\n  $(this).val(\"\");\r\n  $(this).blur();\r\n}\r\n\r\n/**\r\n * Auto apply upsell vex dialog.\r\n *\r\n * @since 1.1\r\n */\r\nfunction upsell_auto_apply() {\r\n  const { auto_apply } = acfw_edit_coupon.upsell;\r\n\r\n  vex.dialog.alert({\r\n    unsafeMessage: `<div class=\"upsell-alert auto-apply\">${auto_apply}</div>`,\r\n  });\r\n  $(this).prop(\"checked\", false);\r\n}\r\n\r\n/**\r\n * Virtual coupons upsell vex dialog.\r\n *\r\n * @since 4.3\r\n */\r\nfunction upsell_virtual_coupons() {\r\n  const { virtual_coupons } = acfw_edit_coupon.upsell;\r\n\r\n  vex.dialog.alert({\r\n    unsafeMessage: `<div class=\"upsell-alert auto-apply\">${virtual_coupons}</div>`,\r\n  });\r\n  $(this).prop(\"checked\", false);\r\n}\r\n\r\n/**\r\n * Display did you know notice below cart condition selector when premium option is selected.\r\n *\r\n * @since 1.6\r\n */\r\nfunction cart_condition_select_notice() {\r\n  const $select = $(this);\r\n  const $moduleBlock = $select.closest(\"#acfw_cart_conditions\");\r\n  const $formBlock = $select.closest(\".add-condition-form\");\r\n  const premiumConditions: string[] = $moduleBlock.data(\"premium-conditions\");\r\n  const $noticeHolder = $moduleBlock.find(\".acfw-dyk-notice-holder\");\r\n\r\n  let $noticeBlock = $formBlock.find(\".acfw-dyk-notice\");\r\n\r\n  if (!$noticeBlock.length) {\r\n    $formBlock.append($noticeHolder.html());\r\n    $noticeBlock = $formBlock.find(\".acfw-dyk-notice\");\r\n  }\r\n\r\n  if ($.inArray($select.val(), premiumConditions) >= 0) {\r\n    $noticeBlock.show();\r\n  } else {\r\n    $noticeBlock.hide();\r\n  }\r\n}\r\n\r\n/**\r\n * Hide did you know notice upsell under general tab when BOGO discount type is selected.\r\n *\r\n * @since 3.0\r\n */\r\nfunction hideGeneralUpsellOnBogo() {\r\n  const type = $(this).val();\r\n\r\n  if (\"acfw_bogo\" === type) {\r\n    $(\"p.acfw-dyk-notice-general\").hide();\r\n  } else {\r\n    $(\"p.acfw-dyk-notice-general\").show();\r\n  }\r\n}\r\n\r\n/**\r\n * Toggle BOGO auto add products field.\r\n *\r\n * @since 4.1\r\n */\r\nfunction toggle_bogo_auto_add_products_field() {\r\n  const $this = $(this);\r\n  const $module = $this.closest(\"#acfw_bogo_deals\");\r\n  const $field = $module.find(\".bogo-auto-add-products-field\");\r\n  const $input = $field.find(\"input[type='checkbox']\");\r\n  const applyType = $this.val();\r\n\r\n  if (applyType === \"specific-products\") {\r\n    $input.prop(\"disabled\", false);\r\n    $field.addClass(\"show\");\r\n  } else {\r\n    $input.prop(\"disabled\", false);\r\n    $field.removeClass(\"show\");\r\n  }\r\n}\r\n\r\n/**\r\n * Upsell BOGO auto add get products feature.\r\n *\r\n * @since 4.1\r\n */\r\nfunction upsell_bogo_auto_add_get_products() {\r\n  const $this = $(this);\r\n\r\n  $this.prop(\"checked\", false);\r\n\r\n  const { bogo_auto_add_get_products } = acfw_edit_coupon.upsell;\r\n\r\n  vex.dialog.alert({\r\n    unsafeMessage: `<div class=\"upsell-alert usage-limits\">${bogo_auto_add_get_products}</div>`,\r\n  });\r\n  $(this).val(\"none\");\r\n}\r\n","import searchWidgetTemplate, { ISearchArgs } from \"./search_widget_template\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\n\r\nexport interface ILinksListArguments {\r\n  title: string;\r\n  className: string;\r\n  links: ILink[];\r\n  search?: ISearchArgs;\r\n}\r\n\r\nexport interface ILink {\r\n  title: string;\r\n  url: string;\r\n  freeOnly?: boolean;\r\n  premiumUrl?: string;\r\n}\r\n\r\n/**\r\n * Links list template markup.\r\n *\r\n * @since 1.5\r\n *\r\n * @param {ILinksListArguments} args\r\n */\r\nexport default function linksListTemplate(args: ILinksListArguments) {\r\n  const { title, className } = args;\r\n  let { links } = args;\r\n  const { is_premium } = acfw_edit_coupon.help_modal;\r\n\r\n  if (is_premium) {\r\n    links = links.filter(\r\n      (l: ILink) => l?.freeOnly === undefined || !l?.freeOnly\r\n    );\r\n  }\r\n\r\n  return `\r\n    <div class=\"links-list ${className}\">\r\n      <h3>${title}</h3>\r\n\r\n      ${args?.search ? searchWidgetTemplate(args?.search) : \"\"}\r\n\r\n      <ul>\r\n        ${links.map((link) => `<li>${generateLink(link)}</li>`).join(\"\")}\r\n      </ul>\r\n    </div>\r\n  `;\r\n}\r\n\r\n/**\r\n * Generate link <a> markup.\r\n *\r\n * @since 1.5\r\n *\r\n * @param {ILink} link\r\n */\r\nfunction generateLink(link: ILink) {\r\n  const { title, url } = link;\r\n  const { is_premium } = acfw_edit_coupon.help_modal;\r\n\r\n  return `<a href=\"${\r\n    is_premium && link?.premiumUrl ? link?.premiumUrl : url\r\n  }\">${title}</a>`;\r\n}\r\n","declare var acfw_edit_coupon: any;\r\n\r\nexport interface ISearchArgs {\r\n  slug: string;\r\n  action: string;\r\n  placeholder: string;\r\n}\r\n\r\nexport interface ISearchResult {\r\n  url: string;\r\n  title: String;\r\n}\r\n\r\n/**\r\n * Search widget template.\r\n *\r\n * @param {ISearchArgs} search\r\n * @returns\r\n */\r\nexport default function searchWidgetTemplate(search: ISearchArgs) {\r\n  const { slug, action, placeholder } = search;\r\n\r\n  return `\r\n    <div class=\"search-widget search-${slug}\">\r\n      <input class=\"search-input\" type=\"text\" placeholder=\"${placeholder}\" data-action=\"${action}\" />\r\n      <button type=\"button\" class=\"clear-search dashicons-before dashicons-no-alt\"></button>\r\n      <div class=\"search-results\"></div>\r\n    </div>\r\n  `;\r\n}\r\n\r\n/**\r\n * Search results template.\r\n *\r\n * @param {ISearchResult[]} results\r\n * @param {string} term\r\n * @returns\r\n */\r\nexport function searchResultsTemplate(results: ISearchResult[], term: string) {\r\n  const list: string = results\r\n    .map(\r\n      ({ url, title }) =>\r\n        `<li><a href=\"${generateUrl(\r\n          url,\r\n          term\r\n        )}\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">${title}</a></li>`\r\n    )\r\n    .join(\"\");\r\n\r\n  return `<ul>${list}</ul>`;\r\n}\r\n\r\n/**\r\n * Add UTM parameters to KB article URL.\r\n *\r\n * @param {string} url\r\n * @param {string} term\r\n * @returns\r\n */\r\nfunction generateUrl(url: string, term: string) {\r\n  return `${url}?utm_source=acfwf&utm_medium=help_modal&utm_campaign=kb_search&utm_term=${term}`;\r\n}\r\n","import linksListTemplate, { ILink } from \"./links_list_template\";\r\nimport { ISearchArgs } from \"./search_widget_template\";\r\n\r\ndeclare var acfw_edit_coupon: any;\r\n\r\ninterface IHelpMainContent {\r\n  title: string;\r\n  content: string;\r\n  videos: ILink[];\r\n}\r\n\r\ninterface IHelpAsideContent {\r\n  links: ILink[];\r\n  kbs: ILink[];\r\n  tutorials: ILink[];\r\n}\r\n\r\nexport interface IHelpModalArguments {\r\n  target: string;\r\n  left: IHelpMainContent;\r\n  right: IHelpAsideContent;\r\n}\r\n\r\n/**\r\n * Help modal template markup.\r\n *\r\n * @since 1.5\r\n *\r\n * @param {IHelpModalArguments} args\r\n */\r\nexport default function modalTemplate(args: IHelpModalArguments) {\r\n  const { labels, images_url, is_premium } = acfw_edit_coupon.help_modal;\r\n  const {\r\n    target,\r\n    left: { title, content, videos },\r\n    right: { links, kbs, tutorials },\r\n  } = args;\r\n  const kbSearchArgs: ISearchArgs = {\r\n    slug: \"kb-articles\",\r\n    action: \"acfw_search_help_kb_articles\",\r\n    placeholder: labels.search_placeholder,\r\n  };\r\n  const source = is_premium ? \"acfwp\" : \"acfwf\";\r\n  const upgradeLink = `https://advancedcouponsplugin.com/pricing/?utm_source=acfwf&utm_medium=help_modal&utm_campaign=help_modal_${target}_upgrade_link`;\r\n  const logoUrl = `https://advancedcouponsplugin.com/?utm_source=${source}&utm_medium=help_modal&utm_campaign=help_brand_link_${target}`;\r\n\r\n  return `\r\n    <div class=\"header\">\r\n      <div class=\"logo\">\r\n        <a href=\"${logoUrl}\" target=\"_blank\"><img src=\"${images_url}acfw-logo.png\" alt=\"Advanced Coupons logo\" /></a>\r\n      </div>\r\n      ${\r\n        !is_premium\r\n          ? `\r\n        <div class=\"upgrade-link\">\r\n          <a href=\"${upgradeLink}\" target=\"_blank\">\r\n            <span>${labels.upgrade_to_premium}</span>\r\n            <i class=\"dashicons dashicons-external\"></i>\r\n          </a>\r\n        </div>\r\n      `\r\n          : \"\"\r\n      }\r\n    </div>\r\n    <main>\r\n      <h1 class=\"title\">${title}</h1>\r\n      <div class=\"content\">\r\n        ${content}\r\n      </div>\r\n      ${\r\n        videos.length\r\n          ? `<div class=\"video-gallery-placeholder\"><img src=\"${images_url}spinner-2x.gif\" alt=\"Loading videos\" /><p>${labels.loading_videos}</p></div>`\r\n          : \"\"\r\n      }\r\n    </main>\r\n    <aside>\r\n      ${linksListTemplate({\r\n        title: labels.rel_links,\r\n        className: \"relevant-links\",\r\n        links: links,\r\n      })}\r\n      ${linksListTemplate({\r\n        title: labels.kb_articles,\r\n        className: \"knowledge-base-articles\",\r\n        links: kbs,\r\n        search: kbSearchArgs,\r\n      })}\r\n      ${linksListTemplate({\r\n        title: labels.tut_guides,\r\n        className: \"tutorials-guides\",\r\n        links: tutorials,\r\n      })}\r\n    </aside>\r\n  `;\r\n}\r\n","declare var acfw_edit_coupon: any;\r\n\r\nexport default function permissionRequestTemplate(module: string) {\r\n  const { images_url } = acfw_edit_coupon.help_modal;\r\n  const {\r\n    permission_request,\r\n    allow,\r\n    cancel,\r\n  } = acfw_edit_coupon.help_modal.labels;\r\n  return `\r\n  <div id=\"acfw-help-modal-permission-request\" data-module=\"${module}\">\r\n    <img src=\"${images_url}acfw-logo.png\" />\r\n    <p>${permission_request}</p>\r\n    <p class=\"actions\">\r\n      <button class=\"button-primary allow\" type=\"button\">${allow}</button>\r\n      <button class=\"button cancel\" type=\"button\">${cancel}</button>\r\n    </p>\r\n  </div>\r\n  `;\r\n}\r\n","declare var acfw_edit_coupon: any;\r\n\r\nexport default function placeholderTemplate() {\r\n  const { images_url, labels } = acfw_edit_coupon.help_modal;\r\n\r\n  return `<div id=\"acfw-help-modal-placeholder\">\r\n    <img src=\"${images_url}spinner-2x.gif\" />\r\n    <p>${labels.loading_content}</p>\r\n  </div>`;\r\n}\r\n","declare var acfw_edit_coupon: any;\r\n\r\nexport interface IVideoEmbed {\r\n  url: string;\r\n  videoid: string;\r\n  embed: string;\r\n  thumbnail: string;\r\n  title?: string;\r\n}\r\n\r\n/**\r\n * Video gallery template.\r\n *\r\n * @param {IVideoEmbed[]} videoEmbeds\r\n * @returns\r\n */\r\nexport default function videoGalleryTemplate(videoEmbeds: IVideoEmbed[]) {\r\n  return `\r\n  <div class=\"acfw-help-video-gallery\">\r\n    <div class=\"videos\">\r\n      ${\r\n        videoEmbeds[0].embed\r\n          ? videoEmbeds[0].embed\r\n          : noVideoTemplate(videoEmbeds[0])\r\n      }\r\n    </div>\r\n    ${\r\n      videoEmbeds.length > 1\r\n        ? `\r\n      <ul class=\"thumbnails\">\r\n        ${videoEmbeds\r\n          .map(\r\n            (ve, i) => `\r\n            <li ${i === 0 ? `class=\"active\"` : \"\"}>\r\n              <a href=\"javascript:void(0);\" data-videoid=\"${ve.videoid}\">\r\n                <img src=\"${ve.thumbnail}\" title=\"${ve.title}\" />\r\n              </a>\r\n              <span class=\"title\">${ve.title}</span>\r\n            </li>\r\n            `\r\n          )\r\n          .join(\"\")}\r\n      </ul>\r\n      `\r\n        : \"\"\r\n    }\r\n    \r\n  </div>\r\n  `;\r\n}\r\n\r\nexport function noVideoTemplate(videoEmbed: IVideoEmbed) {\r\n  return `\r\n  <div class=\"no-video\" style=\"background-image:url(${videoEmbed.thumbnail});\">\r\n    <a href=\"${videoEmbed.url}\" rel=\"noreferer noopener\" >\r\n      <span>${acfw_edit_coupon.help_modal.labels.no_video}</span>\r\n    </a>\r\n  </div>\r\n  `;\r\n}\r\n","import videoGalleryTemplate, {\r\n  noVideoTemplate,\r\n  IVideoEmbed,\r\n} from \"./templates/video_gallery_template\";\r\n\r\ndeclare var ajaxurl: string;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\nconst $ = jQuery;\r\nlet videoEmbedsState: IVideoEmbed[] = [];\r\nlet videoModuleState: string = \"\";\r\n\r\nexport interface IHelpVideo {\r\n  title: string;\r\n  url: string;\r\n  embed?: string;\r\n}\r\n\r\n/**\r\n * Fetch Videos oembed markups via AJAX and update video gallery content.\r\n *\r\n * @since 1.5\r\n *\r\n * @param {IHelpVideo[]} videos\r\n * @returns\r\n */\r\nexport default function loadVideosOembed(videos: IHelpVideo[], module: string) {\r\n  const { _secure_nonce } = acfw_edit_coupon.help_modal;\r\n\r\n  // skip if there are no videos to load.\r\n  if (!videos.length) return;\r\n\r\n  $.post(\r\n    ajaxurl,\r\n    {\r\n      action: \"acfw_get_help_videos_oembed\",\r\n      urls: videos.map((v) => v.url),\r\n      width: $(\".acfw-help-vex .vex-content main\").width(),\r\n      _nonce: _secure_nonce,\r\n    },\r\n    (videoEmbeds: IVideoEmbed[]) => {\r\n      // map video title to embeds data.\r\n      videoEmbeds = videoEmbeds.map((ve) => {\r\n        const index = videos.findIndex((v) => v.url === ve.url);\r\n        ve.title = index >= 0 ? videos[index].title : \"\";\r\n        return ve;\r\n      });\r\n\r\n      // update state variable for video embeds.\r\n      videoEmbedsState = videoEmbeds;\r\n      videoModuleState = module;\r\n\r\n      updateVideoGalleryContent(videoEmbeds);\r\n    },\r\n    \"json\"\r\n  );\r\n}\r\n\r\n/**\r\n * Load video gallery content from cached data if present.\r\n *\r\n * @since 1.5\r\n *\r\n * @param {IHelpVideo[]} videos\r\n * @returns\r\n */\r\nexport function loadVideoGalleryContentCache(\r\n  videos: IHelpVideo[],\r\n  module: string\r\n) {\r\n  if (!videoEmbedsState.length || module !== videoModuleState) {\r\n    loadVideosOembed(videos, module);\r\n    return;\r\n  }\r\n\r\n  updateVideoGalleryContent(videoEmbedsState);\r\n}\r\n\r\n/**\r\n * Update video gallery content markup.\r\n *\r\n * @since 1.5\r\n *\r\n * @param {IVideoEmbed[]} videoEmbeds\r\n */\r\nfunction updateVideoGalleryContent(videoEmbeds: IVideoEmbed[]) {\r\n  const $placeholder = $(\".acfw-help-vex .video-gallery-placeholder\");\r\n\r\n  // replace placeholder with video gallery markup.\r\n  if ($placeholder.length) {\r\n    $placeholder.replaceWith(videoGalleryTemplate(videoEmbeds));\r\n  }\r\n}\r\n\r\n/**\r\n * Switch active video displayed when thumbnail is clicked and autoplay video.\r\n *\r\n * @since 1.5\r\n */\r\nexport function switchActiveVideo() {\r\n  const $this = jQuery(this);\r\n  const $li = $this.closest(\"li\");\r\n  const $wrap = $this.closest(\".acfw-help-video-gallery\");\r\n  const $video = $wrap.find(\".videos\");\r\n  const $thumbs = $wrap.find(\"ul.thumbnails li\");\r\n  const videoId = $this.data(\"videoid\");\r\n\r\n  // skip if thumbnail is for current active video.\r\n  if ($li.hasClass(\"active\")) {\r\n    return;\r\n  }\r\n\r\n  // switch active class to clicked thumbnail.\r\n  $thumbs.removeClass(\"active\");\r\n  $li.addClass(\"active\");\r\n\r\n  // search index of video ombed markup of matching video ID.\r\n  const index = videoEmbedsState.findIndex((ve) => ve.videoid === videoId);\r\n\r\n  // replace main video oembed markup.\r\n  if (index >= 0) {\r\n    $video.html(\r\n      videoEmbedsState[index].embed\r\n        ? videoEmbedsState[index].embed.replace(\"oembed\", \"oembed&autoplay=1\")\r\n        : noVideoTemplate(videoEmbedsState[index])\r\n    );\r\n  }\r\n}\r\n","import modalTemplate, { IHelpModalArguments } from \"./templates/modal_template\";\r\nimport errorTemplate from \"./templates/error_template\";\r\nimport permissionRequestTemplate from \"./templates/permission_template\";\r\nimport placeholderTemplate from \"./templates/placeholder_template\";\r\nimport loadVideosOembed, { loadVideoGalleryContentCache } from \"./videos\";\r\n\r\ndeclare var ajaxurl: string;\r\ndeclare var jQuery: any;\r\ndeclare var vex: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\nconst $ = jQuery;\r\nconst dataCache: IHelpModalArguments[] = []; // state variable that holds cached data.\r\n\r\n/**\r\n * Show the help modal content.\r\n *\r\n * @since 1.5\r\n */\r\nexport function showHelpModal() {\r\n  const { allow_fetch } = acfw_edit_coupon.help_modal;\r\n  const $this = $(this);\r\n  const module = $this.closest(\".acfw-help-link\").data(\"module\");\r\n\r\n  // display vex dialog with placeholder div and spinner.\r\n  vex.dialog.open({\r\n    unsafeMessage: `\r\n      <a class=\"vex-close\" href=\"javascript:void(0);\"></a>\r\n      ${allow_fetch ? placeholderTemplate() : permissionRequestTemplate(module)}\r\n    `,\r\n    className: \"vex-theme-plain acfw-help-vex\",\r\n    showCloseButton: false,\r\n    buttons: {},\r\n  });\r\n\r\n  // fetch data and update modal content.\r\n  if (allow_fetch) fetchContentDataUpdateModal(module);\r\n}\r\n\r\n/**\r\n * Replace content in vex modal.\r\n * make sure placeholder still exists before replacing it with relative content.\r\n *\r\n * @param {string} markupTemplate\r\n */\r\nfunction replaceModalContent(markupTemplate: string) {\r\n  const $placeholder = $(\"#acfw-help-modal-placeholder\");\r\n  if ($placeholder.length) {\r\n    $placeholder.replaceWith(markupTemplate);\r\n    $(\".acfw-help-vex\")\r\n      .find(\"main a,aside a\")\r\n      .attr(\"target\", \"_blank\")\r\n      .attr(\"rel\", \"noopener noreferrer nofollow\");\r\n  }\r\n}\r\n\r\n/**\r\n * Fetch content data from JSON url and update modal content.\r\n *\r\n * @since 1.5\r\n *\r\n * @param {string} module\r\n */\r\nexport function fetchContentDataUpdateModal(module: string) {\r\n  const { _secure_nonce } = acfw_edit_coupon.help_modal;\r\n  let cachedData: IHelpModalArguments | null = null;\r\n\r\n  // serve cached data and videos embeds for module if already present.\r\n  if ((cachedData = getCachedData(module))) {\r\n    replaceModalContent(modalTemplate(cachedData));\r\n    loadVideoGalleryContentCache(cachedData.left.videos, module);\r\n    return;\r\n  }\r\n\r\n  $.post(\r\n    ajaxurl,\r\n    {\r\n      action: \"acfw_fetch_help_data\",\r\n      module: module,\r\n      _nonce: _secure_nonce,\r\n    },\r\n    (data: IHelpModalArguments) => {\r\n      dataCache.push(data);\r\n      replaceModalContent(modalTemplate(data));\r\n      loadVideosOembed(data.left.videos, module);\r\n    },\r\n    \"json\"\r\n  ).fail((data: any) => {\r\n    replaceModalContent(errorTemplate(data.responseJSON));\r\n  });\r\n}\r\n\r\n/**\r\n * Get cached data for module.\r\n *\r\n * @since 1.5\r\n *\r\n * @param {string} module\r\n */\r\nfunction getCachedData(module: string) {\r\n  const index = dataCache.findIndex(\r\n    (data: IHelpModalArguments) => data.target === module\r\n  );\r\n\r\n  return index >= 0 ? dataCache[index] : null;\r\n}\r\n","interface IErrorTemplateArguments {\r\n  errorMsg: string;\r\n}\r\n\r\nexport default function errorTemplate(response: IErrorTemplateArguments) {\r\n  const { errorMsg } = response;\r\n  return `\r\n    <div class=\"acfw-help-modal-error\">\r\n      <p>${errorMsg}</p>\r\n    </div>\r\n  `;\r\n}\r\n","import {\r\n  searchResultsTemplate,\r\n  ISearchResult,\r\n  ISearchArgs,\r\n} from \"./templates/search_widget_template\";\r\n\r\ndeclare var ajaxurl: string;\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\ninterface ISearchQueryArgs {\r\n  action: string;\r\n  term: string;\r\n  _nonce: string;\r\n}\r\n\r\ninterface ISearchResultsCache {\r\n  term: string;\r\n  results: ISearchResult[];\r\n}\r\n\r\nconst $ = jQuery;\r\nlet searchTimeoutState: any = null;\r\nlet searchResultsCache: ISearchResultsCache | null = null;\r\n\r\n/**\r\n * Trigger search event when on keyboard input.\r\n *\r\n * @since 1.5\r\n */\r\nexport function triggerSearchEvent() {\r\n  const $button = $(this);\r\n  const $wrap = $button.closest(\".search-widget\");\r\n  const $input = $wrap.find(\"input.search-input\");\r\n  const $results = $wrap.find(\".search-results\");\r\n  const { labels, images_url, _secure_nonce } = acfw_edit_coupon.help_modal;\r\n  const term = $input.val();\r\n\r\n  // if search input is emptied, clear state and remove results.\r\n  if (!term) {\r\n    clearTimeout(searchTimeoutState);\r\n    searchTimeoutState = null;\r\n    $results.height(0).html(\"\");\r\n    $wrap.removeClass(\"show-clear\");\r\n    return;\r\n  }\r\n\r\n  $wrap.addClass(\"show-clear\");\r\n\r\n  // run search query.\r\n  doSearchQuery(\r\n    {\r\n      action: $input.data(\"action\"),\r\n      term: $input.val(),\r\n      _nonce: _secure_nonce,\r\n    },\r\n\r\n    // callback to run before running ajax.\r\n    () => {\r\n      $results\r\n        .height(35)\r\n        .html(\r\n          `<div class=\"loading\"><img src=\"${images_url}spinner.gif\" /></div>`\r\n        );\r\n    },\r\n\r\n    // callback to run to process results.\r\n    (data: ISearchResult[]) => {\r\n      if (!$wrap.hasClass(\"show-clear\")) {\r\n        return;\r\n      }\r\n\r\n      if (data.length) {\r\n        searchResultsCache = { term, results: data };\r\n        $results.html(searchResultsTemplate(data, term));\r\n      } else {\r\n        $results.html(\r\n          `<div class=\"no-result\">${labels.search_no_results}</div>`\r\n        );\r\n      }\r\n\r\n      // adjust the height to match the content (css transform).\r\n      $results.height($results.find(\"ul,.no-result\").height() + 3);\r\n    }\r\n  );\r\n}\r\n\r\n/**\r\n * Function that handles the search query scheduling (delay 1 second after no more keyboard inputs).\r\n *\r\n * @since 1.5\r\n *\r\n * @param {ISearchArgs} args\r\n * @param {CallableFunction} beforeCB\r\n * @param {CallableFunction} successCB\r\n */\r\nfunction doSearchQuery(\r\n  args: ISearchQueryArgs,\r\n  beforeCB: CallableFunction,\r\n  successCB: CallableFunction\r\n) {\r\n  // clear saved timeout everytime search term value is changed.\r\n  if (searchTimeoutState) {\r\n    clearTimeout(searchTimeoutState);\r\n    searchTimeoutState = null;\r\n  }\r\n\r\n  // if search term is the same from previous, then serve cached results.\r\n  if (args.term === searchResultsCache?.term) {\r\n    successCB(searchResultsCache.results);\r\n    return;\r\n  }\r\n\r\n  // schedule AJAX query after 1 second.\r\n  searchTimeoutState = setTimeout(() => {\r\n    beforeCB();\r\n    $.post(ajaxurl, args, successCB, \"json\");\r\n  }, 1000);\r\n}\r\n\r\n/**\r\n * Clear the search text and hide results list.\r\n *\r\n * @since 1.5\r\n */\r\nexport function clearSearchEvent() {\r\n  const $button = $(this);\r\n  const $wrap = $button.closest(\".search-widget\");\r\n  const $input = $wrap.find(\"input.search-input\");\r\n  const $results = $wrap.find(\".search-results\");\r\n\r\n  clearTimeout(searchTimeoutState);\r\n  searchTimeoutState = null;\r\n  $input.val(\"\");\r\n  $results.height(0).html(\"\");\r\n  $wrap.removeClass(\"show-clear\");\r\n}\r\n","import { fetchContentDataUpdateModal } from \"./modal\";\r\nimport placeholderTemplate from \"./templates/placeholder_template\";\r\n\r\ndeclare var ajaxurl: any;\r\ndeclare var jQuery: any;\r\ndeclare var vex: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\nconst $ = jQuery;\r\n\r\nexport function allowFetchPermission() {\r\n  const { _secure_nonce } = acfw_edit_coupon.help_modal;\r\n  const $button = jQuery(this);\r\n  const $div = $button.closest(\"#acfw-help-modal-permission-request\");\r\n  const module = $div.data(\"module\");\r\n\r\n  $div.replaceWith(placeholderTemplate());\r\n\r\n  $.post(\r\n    ajaxurl,\r\n    {\r\n      action: \"acfw_save_fetch_help_permission\",\r\n      _nonce: _secure_nonce,\r\n    },\r\n    () => {\r\n      fetchContentDataUpdateModal(module);\r\n      acfw_edit_coupon.help_modal.allow_fetch = true;\r\n    },\r\n    \"json\"\r\n  );\r\n}\r\n\r\nexport function closePermisionModal() {\r\n  vex.closeAll();\r\n}\r\n","import { showHelpModal } from \"./modal\";\r\nimport { switchActiveVideo } from \"./videos\";\r\nimport { triggerSearchEvent, clearSearchEvent } from \"./search\";\r\nimport { allowFetchPermission, closePermisionModal } from \"./permission\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var vex: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\nconst $: any = jQuery;\r\n\r\n/**\r\n * Register events related to help modal.\r\n *\r\n * @since 1.5\r\n */\r\nexport default function helpLinkRegisterEvents() {\r\n  $(\"#post-body\").on(\"click\", \".acfw-help-modal-trigger\", showHelpModal);\r\n  $(\"body\").on(\"click\", \".acfw-help-vex .vex-close\", () => vex.closeAll());\r\n  $(\"body\").on(\r\n    \"click\",\r\n    \".acfw-help-vex .acfw-help-video-gallery ul.thumbnails li a\",\r\n    switchActiveVideo\r\n  );\r\n  $(\"body\").on(\r\n    \"keyup\",\r\n    \".acfw-help-vex .search-widget input.search-input\",\r\n    triggerSearchEvent\r\n  );\r\n\r\n  $(\"body\").on(\r\n    \"click\",\r\n    \".acfw-help-vex .search-widget button.clear-search\",\r\n    clearSearchEvent\r\n  );\r\n\r\n  $(\"body\").on(\r\n    \"click\",\r\n    \".acfw-help-vex #acfw-help-modal-permission-request button.allow\",\r\n    allowFetchPermission\r\n  );\r\n\r\n  $(\"body\").on(\r\n    \"click\",\r\n    \".acfw-help-vex #acfw-help-modal-permission-request button.cancel\",\r\n    closePermisionModal\r\n  );\r\n}\r\n\r\n/**\r\n * Generate help links in the tabs.\r\n *\r\n * @since 1.5\r\n */\r\nexport function generateHelpLinks() {\r\n  const helpLinkDivs: NodeList = document.querySelectorAll(\r\n    \"#post-body .acfw-help-link\"\r\n  );\r\n  const { help_text, images_url } = acfw_edit_coupon.help_modal;\r\n\r\n  helpLinkDivs.forEach((div: HTMLElement) => {\r\n    const markup = `\r\n      <a class=\"acfw-help-modal-trigger\" href=\"javascript:void(0);\">${help_text} \r\n        <img class=\"acfw-icon\" src=\"${images_url}help-icon.svg\" alt=\"${help_text}\" />\r\n      </a>\r\n    `;\r\n\r\n    $(div).html(markup);\r\n  });\r\n}\r\n","import cart_conditions_module_events from \"./cart_conditions/index\";\r\nimport bogo_deals_module_events from \"./bogo_deals/index\";\r\nimport toggle_fields_events from \"./toggle_fields\";\r\nimport url_coupon_events from \"./url_coupons\";\r\nimport upsell_events from \"./upsell\";\r\nimport helpLinkRegisterEvents, { generateHelpLinks } from \"./help_modal/index\";\r\n\r\nimport \"./assets/styles/index.scss\";\r\n\r\ndeclare var jQuery: any;\r\ndeclare var acfw_edit_coupon: any;\r\n\r\nconst { modules, upsell } = acfw_edit_coupon;\r\n\r\njQuery(document).ready(($: any) => {\r\n  if (modules.indexOf(\"acfw_cart_conditions_module\") > -1)\r\n    cart_conditions_module_events();\r\n\r\n  if (modules.indexOf(\"acfw_bogo_deals_module\") > -1)\r\n    bogo_deals_module_events();\r\n\r\n  if (modules.indexOf(\"acfw_url_coupons_module\") > -1) url_coupon_events();\r\n\r\n  if (upsell) upsell_events();\r\n\r\n  toggle_fields_events();\r\n\r\n  generateHelpLinks();\r\n  helpLinkRegisterEvents();\r\n  preSelectCouponTypeFromUrl();\r\n});\r\n\r\n/**\r\n * Pre select the coupon type when the parameter is available on the URL during new coupon creation.\r\n *\r\n * @since 4.3\r\n */\r\nfunction preSelectCouponTypeFromUrl() {\r\n  const queryString = new URLSearchParams(window.location.search);\r\n  const type = queryString.get(\"type\");\r\n\r\n  // only do this when creating a new coupon.\r\n  if (type && window.location.pathname.includes(\"post-new.php\")) {\r\n    jQuery(\"select#discount_type\").val(type).trigger(\"change\");\r\n  }\r\n}\r\n"],"names":["conditionFieldOptionsTemplate","cart_condition_fields","acfw_edit_coupon","fieldGroups","btnLabels","add_new_and_rule","conditionFields","Object","keys","map","key","f","fieldGroup","group","label","matchedFields","filter","c","undefined","length","title","join","conditionFieldGroupTemplate","add","cancel","$","jQuery","module_block","document","querySelector","toggle_add_condition_form","$button","this","$condition_actions","closest","hasClass","find","show","select2","hide","toggle_editing_mode","toggle","data","prop","popuplate_taxonomy_term_options","$taxonomy","$condition_block","$tax_terms","taxonomy","val","terms","taxonomy_data","t","slug","taxonomy_terms","remove","term","term_id","optionObj","Option","append","trigger","popuplate_shipping_region_options","$shipping_zone","$shipping_region","zone_id","regions","region_labels","region_options","code","toggle_overlay","overlay","type","display","css","esc_attr","text","replace","m","remove_leading_zeros","decimal_separator","$input","value","substring","get_allowed_minimum_value","condition","selected","value_1","value_2","selected_multiple","array","indexOf","condition_options","condition_field_options","exactly","anyexcept","morethan","lessthan","price_to_float","price","parseFloat","validateDiscount","condition_logic_template","logic_field_options","and","or","condition_group_template","fields_markup","empty_cart_conditions_field","cgroup_actions","empty_conditions_markup","add_condition_group","condition_groups","blur","removeClass","remove_condition_group","$condition_group","$cgroup_logic","index","next","prev","no_condition_group_msg","logic_template","product_category_template","categories","quantity","product_category","placeholder","field","quantityLabel","cart_quantity","condition_label","condOption","options","markup","x","category_options","customer_logged_in_status_template","customer_logged_in_status","get_options","customer_user_role_template","customer_user_role","user_role_options","disallowed_customer_user_role_template","disallowed_customer_user_role","upsell","add_condition_field","$condition_type","$condition_fields","premiumConditions","condition_type","fields_count","vex","dialog","alert","unsafeMessage","cart_condition_field","condition_field_markup","get_condition_field","fail_add_condition_field","remove_condition_field","$condition_field","$cfield_logic","desc","cart_quantity_template","cart_subtotal","cart_subtotal_template","field_key","template_callback","default_data_value","is_condition_field","cart_conditon_field_options","scrape_condition_group_data","condition_group","condition_fields","querySelectorAll","fields","classList","contains","forEach","condition_field","push","temp","temp2","temp3","dataset","field_data","parseInt","scraper_callback","scrape_condition_field_data","post_id","woocommerce_admin_meta_boxes","save_cart_conditions","post_status","form_data","objects","min","prevGroupType","Number","isInteger","validate_form_data","cart_conditions_invalid","addClass","notice_settings","message","btn_text","btn_url","auto_apply_display","is","test","cart_notice_url_invalid","ajax_save","cart_conditions","response","status","click","error_msg","save_on_coupon_publish","e","preventDefault","setTimeout","submit","callback","action","coupon_id","post","ajaxurl","product_table_buttons","bogo_form_fields","trigger_add_table_row_form","$table","$tbody","exclude","get_add_edit_form_row_markup","trigger_edit_table_row_form","$row","splice","product_id","replaceWith","add_edit_table_row","$search","$condition","$quantity","minimum","productId","toString","includes","product_exists_in_table","product_label","JSON","stringify","fill_form_propery_error_msg","cancel_add_edit_table_row","colspan","append_blank_placeholder_table_row","product_table_remove_product","no_products_added","prodOption","edit","type_to_search","btnText","restrict_number_min_value","attr","update_input_minimum_value","$select","$field","field_type","selector","update_has_ordered_before_condition_label","within_a_period_label","number_of_orders_label","$label","validate_price_field_value","input_price","minimum_price","condition_value_type_change","$type","$value","navigate_tabs","$tab","$module_block","tab","set_active_tab","init_cart_conditions","row","load_condition_group_fields","html","then","addLogic","field_markup","upsell_template","bogo_deals_type","combination_products_template","is_deals","products","discount_type","discount_value","bogo_instructions","productsLabel","priceDiscountLabel","priceType","priceCol","currency_symbol","discount_field_options","override","percent","fixed","get_price_column","priceTh","p","instructions","apply_default","multiple_items","trigger_default","category_first_column_template","category_id","category_label","placeholder_table_row_template","no_categories_added","product_first_column_template","any_products_template","isDeals","discountTypeLabel","anyproducts_apply","apply_template","anyproducts_trigger","trigger_quantity","trigger_template","toggle_block_data_type","block_type","condition_block","deals_block","bogo_deals","conditions","deals","block_data_type","conditions_type","deals_type","block_data","tempBlock","isDeal","isPremium","data_type","add_prod_cat_label","categoryLabel","tbody","product_cat","product_categories_template","add_product_label","productLabel","product","specific_products_template","$multipleDesc","save_bogo_deals","condition_rows","deal_rows","type_field","$notice_options","get_data","isTriggerError","isApplyError","bogo_deals_save_error_msg","discount_type_value_error_msg","button_text","button_url","notice_type","dataToSave","rows","clear_bogo_deals","confirm","_wpnonce","update_combined_products_list","$temp","current_data","$options","$discount_type","$discount_value","discount_val","isNaN","update_any_products_trigger_data","$block","update_any_products_apply_data","discountType","discountValue","add_edit_row_template","option","get_option","table_row_template","get_first_column_markup","object_id","object","get_table_row_data","$object_row","toggleBogoInterface","$discountType","$general","$inputs","trigger_toggle","restrict_quantity_value","bogo_toggle_editing_mode","toggle_disable_enable_fields","$fields","url_coupon_events","moduleBlock","on","showCopiedText","after","ClipboardJS","copied_label","fadeOut","exludeCouponShown","upsell_events","upsell_advance_usage_limits","upsell_exclude_coupons_restriction","upsell_auto_apply","upsell_virtual_coupons","cart_condition_select_notice","hideGeneralUpsellOnBogo","toggle_bogo_auto_add_products_field","upsell_bogo_auto_add_get_products","insertAfter","usage_limits","usage_restriction","afterClose","auto_apply","virtual_coupons","$moduleBlock","$formBlock","$noticeHolder","$noticeBlock","inArray","$this","bogo_auto_add_get_products","linksListTemplate","args","search","className","links","help_modal","l","freeOnly","link","url","is_premium","premiumUrl","generateLink","modalTemplate","labels","images_url","target","content","videos","kbs","tutorials","kbSearchArgs","search_placeholder","source","upgradeLink","logoUrl","upgrade_to_premium","loading_videos","rel_links","kb_articles","tut_guides","permissionRequestTemplate","module","permission_request","allow","placeholderTemplate","loading_content","noVideoTemplate","videoEmbed","thumbnail","no_video","videoEmbedsState","videoModuleState","loadVideosOembed","_secure_nonce","urls","v","width","_nonce","videoEmbeds","ve","findIndex","updateVideoGalleryContent","$placeholder","embed","i","videoid","videoGalleryTemplate","switchActiveVideo","$li","$wrap","$video","$thumbs","videoId","dataCache","showHelpModal","allow_fetch","open","showCloseButton","buttons","fetchContentDataUpdateModal","replaceModalContent","markupTemplate","cachedData","getCachedData","loadVideoGalleryContentCache","left","fail","errorMsg","responseJSON","searchTimeoutState","searchResultsCache","triggerSearchEvent","$results","clearTimeout","height","beforeCB","successCB","results","doSearchQuery","list","generateUrl","searchResultsTemplate","search_no_results","clearSearchEvent","allowFetchPermission","$div","closePermisionModal","closeAll","modules","ready","helpLinkDivs","help_text","each","div","URLSearchParams","window","location","get","pathname"],"sourceRoot":""}