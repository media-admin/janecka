(()=>{"use strict";function t(){var t=acfw_edit_coupon.cart_condition_fields,e=acfw_edit_coupon.cart_condition_field_groups,n=acfw_edit_coupon.product_table_buttons,o=acfw_edit_coupon.add_new_and_rule,i=Object.keys(t).map((function(e){return t[e]}));return'\n    <div class="condition-group-actions">\n      <div class="add-condition-form" style="display: none;">\n        <select class="condition-types" data-placeholder="Search/select condition fields">\n          <option value="">Search</option>\n          '+e.map((function(t){return function(t,e){var n=t.group,o=t.label,i=e.filter((function(t){return t.group===n||"others"===n&&void 0===t.group}));if(!i.length)return;return'\n    <optgroup label="'+o+'">\n      '+i.map((function(t){return'<option value="'+t.key+'">'+t.title+"</option>"})).join("")+"\n    </optgroup>\n  "}(t,i)})).join("")+'\n        </select>\n        <button type="button" class="add-condition-field button-primary">'+n.add+'</button>\n        <button type="button" class="cancel-add-condition-field button">'+n.cancel+'</button>\n      </div>\n      <button type="button" class="add-condition-trigger button">\n        <i class="dashicons dashicons-plus"></i>\n        '+o+"\n      </button>\n    </div>\n  "}var e=jQuery,n=document.querySelector("#acfw_cart_conditions");function o(){var t=e(this),n=t.closest("div.condition-group-actions");t.hasClass("add-condition-trigger")?(n.find(".add-condition-form").show(),jQuery("select.condition-types").select2(),t.hide()):(n.find(".add-condition-form").hide(),n.find(".add-condition-trigger").show())}function i(t){e(n).data("editing",t),e(n).find("#save-cart-conditions").prop("disabled",!t)}function a(){var t=e(this),o=t.closest(".condition-field"),i=o.find("select.condition-value"),a=t.val()+"",c=o.data("selected_terms"),d=e(n).data("custom_tax_options").filter((function(t){return t.slug==a})),l=d.length?d[0].terms:[];if(i.val(null).find("option").remove(),l.length){for(var s=0,r=l;s<r.length;s++){var u=r[s],p=u.name,f=u.term_id,_=new Option(p,f);i.append(_)}i.val(c).trigger("change")}}function c(){var t=e(this),o=t.closest(".condition-field"),i=o.find("select.condition-value"),a=t.val()+"";if(a){var c=o.data("regions"),d=e(n).data("shipping_regions"),l=o.data("zones")[a].regions;if(i.val(null).find("option").remove(),"object"==typeof l&&l.length){for(var s=0,r=l;s<r.length;s++){var u=r[s],p=new Option(d[u],u);i.append(p)}i.val(c).trigger("change")}}}function d(t,e){void 0===e&&(e=""),e||(e="show");var n="show"===e?"block":"none";jQuery(t).css("display",n)}function l(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039"};return t.replace(/[&<>"']/g,(function(t){return e[t]}))}function s(){var t=acfw_edit_coupon.decimal_separator,e=jQuery(this),n=e.val()+"";n=="0"+t&&e.val("0"),"0"!=n&&n.substring(0,2)!="0"+t&&(n=(n=n.replace(/^0+/,"")).substring(0,1)==t?"0"+n:n,e.val(n))}function r(t){return"<"==t?1:0}function u(t,e){return t==e?"selected":""}function p(t,e){return t.indexOf(e)>=0?"selected":""}function f(t){void 0===t&&(t="");var e=acfw_edit_coupon.condition_field_options,n=e.exactly,o=e.anyexcept,i=e.morethan,a=e.lessthan;return'\n        <option value="=" '+u(t,"=")+">"+n+'</option>\n        <option value="!=" '+u(t,"!=")+">"+o+'</option>\n        <option value=">" '+u(t,">")+">"+i+'</option>\n        <option value="<" '+u(t,"<")+">"+a+"</option>\n    "}function _(t){var e=acfw_edit_coupon.decimal_separator;return parseFloat(t.replace(e,"."))}function v(t,e){return"percent"!==t&&"fixed"!==t||0<_(e)}function h(t){void 0===t&&(t="");var e=acfw_edit_coupon.logic_field_options,n=e.and,o=e.or;return'\n        <div class="condition-group-logic">\n            <div class="field-control">\n                <select class="cgroup-logic">\n                    <option value="and" '+u(t,"and")+">"+n+'</option>\n                    <option value="or" '+u(t,"or")+">"+o+"</option>\n                </select>\n            </div>\n        </div>\n    "}function g(e){void 0===e&&(e="");var n=acfw_edit_coupon.empty_cart_conditions_field;return'\n        <div class="condition-group '+(e?"":"new")+'">\n            <a class="remove-condition-group" href="javascript:void(0);">\n                <i class="dashicons dashicons-trash"></i>\n            </a>\n            <div class="condition-group-fields">\n                '+(e||'<div class="empty-conditions">'+n+"</div>")+"\n            </div>\n            "+t()+"\n        </div>\n    "}var y=jQuery;function b(){var t=document.querySelector("#acfw_cart_conditions .condition-data-wrap .condition-groups");y(t).find(".condition-group").length&&y(t).append(h("or")),y(t).find(".no-condition-group").remove(),y(t).append(g()),y(this).blur(),y(t).find(".condition-group.new .add-condition-trigger").trigger("click"),y(t).find(".condition-group").removeClass("new"),i(!0)}function m(){var t=y(this),e=document.querySelector("#acfw_cart_conditions"),n=t.closest(".condition-group"),o=0==n.index()?n.next(".condition-group-logic"):n.prev(".condition-group-logic"),a=acfw_edit_coupon.no_condition_group_msg;n.remove(),o.remove(),y(e).find(".condition-group").length<1&&y(e).find(".condition-groups").append('\n            <div class="no-condition-group">\n                '+a+"\n            </div>\n        "),i(!0)}function w(t){void 0===t&&(t="");var e=acfw_edit_coupon.logic_field_options,n=e.and,o=e.or;return'<div class="logic-condition-field condition-field" data-type="logic">\n        <div class="field-control">\n            <select class="condition-logic">\n                <option value="and" '+u(t,"and")+">"+n+'</option>\n                <option value="or" '+u(t,"or")+">"+o+"</option>\n            </select>\n        </div>\n    </div>"}var x=acfw_edit_coupon.cart_condition_fields,q=acfw_edit_coupon.condition_field_options;function k(t){var e=t.value,n=t.condition,o=t.quantity,i=x.product_category,a=i.title,c=i.placeholder,d=i.field,l=x.cart_quantity.field,s=acfw_edit_coupon.condition_label,r=q.exactly,u=q.anyexcept,f=q.morethan,_=q.lessthan,v=n||">";return'\n    <div class="product-category-field condition-field" data-type="product-category">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'+a+'</h3>\n        <div class="field-control categories">\n            <label>'+d+'</label>\n            <select class="condition-value wc-enhanced-select" multiple data-placeholder="'+c+'">\n                '+function(t){void 0===t&&(t=[]);var e=x.product_category.options,n="";for(var o in e)n+='<option value="'+o+'" '+p(t,o)+">"+e[o]+"</option>";return n}(e)+'\n            </select>\n        </div>\n        <div class="field-control condition">\n            <label>'+s+'</label>\n            <select class="condition-select">\n                <option value="=" '+("="==v?"selected":"")+">"+r+'</option>\n                <option value="!=" '+("!="==v?"selected":"")+">"+u+'</option>\n                <option value=">" '+(">"==v?"selected":"")+">"+f+'</option>\n                <option value="<" '+("<"==v?"selected":"")+">"+_+'</option>\n            </select>\n        </div>\n        <div class="field-control quantity">\n            <label>'+l+'</label>\n            <input type="number" class="condition-quantity" value="'+o+'" min="'+("<"==n?1:0)+'">\n        </div>\n    </div>\n    '}var j=acfw_edit_coupon.cart_condition_fields;function S(t){return'\n        <div class="customer-logged-in-status-field condition-field" data-type="customer-logged-in-status">\n\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n\n        <h3 class="condition-field-title">'+j.customer_logged_in_status.title+'</h3>\n\n        <div class="field-control">\n            <select class="condition-value">\n                '+function(t){var e=j.customer_logged_in_status.options,n="";for(var o in e)n+='<option value="'+o+'" '+u(o,t)+">"+e[o]+"</option>";return n}(t)+"\n            </select>\n        </div>\n    </div>"}var O=acfw_edit_coupon.cart_condition_fields;function C(t){var e=O.customer_user_role;return'\n        <div class="customer-user-role-field condition-field" data-type="customer-user-role">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'+e.title+'</h3>\n            <div class="field-control">\n                <select class="wc-enhanced-select condition-value" multiple data-placeholder="'+e.placeholder+'">\n                    '+function(t){var e=acfw_edit_coupon.user_role_options,n="";for(var o in e)n+='<option value="'+o+'" '+p(t,o)+">"+e[o]+"</option>";return n}(t)+"\n                </select>\n            </div>\n        </div>\n    "}var Q=acfw_edit_coupon.cart_condition_fields;function N(t){var e=Q.disallowed_customer_user_role;return'\n        <div class="disallowed-customer-user-role-field condition-field" data-type="disallowed-customer-user-role">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'+e.title+'</h3>\n            <div class="field-control">\n                <select class="wc-enhanced-select condition-value" multiple data-placeholder="'+e.placeholder+'">\n                    '+function(t){var e=acfw_edit_coupon.user_role_options,n="";for(var o in e)n+='<option value="'+o+'" '+p(t,o)+">"+e[o]+"</option>";return n}(t)+"\n                </select>\n            </div>\n        </div>\n    "}var I=acfw_edit_coupon.cart_condition_fields;var J=jQuery,P=acfw_edit_coupon.cart_condition_fields,A=acfw_edit_coupon.premium_cart_condition_fields,T=acfw_edit_coupon.upsell;function W(){var t=J(this),e=t.closest(".condition-group-actions").find("select.condition-types"),n=t.closest(".condition-group"),o=n.find(".condition-group-fields"),a=document.querySelector("#acfw_cart_conditions .acfw-overlay"),c=e.val()+"",l=o.find(".condition-field,.condition-set").length;if(d(a,"show"),A&&A.indexOf(c)>-1)vex.dialog.alert({unsafeMessage:T.cart_condition_field});else{var s=M(c,null,l);s?(o.find(".empty-conditions").remove(),o.show().append(s),o.find("."+c+"-field").find("input,select").trigger("change"),J("body").trigger("wc-enhanced-select-init"),i(!0)):vex.dialog.alert(acfw_edit_coupon.fail_add_condition_field)}d(a,"hide"),n.find(".condition-group-actions .add-condition-form").hide(),n.find(".condition-group-actions .add-condition-trigger").show()}function E(){var t=J(this).closest(".condition-field,.condition-set"),e=t.closest(".condition-group"),n=0==t.index()?t.next(".logic-condition-field"):t.prev(".logic-condition-field"),o=acfw_edit_coupon.empty_cart_conditions_field;t.remove(),n.remove(),e.find(".condition-field,.condition-set").length<1&&e.find(".condition-group-fields").append('\n            <div class="empty-conditions">\n                '+o+"\n            </div>\n        "),i(!0)}function M(t,e,n){void 0===e&&(e=null),void 0===n&&(n=0);var o="";switch(t){case"product-category":(e=e||{}).length&&(e={condition:">",value:e,quantity:0}),o+=k(e);break;case"customer-logged-in-status":o+=S(e);break;case"customer-user-role":o+=C(e=e||[]);break;case"disallowed-customer-user-role":o+=N(e=e||[]);break;case"cart-quantity":o+=function(t){var e=t.condition,n=t.value,o=I.cart_quantity,i=o.title,a=o.desc,c=o.field;return'\n    <div class="cart-quantity-field condition-field" data-type="cart-quantity">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'+i+"</h3>\n        <label>"+a+'</label>\n        <div class="field-control">\n            <label>'+acfw_edit_coupon.condition_label+'</label>\n            <select class="condition-select">\n                '+f(e)+'\n            </select>\n        </div>\n        <div class="field-control">\n            <label>'+c+'</label>\n            <input class="condition-value" type="number" min="0" value="'+(n>=0?n:"")+'">\n        </div>\n    </div>\n    '}(e=e||{});break;case"cart-subtotal":o+=function(t){var e=t.condition,n=t.value,o=acfw_edit_coupon.cart_condition_fields,i=acfw_edit_coupon.condition_label,a=o.cart_subtotal,c=a.title,d=a.desc,l=a.field;return'\n    <div class="cart-subtotal-field condition-field" data-type="cart-subtotal">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'+c+"</h3>\n        <label>"+d+'</label>\n        <div class="field-control">\n            <label>'+i+'</label>\n            <select class="condition-select">\n                '+f(e)+'\n            </select>\n        </div>\n        <div class="field-control">\n            <label>'+l+'</label>\n            <input class="condition-value wc_input_price" type="text" value="'+(n||"")+'">\n        </div>\n    </div>\n    '}(e=e||{});break;default:var i=t.replace(/-/g,"_");if(P[i]){var a=P[i],c=a.template_callback,d=a.default_data_value;d&&(e=e||d),c&&(o+=c(e,i))}}return o&&n?w()+o:o}function D(t){return acfw_edit_coupon.cart_conditon_field_options.indexOf(t)>-1}var F=jQuery,z=acfw_edit_coupon.cart_condition_fields;function L(t){var e=t.querySelectorAll(".condition-set,.condition-field"),n=[];return t.classList.contains("condition-group-logic")?{type:"group_logic",value:t.querySelector("select").value}:(e.forEach((function(t){return n.push(function(t){var e,n,o,i=t.dataset.type,a={type:i,data:null};switch(i){case"logic":e=t.querySelector("select.condition-logic"),a.data=e.value;break;case"product-category":e=t.querySelector(".condition-value"),n=t.querySelector(".condition-select"),o=t.querySelector(".condition-quantity"),a.data={condition:F(n).val(),value:F(e).val(),quantity:F(o).val()};break;case"customer-logged-in-status":case"customer-user-role":case"disallowed-customer-user-role":e=t.querySelector(".condition-value"),a.data=F(e).val();break;case"cart-quantity":case"cart-subtotal":e=t.querySelector(".condition-select"),n=t.querySelector(".condition-value"),a.data={condition:F(e).val(),value:"cart-subtotal"==i?F(n).val():parseInt(F(n).val())};break;default:var c=i.replace(/-/g,"_");if(z[c]){var d=z[c].scraper_callback;a.data=d(t)}}return a}(t))})),n.length?{type:"group",fields:n}:null)}var U=jQuery,B=woocommerce_admin_meta_boxes.post_id;function G(){var t=document.querySelector("#acfw_cart_conditions"),e=t.querySelectorAll(".condition-groups .condition-group, .condition-groups .condition-group-logic"),n=t.querySelector(".acfw-overlay"),o=acfw_edit_coupon.post_status,a=woocommerce_admin_meta_boxes.post_id,c=[];if(U(t).find(".acfw-styled-table tr.add-edit-form button.cancel").trigger("click"),e.forEach((function(t){var e=L(t);e&&c.push(e)})),!function(t){var e,n,o,i,a,c,d,l,s;if(1===t.length&&(null===(e=t[0].fields)||void 0===e?void 0:e.length)<1)return!0;for(var u="",p=0,f=t;p<f.length;p++)if("group_logic"!==(n=f[p]).type){if(u=n.type,void 0===n.fields||n.fields.length<1)return!1;for(var _=0,v=n.fields;_<v.length;_++){if(a=(o=v[_]).type,void 0===(i=o.data)||""===i||null===i)return!1;if("object"==typeof i&&"number"==typeof i.length?c=i:"product-category"===a?(c=i.value,d=i.condition,l=i.quantity):"object"==typeof i&&void 0===i.length?(c=i.products,d=i.condition,l=i.value):l=i,s=r(d),void 0!==c&&c.length<1||void 0!==d&&!d||!Number.isInteger(l)&&void 0!==l&&!l||Number.isInteger(l)&&l<s||"number"==typeof l&&l<s)return!1}}else{if(!u||"group_logic"===u)return!1;u="group_logic"}return!0}(c))return vex.dialog.alert(acfw_edit_coupon.cart_conditions_invalid),void U(t).addClass("save-error");var l={message:U(t).find(".text-input.non-qualifying-message-field").val(),btn_text:U(t).find(".text-input.non-qualifying-btn-text-field").val(),btn_url:U(t).find(".text-input.non-qualifying-btn-url-field").val()},s=U(t).find(".display-notice-auto-apply-field").is(":checked")?"yes":"";if(l.btn_url&&!/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(l.btn_url))return vex.dialog.alert(acfw_edit_coupon.cart_notice_url_invalid),void U(t).addClass("save-error");d(n,"show"),K({cart_conditions:c,notice_settings:l,auto_apply_display:s},(function(e){"success"==e.status?"publish"!==o&&(U("input[name='post_title']").val()||U("input[name='post_title']").val("coupon-"+a),U("select[name='post_status']").append(new Option("Published","publish")).val("publish"),U("#publishing-action").append('\n                    <input type="hidden" name="publish" value="Publish">\n                '),U("input#publish").click()):e.error_msg&&vex.dialog.alert(e.error_msg),i(!1),U(t).find("#save-cart-conditions").prop("disabled",!0),d(n,"hide")}))}function H(t){var e=document.querySelector("#acfw_cart_conditions");U(e).data("editing")&&(t.preventDefault(),U(e).find("#save-cart-conditions").trigger("click"),setTimeout((function(){U(e).hasClass("save-error")?U(e).removeClass("save-error"):U("form#post").submit()}),1e3))}function K(t,e){return t.action="acfw_save_cart_conditions",t.coupon_id=B,U.post(ajaxurl,t,e,"json")}var R=jQuery,V=acfw_edit_coupon.product_table_buttons,X=acfw_edit_coupon.condition_field_options,Y=acfw_edit_coupon.bogo_form_fields;function Z(){var t=R(this).closest(".acfw-styled-table"),e=t.find("tbody"),n=t.data("exclude");e.find("tr.no-result").remove(),e.append(it(n)),R("body").trigger("wc-enhanced-select-init")}function $(){var t=R(this),e=t.closest("tr"),n=t.closest("table"),o=e.closest("tbody"),i=e.find("td.product").data("product"),a=n.data("exclude");a.splice(a.indexOf(i.product_id),1),o.find("tr.no-result").remove(),e.replaceWith(it(a,i)),n.data("exclude",a),n.find(".wc-product-search").data("exclude",a),R("body").trigger("wc-enhanced-select-init")}function tt(){var t=R(this),e=t.closest("tr"),n=t.closest("table.acfw-styled-table"),o=e.find(".wc-product-search"),a=e.find(".condition-select"),c=e.find(".condition-quantity"),d="<"===a.val()?1:0,s=n.data("exclude");if(o.val()&&a.val()&&c.val()&&!(c.val()<d)){var r=parseInt(o.val().toString());if(s.includes(r))vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);else{var u={product_id:r,condition:a.val(),quantity:parseInt(c.val()+""),product_label:o.find("option:selected").text(),condition_label:a.find("option:selected").text()},p='\n        <tr>\n            <td class="product" data-product="'+l(JSON.stringify(u))+'">'+u.product_label+'</td>\n            <td class="condition">'+u.condition_label+'</td>\n            <td class="quantity">'+u.quantity+'</td>\n            <td class="actions">\n                <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n                <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n            </td>\n        </tr>\n    ';s.push(u.product_id),e.replaceWith(p),n.data("exclude",s),n.find(".wc-product-search").data("exclude",s),i(!0)}}else vex.dialog.alert(acfw_edit_coupon.fill_form_propery_error_msg)}function et(){var t=jQuery(this),e=t.closest("tr"),n=t.closest("table"),o=e.closest("tbody"),i=e.find("td.product").data("product"),a=e.find("td").length,c=n.data("exclude");if(c.includes(i.product_id))vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);else if("object"==typeof i){var d=i.product_id,s=i.product_label,r=i.condition_label,u=i.quantity,p='\n            <tr>\n                <td class="product" data-product="'+l(JSON.stringify(i))+'">'+s+'</td>\n                <td class="condition">'+r+'</td>\n                <td class="quantity">'+u+'</td>\n                <td class="actions">\n                    <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n                    <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n                </td>\n            </tr>\n        ';c.push(d),e.replaceWith(p),n.data("exclude",c),n.find(".wc-product-search").data("exclude",c)}else e.remove(),ot(o,a)}function nt(){var t=jQuery(this).closest("tr"),e=t.closest("table"),n=e.find("tbody"),o=t.find("td").length;t.remove();var a=t.find("td.product").data("product"),c=e.data("exclude"),d=c.indexOf(parseInt(a.product_id));-1!==d&&c.splice(d,1),e.data("exclude",c),e.find(".wc-product-search").data("exclude",c),ot(n,o),i(!0)}function ot(t,e){void 0===e&&(e=3),t.find("tr").length>0||t.append('\n        <tr class="no-result">\n            <td colspan="'+e+'">'+acfw_edit_coupon.no_products_added+"</td>\n        </tr>\n    ")}function it(t,e){void 0===t&&(t=[]),void 0===e&&(e=!1);var n="",o="";"object"==typeof e&&(n='<option value="'+e.product_id+'">'+e.product_label+"</option>",o=e.condition);var i=V.add,a=V.edit,c=V.cancel,d=X.exactly,s=X.anyexcept,r=X.morethan,u=X.lessthan,p=Y.type_to_search,f="object"==typeof e?a:i;return'\n        <tr class="add-edit-form adding">\n            <td class="product" data-product="'+("object"==typeof e?l(JSON.stringify(e)):0)+'">\n                <div class="object-search-wrap">\n                    <select class="product-in-cart wc-product-search"\n                        data-placeholder="'+p+'"\n                        data-action="acfw_search_products"\n                        data-exclude="'+l(JSON.stringify(t))+'">'+n+'</select>\n                </div>\n            </td>\n            <td class="condition">\n                <select class="condition-select">\n                    <option value="=" '+("="==o?"selected":"")+">"+d+'</option>\n                    <option value="!=" '+("!="==o?"selected":"")+">"+s+'</option>\n                    <option value=">" '+(">"==o?"selected":"")+">"+r+'</option>\n                    <option value="<" '+("<"==o?"selected":"")+">"+u+'</option>\n                </select>\n            </td>\n            <td class="quantity">\n                <input type="number" class="condition-quantity" value="'+("object"==typeof e?e.quantity:1)+'" min="'+("<"==o?1:0)+'">\n            </td>\n            <td class="actions">\n                <button type="button" class="condition-product-add button-primary">'+f+'</button>\n                <button type="button" class="cancel button">'+c+"</button>\n            </td>\n        </tr>\n        "}var at=jQuery;function ct(){var t=at(this),e=parseInt(t.attr("min"));parseFloat(t.val()+"")<e&&t.val(e)}function dt(){var t=at(this),e=t.closest(".condition-field,.condition-set"),n=e.data("type"),o="product-quantity"==n||"has-ordered-before"==n||"product-category"==n?"input.condition-quantity":"input.condition-value",i=e.find(o),a=r(t.val()+"");i.attr("min",a).trigger("change")}function lt(){var t=acfw_edit_coupon.within_a_period_label,e=acfw_edit_coupon.number_of_orders_label,n=at(this),o=n.closest(".cart-quantity-field").find(".condition-type-value label");"within-a-period"==n.val()?o.text(t):o.text(e)}function st(){var t=at(this),e=t.closest(".condition-field").find("select.condition-select"),n=e.val()+"",o=t.val()+"",i=r(n);"."!==acfw_edit_coupon.decimal_separator&&(o=o.replace(acfw_edit_coupon.decimal_separator,".")),!e||parseFloat(o)>i-1||t.val(i)}function rt(){var t=at(this),e=t.val();e=="0"+acfw_edit_coupon.decimal_separator&&t.val("0"),"0"!=e&&e.substring(0,2)!="0"+acfw_edit_coupon.decimal_separator&&(e=(e=e.replace(/^0+/,"")).substring(0,1)==acfw_edit_coupon.decimal_separator?"0"+e:e,t.val(e))}function ut(){var t=at(this),e=t.closest(".condition-field"),n=e.find("select.condition-select"),o=e.find("input.condition-value");switch(t.val()){case"string":o.prop("type","text"),o.removeClass("wc_input_price"),">"!=n.val()&&"<"!=n.val()||n.val("="),n.find("option[value='>'],option[value='<']").prop("disabled",!0);break;case"number":o.prop("type","number"),o.removeClass("wc_input_price"),n.find("option[value='>'],option[value='<']").prop("disabled",!1);break;case"price":o.prop("type","text"),o.addClass("wc_input_price"),n.find("option[value='>'],option[value='<']").prop("disabled",!1)}n.trigger("change")}var pt=jQuery;function ft(){var t=pt(this),e=t.closest(".woocommerce").find("#acfw_cart_conditions"),n=t.data("tab");e.find(".panel").hide(),e.find('.panel[data-tab="'+n+'"]').show(),function(t){pt(".acfw-cart-condition-tabs li").removeClass("active"),t.closest("li").addClass("active")}(t)}var _t=function(t,e,n,o){return new(n||(n=Promise))((function(i,a){function c(t){try{l(o.next(t))}catch(t){a(t)}}function d(t){try{l(o.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,d)}l((o=o.apply(t,e||[])).next())}))},vt=function(t,e){var n,o,i,a,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:d(0),throw:d(1),return:d(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function d(a){return function(d){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,o=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!(i=c.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){c=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){c.label=a[1];break}if(6===a[0]&&c.label<i[1]){c.label=i[1],i=a;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(a);break}i[2]&&c.ops.pop(),c.trys.pop();continue}a=e.call(t,c)}catch(t){a=[6,t],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,d])}}},ht=jQuery,gt=document.querySelector("#acfw_cart_conditions");function yt(){var t=this,e=gt.querySelector(".condition-groups"),n=ht(gt).data("cart_conditions");_t(t,void 0,void 0,(function(){var t,o,i,a,c;return vt(this,(function(d){if(t="",n.length)for(o=0,i=n;o<i.length;o++)"group"==(a=i[o]).type?(c=bt(a.fields),t+=g(c)):t+=h(a.value);else t=g();return ht(e).html(t),ht(e).find("input,select").trigger("change"),ht(e).find(".condition-group.new .add-condition-trigger").trigger("click"),ht(e).find(".condition-group").removeClass("new"),[2]}))})).then((function(){setTimeout((function(){return ht("body").trigger("wc-enhanced-select-init")}),1500),i(!1)}))}function bt(t){for(var e="",n="",o=!0,i=0,a=t;i<a.length;i++){var c=a[i],d=c.type,l=c.data;if(D(d))if("logic"!=d){var s=M(d,l);s?(e+=n+s,o=!0):o=!1,n=""}else n=o?w(l):"";else o=!1}return e}function mt(){var t=acfw_edit_coupon.upsell;return t?'\n    <div class="upsell">\n        '+t.bogo_deals_type+"\n    </div>":""}function wt(t,e){void 0===e&&(e=!1);var n=t.products,o=t.quantity,i=t.discount_type,a=t.discount_value,c=acfw_edit_coupon.bogo_form_fields,d=acfw_edit_coupon.bogo_instructions,s=c.quantity,r=c.products,u=c.price_discount,p=c.type_to_search,f=i?t.discount_type:"override",_=e?function(t,e){void 0===e&&(e="0");var n=acfw_edit_coupon.currency_symbol,o=acfw_edit_coupon.discount_field_options,i=o.override,a=o.percent,c=o.fixed;return'\n    <td class="price">\n        <div>\n        <select class="discount_type">\n            <option value="override" '+("override"==t?"selected":"")+">"+n+" : "+i+'</option>\n            <option value="percent" '+("percent"==t?"selected":"")+">% : "+a+'</option>\n            <option value="fixed" '+("fixed"==t?"selected":"")+">-"+n+" : "+c+'</option>\n        </select>\n        <input type="text" class="discount_value short wc_input_price" value="'+e+'">\n        </div>\n    </td>\n    '}(f,a):"",v=e?'<th class="price">'+u+"</th>":"",h=function(t){if("object"!=typeof t||!t.length)return;for(var e="",n=0,o=t;n<o.length;n++){var i=o[n];e+='<option value="'+i.product_id+'" selected>'+i.label+"</option>"}return e}(n);return'\n      <p class="instructions">'+(e?d.apply_default+" "+d.multiple_items:d.trigger_default)+'</p>\n      <table class="acfw-styled-table combined-products-form" \n          data-combined="'+l(JSON.stringify(t))+'"\n          data-isdeals="'+e+'">\n          <thead>\n              <tr>\n                  <th class="products-list">'+r+'</th>\n                  <th class="quantity">'+s+"</th>\n                  "+v+'\n              </tr>\n          </thead>\n          <tbody>\n              <tr>\n                  <td class="products-list object">\n                      <select class="combined-products-list wc-product-search"\n                      data-placeholder="'+p+'"\n                      data-action="acfw_search_products"\n                      data-exclude="" multiple>'+h+'</select>\n                  </td>\n                  <td class="quantity">\n                      <input type="number" class="condition-quantity" value="'+o+'" min="1">\n                  </td>\n                  '+_+"\n              </tr>\n          </tbody>\n      </table>\n      "+mt()+"\n    "}function xt(t){var e=t.category_id,n=t.category_label;return'\n    <td class="category category-'+e+' object" data-category="'+l(JSON.stringify(t))+'">\n        '+n+"\n    </td>\n    "}function qt(t,e){void 0===t&&(t=3),void 0===e&&(e="product");var n=acfw_edit_coupon.no_products_added,o=acfw_edit_coupon.no_categories_added;return'\n    <tr class="no-result">\n        <td colspan="'+t+'">'+("category"==e?o:n)+"</td>\n    </tr>\n    "}function kt(t,e){return void 0===t&&(t="override"),void 0===e&&(e="0"),'<td class="price">\n        ('+t+") "+e+"\n    </td>"}function jt(t){var e=t.product_id,n=t.product_label;return'\n    <td class="product product-'+e+' object" data-product="'+l(JSON.stringify(t))+'">\n        '+n+"\n    </td>\n    "}function St(t,e){return void 0===t&&(t="override"),void 0===e&&(e="0"),'<td class="price">\n        ('+t+") "+e+"\n    </td>"}function Ot(t,e){return void 0===e&&(e=!1),e?function(t){var e=t.quantity,n=t.discount_type,o=t.discount_value,i=acfw_edit_coupon.currency_symbol,a=acfw_edit_coupon.discount_field_options,c=acfw_edit_coupon.bogo_form_fields,d=acfw_edit_coupon.bogo_instructions,s=a.override,r=a.percent,u=a.fixed,p=c.quantity,f=c.price_discount,_=c.discount_type,v=n?t.discount_type:"override";return'\n    <p class="instructions">'+d.anyproducts_apply+'</p>\n    <table class="acfw-styled-table any-products-apply-form any-products-form" data-anyproducts="'+l(JSON.stringify(t))+'">\n      <thead>\n        <tr>\n          <th class="quantity">'+p+'</th>\n          <th class="type">'+_+'</th>\n          <th class="price">'+f+'</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td class="quantity object">\n            <input type="number" class="condition-quantity" value="'+(null!=e?e:"1")+'" min="1">\n          </td>\n          <td class="type">\n            <select class="discount_type">\n              <option value="override" '+("override"==v?"selected":"")+">"+i+" : "+s+'</option>\n              <option value="percent" '+("percent"==v?"selected":"")+">% : "+r+'</option>\n              <option value="fixed" '+("fixed"==v?"selected":"")+">-"+i+" : "+u+'</option>\n            </select>\n          </td>\n          <td class="price">\n            <input type="text" class="discount_value short wc_input_price" value="'+(null!=o?o:"0")+'">\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    '+mt()+"\n  "}(t):function(t){var e=t.quantity,n=acfw_edit_coupon.bogo_instructions,o=acfw_edit_coupon.bogo_form_fields;return'\n    <p class="instructions">'+n.anyproducts_trigger+'</p>\n    <div class="any-products-trigger-form any-products-form" data-anyproducts="'+l(JSON.stringify(t))+'">\n      <div class="trigger-field-row trigger-quantity-field-row">\n        <label for="any_products_trigger_qty">'+o.trigger_quantity+'</label>\n        <input type="number" id="any_products_trigger_qty" class="condition-quantity" value="'+(null!=e?e:"1")+'" min="1" />\n      </div>\n    </div>\n    '+mt()+"\n  "}(t)}var Ct=jQuery,Qt=document.querySelector("#acfw_bogo_deals");function Nt(t){Ct(Qt).data("editing",t),Ct(Qt).find("#save-bogo-deals").prop("disabled",!t)}function It(t){var e=Ct(this),n=e.data("block"),o=Qt.querySelector(".bogo-conditions-block"),i=Qt.querySelector(".bogo-product-deals-block"),a=Ct(Qt).data("bogo_deals"),c=a.conditions?a.conditions:null,d=a.deals?a.deals:null,s="conditions"==n?a.conditions_type:a.deals_type,r=null;r="conditions"===n?a.conditions_type==e.val()?c:r:a.deals_type==e.val()?d:r;var u,p,f="deals"==n,_=!1;switch(e.val()){case"combination-products":u=wt(null!=r?r:{},f),_=!0;break;case"product-categories":u=function(t,e,n){void 0===n&&(n=!1);var o=acfw_edit_coupon.add_prod_cat_label,i=acfw_edit_coupon.bogo_form_fields,a=acfw_edit_coupon.bogo_instructions,c=i.quantity,d=i.product_cat,s=n?4:3,r=n?'<th class="price">Price/Discount</th>':"",u=n?a.apply_default+" "+a.multiple_items:a.trigger_default,p="",f=[];if(t.length>=1&&"product-categories"==e)for(var _=0,v=t;_<v.length;_++){var h=v[_],g=h.category_id,y=h.quantity,b=h.discount_type,m=h.discount_value,w=n?kt(b,m):"";f.push(g),p+="\n                <tr>\n                    "+xt(h)+'\n                    <td class="quantity">'+y+"</td>\n                    "+w+'\n                    <td class="actions">\n                        <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n                        <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n                    </td>\n                </tr>\n            '}else p=qt(s,"category");return'\n        <p class="instructions">'+u+'</p>\n        <table class="acfw-styled-table" \n            data-type="category" \n            data-exclude="'+l(JSON.stringify(f))+'" \n            data-isdeals="'+n+'">\n            <thead>\n                <tr>\n                    <th class="product-cat">'+d+'</th>\n                    <th class="quantity">'+c+"</th>\n                    "+r+'\n                    <th class="actions"></th>\n                </tr>\n            </thead>\n            <tbody>'+p+'</tbody>\n            <tfoot>\n                <tr>\n                    <td colspan="'+s+'">\n                        <a class="add-table-row" href="javascript:void(0);">\n                            <i class="dashicons dashicons-plus"></i>\n                            '+o+"\n                        </a>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n        "+mt()+"\n    "}(null!=r?r:[],s,f),_=!0;break;case"any-products":u=Ot(null!=r?r:{},f),_=!0;break;default:u=function(t,e,n){void 0===n&&(n=!1);var o=acfw_edit_coupon.add_product_label,i=acfw_edit_coupon.bogo_form_fields,a=acfw_edit_coupon.bogo_instructions,c=i.quantity,d=i.product,s=n?4:3,r=n?'<th class="price">Price/Discount</th>':"",u="",p=[];if(t.length>=1&&"specific-products"==e)for(var f=0,_=t;f<_.length;f++){var v=_[f],h=v.quantity,g=v.discount_type,y=v.discount_value,b=n?St(g,y):"";p.push(v.product_id),u+="\n                <tr>\n                    "+jt(v)+'\n                    <td class="quantity">'+h+"</td>\n                    "+b+'\n                    <td class="actions">\n                        <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n                        <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n                    </td>\n                </tr>\n            '}else u=qt(s);return'\n        <p class="instructions">'+a.apply_default+'</p>\n        <table class="product-quantity-condition-table acfw-styled-table" \n            data-type="product" data-exclude="'+l(JSON.stringify(p))+'" \n            data-isdeals="'+n+'">\n            <thead>\n                <tr>\n                    <th class="product">'+d+'</th>\n                    <th class="quantity">'+c+"</th>\n                    "+r+'\n                    <th class="actions"></th>\n                </tr>\n            </thead>\n            <tbody>'+u+'</tbody>\n            <tfoot>\n                <tr>\n                    <td colspan="'+s+'">\n                        <a class="add-table-row" href="javascript:void(0);">\n                            <i class="dashicons dashicons-plus"></i>\n                            '+o+"\n                        </a>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n    "}(null!=r?r:[],s,f),_=!1}if("conditions"==n)Ct(o).html(u).find("input.condition-quantity").trigger("change"===t.type?"change":"acfw_fetch_data"),p=o;else{var v=Ct(Qt).find(".multiple-items-desc");"specific-products"!==e.val()?v.show():v.hide(),Ct(i).html(u).find("input.condition-quantity").trigger("change"===t.type?"change":"acfw_fetch_data"),p=i}_&&void 0!==acfw_edit_coupon.upsell?Ct(p).addClass("premium-only"):Ct(p).removeClass("premium-only"),Ct("body").trigger("wc-enhanced-select-init"),Ct("body").trigger("init_tooltips")}var Jt=function(){return Jt=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Jt.apply(this,arguments)},Pt=jQuery,At=document.querySelector("#acfw_bogo_deals"),Tt=woocommerce_admin_meta_boxes.post_id;function Wt(){var t,e;Pt("#acfw_bogo_deals").find(".acfw-styled-table tr.add-edit-form button.cancel").trigger("click");var n=acfw_edit_coupon.post_status,o=acfw_edit_coupon.upsell,i=At.querySelectorAll(".bogo-conditions-block table.acfw-styled-table tbody td.object,.bogo-conditions-block .any-products-trigger-form"),a=At.querySelectorAll(".bogo-product-deals-block table.acfw-styled-table tbody td.object"),c=At.querySelector(".acfw-overlay"),l=At.querySelector("input[name='bogo_type']:checked"),s=Pt(At).find("#bogo-condition-type").val(),r=Pt(At).find("#bogo-deals-type").val(),u=Pt(At).find(".notice-option"),p=Et(i,s),f=Et(a,r),_=l?l.value:null,h=!1,g=!1;if("any-products"===s&&(h=(null==p?void 0:p.quantity)<1),"any-products"===r&&(g=!(null==f?void 0:f.discount_type)||!(null==f?void 0:f.discount_value)||(null==f?void 0:f.quantity)<1),"combination-products"===s&&(h=!(null===(t=null==p?void 0:p.products)||void 0===t?void 0:t.length)||(null==p?void 0:p.quantity)<1),"combination-products"===r&&(g=!(null===(e=null==f?void 0:f.products)||void 0===e?void 0:e.length)||!(null==f?void 0:f.discount_type)||!(null==f?void 0:f.discount_value)||(null==f?void 0:f.quantity)<1),(null==p?void 0:p.length)<1||(null==f?void 0:f.length)<1||!_||h||g)return vex.dialog.alert(acfw_edit_coupon.bogo_deals_save_error_msg),void Pt(At).addClass("save-error");if(void 0!==o&&("specific-products"!==s||"specific-products"!==r))return vex.dialog.alert(acfw_edit_coupon.bogo_deals_save_error_msg),void Pt(At).addClass("save-error");if(["any-products","combination-products"].includes(r)&&!v(null==f?void 0:f.discount_type,null==f?void 0:f.discount_value))return vex.dialog.alert(acfw_edit_coupon.discount_type_value_error_msg),void Pt(At).addClass("save-error");var y={message:u.find("textarea[name='acfw_bogo_notice_message_text']").val(),button_text:u.find("input[name='acfw_bogo_notice_button_text']").val(),button_url:u.find("input[name='acfw_bogo_notice_button_url']").val(),notice_type:u.find("select[name='acfw_bogo_notice_type']").val()};d(c,"show"),Pt(At).trigger("save_bogo_deals");var b={conditions:p,deals:f,conditions_type:s,deals_type:r,type:_,notice_settings:y};Pt.post(ajaxurl,Jt({action:"acfw_save_bogo_deals",coupon_id:Tt},b),(function(t){"success"==t.status?(Pt(At).data("bogo_deals",b),"publish"!==n&&(Pt("input[name='post_title']").val()||Pt("input[name='post_title']").val("coupon-"+Tt),Pt("select[name='post_status']").append(new Option("Published","publish")).val("publish"),Pt("#publishing-action").append('\n                    <input type="hidden" name="publish" value="Publish">\n                '),Pt("input#publish").click())):t.error_msg&&vex.dialog.alert(t.error_msg),Pt(At).find("#clear-bogo-deals").prop("disabled",!1),Nt(!1),d(c,"hide")}),"json")}function Et(t,e){var n,o=[];switch(e){case"any-products":o=Pt(t).closest(".any-products-form").data("anyproducts");break;case"combination-products":o=Pt(t).closest("table.combined-products-form").data("combined");break;case"product-categories":t.forEach((function(t){(n=jQuery(t).data("category"))&&o.push(n)}));break;default:t.forEach((function(t){(n=jQuery(t).data("product"))&&o.push(n)}))}return o}function Mt(){var t=Pt(this);if(confirm(t.data("prompt"))){var e=At.querySelector(".bogo-conditions-block table.acfw-styled-table tbody"),n=At.querySelector(".bogo-product-deals-block table.acfw-styled-table tbody"),o=At.querySelector(".acfw-overlay"),i=At.querySelector("input[name='bogo_type']:checked");d(o,"show"),Pt.post(ajaxurl,{action:"acfw_clear_bogo_deals",coupon_id:Tt,_wpnonce:t.data("nonce")},(function(a){"success"==a.status?(Pt(e).html(qt(3)),Pt(n).html(qt(4)),Pt(i).prop("checked",!1),t.prop("disabled",!0),Nt(!1),"Published"!=Pt("#post-status-display").text()&&(Pt("input[name='post_title']").val()||Pt("input[name='post_title']").val("coupon-"+Tt),Pt("input#publish").click())):a.error_msg&&vex.dialog.alert(a.error_msg),d(o,"hide")}),"json")}}function Dt(){var t,e,n=Pt(this).closest("table.combined-products-form"),o=n.data("combined"),i=n.find(".wc-product-search option:selected"),a={products:[],quantity:parseInt(n.find("input.condition-quantity").val()+"")};if(n.data("isdeals")){var c=n.find("select.discount_type"),d=n.find("input.discount_value"),l=parseFloat(d.val().toString());if(l<0||isNaN(l))return d.val(o?o.discount_value:""),void vex.dialog.alert(acfw_edit_coupon.fill_form_propery_error_msg);a.discount_type=c.val(),a.discount_value=d.val()}for(e=0;e<i.length;e++)t=Pt(i[e]),a.products.push({product_id:t.val(),label:t.text()});n.data("combined",a),Nt(!0)}function Ft(t){Pt(At).data("editing")&&(t.preventDefault(),Pt(At).find("#save-bogo-deals").trigger("click"),setTimeout((function(){Pt(At).hasClass("save-error")?Pt(At).removeClass("save-error"):Pt("form#post").submit()}),1e3))}function zt(t){var e=Pt(this).closest(".any-products-trigger-form"),n=parseInt(e.find("input#any_products_trigger_qty").val()),o={quantity:n&&!isNaN(n)?n:0};e.data("anyproducts",o),"change"===t.type&&Nt(!0)}function Lt(t){var e=Pt(this).closest(".any-products-apply-form"),n=parseInt(e.find("input.condition-quantity").val()),o=e.find("select.discount_type").val().toString(),i=e.find("input.discount_value").val().toString(),a={quantity:n&&!isNaN(n)?n:0,discount_type:null!=o?o:"",discount_value:null!=i?i:""};e.data("anyproducts",a),"change"===t.type&&Nt(!0)}function Ut(t,e,n,o){void 0===o&&(o=!1);var i=acfw_edit_coupon.bogo_form_fields.type_to_search,a=acfw_edit_coupon.product_table_buttons,c=a.add,d=a.edit,s=a.cancel,r=o.quantity,u="object"==typeof o?function(t,e){var n=e.category_id,o=e.product_id,i=e.category_label,a=e.product_label;return'<option value="'+("category"==t?n:o)+'">'+("category"==t?i:a)+"</option>"}(t,o):"",p=n?function(t){var e=acfw_edit_coupon.currency_symbol,n=acfw_edit_coupon.discount_field_options,o=n.override,i=n.percent,a=n.fixed,c=t.discount_type,d=t.discount_value;return'\n    <td class="price">\n        <div>\n        <select class="discount_type">\n            <option value="override" '+("override"==c?"selected":"")+">"+e+" : "+o+'</option>\n            <option value="percent" '+("percent"==c?"selected":"")+">% : "+i+'</option>\n            <option value="fixed" '+("fixed"==c?"selected":"")+">-"+e+" : "+a+'</option>\n        </select>\n        <input type="text" class="discount_value short wc_input_price" value="'+("object"==typeof t&&d?d:"0")+'">\n        </div>\n    </td>\n    '}(o):"",f="object"==typeof o?d:c;return'\n    <tr class="add-edit-form adding">\n        <td class="product" data-object="'+("object"==typeof o?l(JSON.stringify(o)):0)+'">\n            <div class="object-search-wrap">\n                <select class="'+("category"==t?"product-category-in-cart":"product-in-cart")+' wc-product-search"\n                    data-placeholder="'+i+'"\n                    data-action="'+("category"==t?"acfw_search_product_category":"acfw_search_products")+'"\n                    data-exclude="'+l(JSON.stringify(e))+'">'+u+'</select>\n            </div>\n        </td>\n        <td class="quantity">\n            <input type="number" class="condition-quantity" value="'+("object"==typeof o?r:1)+'" min="1">\n        </td>\n        '+p+'\n        <td class="actions">\n            <button type="button" class="condition-product-add button-primary">'+f+'</button>\n            <button type="button" class="cancel button">'+s+"</button>\n        </td>\n    </tr>\n    "}function Bt(t,e,n){var o=t.quantity,i=t.discount_type,a=t.discount_value,c=n?'<td class="price">('+i+") "+a+"</td>":"";return"\n    <tr>\n        "+function(t,e){switch(e){case"category":return xt(t);case"product":return jt(t)}}(t,e)+'\n        <td class="quantity">'+o+"</td>\n        "+c+'\n        <td class="actions">\n            <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n            <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n        </td>\n    </tr>'}var Gt=jQuery;acfw_edit_coupon.bogo_form_fields;function Ht(){var t=Gt(this).closest(".acfw-styled-table"),e=t.find("tbody"),n=t.data("isdeals"),o=t.data("type"),i=t.data("exclude");e.find("tr.no-result").remove(),e.append(Ut(o,i,n)),Gt("body").trigger("wc-enhanced-select-init"),e.find("tr.add-edit-form select.enhanced").trigger("focus")}function Kt(){var t=jQuery(this),e=t.closest("tr"),n=t.closest(".acfw-styled-table"),o=n.find("tbody"),i=n.data("isdeals"),a=n.data("type"),c=e.find(".object").data(a),d=c.category_id,l=c.product_id,s=n.data("exclude"),r="category"==a?d:l;s.splice(s.indexOf(r),1),o.find("tr.no-result").remove(),e.replaceWith(Ut(a,s,i,c)),n.data("exclude",s),n.find(".wc-product-search").data("exclude",s),Gt("body").trigger("wc-enhanced-select-init")}function Rt(){var t=Gt(this),e=t.closest("tr"),n=t.closest("table"),o=e.closest("tbody"),i=n.data("isdeals"),a=e.find("td").length,c=n.data("type"),d=e.find("td.product").data("object"),l=d.category_id,s=d.product_id,r=n.data("exclude"),u="category"==c?l:s;r.includes(u)?vex.dialog.alert(acfw_edit_coupon.product_exists_in_table):"object"==typeof d?(r.push(u),e.replaceWith(Bt(d,c,i)),n.data("exclude",r),n.find(".wc-product-search").data("exclude",r)):(e.remove(),o.find("tr").length<=0&&o.append(qt(a,c)))}function Vt(){var t=Gt(this),e=t.closest("tr"),n=t.closest("table.acfw-styled-table"),o=n.data("isdeals"),i=n.data("type"),a=e.find(".wc-product-search"),c=e.find(".condition-quantity"),d=n.data("exclude");if(!a.val()||!c.val()||c.val()<1)vex.dialog.alert(acfw_edit_coupon.fill_form_propery_error_msg);else if(d.includes(parseInt(a.val().toString())))vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);else{if(o){var l=e.find("input.discount_value").val().toString();if(!v(e.find("select.discount_type").val().toString(),l))return void vex.dialog.alert(acfw_edit_coupon.discount_type_value_error_msg);if(_(l)<0||isNaN(_(l)))return void vex.dialog.alert(acfw_edit_coupon.fill_form_propery_error_msg)}var s=function(t,e,n){var o={};o="category"==e?{category_id:parseInt(t.find(".wc-product-search").val()+""),quantity:parseInt(t.find(".condition-quantity").val()+""),category_label:t.find(".wc-product-search option:selected").text()}:{product_id:parseInt(t.find(".wc-product-search").val()+""),quantity:parseInt(t.find(".condition-quantity").val()+""),product_label:t.find(".wc-product-search option:selected").text()};n&&(o.discount_type=t.find("select.discount_type").val(),o.discount_value=t.find("input.discount_value").val().toString());return o}(e,i,o),r=s.category_id,u=s.product_id;d.push("category"==i?r:u),e.replaceWith(Bt(s,i,o)),n.data("exclude",d),n.find(".wc-product-search").data("exclude",d),Nt(!0)}}function Xt(){var t,e=Gt(this).closest("tr"),n=e.closest("table"),o=e.closest("tbody"),i=e.find("td").length,a=n.data("type"),c=e.find("td.object").data(a),d=n.data("exclude");if("category"===a)t=d.indexOf(parseInt(c.category_id));else t=d.indexOf(parseInt(c.product_id));-1!==t&&d.splice(t,1),n.data("exclude",d),n.find(".wc-product-search").data("exclude",d),e.remove(),o.find("tr").length<=0&&o.append(qt(i,a)),Nt(!0)}var Yt=function(){return Yt=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Yt.apply(this,arguments)},Zt=jQuery,$t=document.querySelector("#acfw_bogo_deals");function te(){var t=Zt(this),e=t.closest("#general_coupon_data"),n=e.find("p.form-field input");if("acfw_bogo"===t.val()){e.addClass("acfw-bogo-type"),Zt("#acfw_bogo_deals").show();for(var o=0;o<=n.length;o++)["expiry_date","_acfw_coupon_sort_priority","coupon_amount"].includes(Zt(n[o]).prop("name"))||Zt(n[o]).prop("disabled",!0)}else{e.removeClass("acfw-bogo-type"),Zt("#acfw_bogo_deals").hide();for(o=0;o<=n.length;o++)["expiry_date","_acfw_coupon_sort_priority","coupon_amount"].includes(Zt(n[o]).prop("name"))||Zt(n[o]).prop("disabled",!1)}}function ee(){Nt(!0)}function ne(){var t=jQuery(this);t.val()<1&&t.val(1)}acfw_edit_coupon=Yt(Yt({},acfw_edit_coupon),{bogo_toggle_editing_mode:Nt});var oe=jQuery;function ie(){var t=oe(this),e=t.closest(".toggle-enable-fields").find("select,textarea,input:not(.toggle-trigger-field)"),n=!t.prop("checked");e.prop("disabled",n),n?e.closest(".form-field").addClass("disabled"):e.closest(".form-field").removeClass("disabled")}var ae=jQuery,ce=!1;function de(){var t=acfw_edit_coupon.upsell.usage_limits;vex.dialog.alert({unsafeMessage:'<div class="upsell-alert usage-limits">'+t+"</div>"}),ae(this).val("none")}function le(){if(!ce){ce=!0;var t=acfw_edit_coupon.upsell.usage_restriction;vex.dialog.alert({unsafeMessage:'<div class="upsell-alert exclude-coupon">'+t+"</div>",afterClose:function(){return ce=!1}}),ae(this).val("")}}function se(){var t=acfw_edit_coupon.upsell.auto_apply;vex.dialog.alert({unsafeMessage:'<div class="upsell-alert auto-apply">'+t+"</div>"}),ae(this).prop("checked",!1)}function re(){var t=ae(this),e=t.closest("#acfw_cart_conditions"),n=t.closest(".add-condition-form"),o=e.data("premium-conditions"),i=e.find(".acfw-dyk-notice-holder"),a=n.find(".acfw-dyk-notice");a.length||(n.append(i.html()),a=n.find(".acfw-dyk-notice")),ae.inArray(t.val(),o)>=0?a.show():a.hide()}function ue(){"acfw_bogo"===ae(this).val()?ae("p.acfw-dyk-notice-general").hide():ae("p.acfw-dyk-notice-general").show()}function pe(t){var e,n,o,i=t.title,a=t.className,c=t.links;return acfw_edit_coupon.help_modal.is_premium&&(c=c.filter((function(t){return void 0===(null==t?void 0:t.freeOnly)||!(null==t?void 0:t.freeOnly)}))),'\n    <div class="links-list '+a+'">\n      <h3>'+i+"</h3>\n\n      "+((null==t?void 0:t.search)?(e=null==t?void 0:t.search,n=e.slug,o=e.action,'\n    <div class="search-widget search-'+n+'">\n      <input class="search-input" type="text" placeholder="'+e.placeholder+'" data-action="'+o+'" />\n      <button type="button" class="clear-search dashicons-before dashicons-no-alt"></button>\n      <div class="search-results"></div>\n    </div>\n  '):"")+"\n\n      <ul>\n        "+c.map((function(t){return"<li>"+function(t){var e=t.title,n=t.url;return'<a href="'+(acfw_edit_coupon.help_modal.is_premium&&(null==t?void 0:t.premiumUrl)?null==t?void 0:t.premiumUrl:n)+'">'+e+"</a>"}(t)+"</li>"})).join("")+"\n      </ul>\n    </div>\n  "}function fe(t){var e=acfw_edit_coupon.help_modal,n=e.labels,o=e.images_url,i=e.is_premium,a=t.target,c=t.left,d=c.title,l=c.content,s=c.videos,r=t.right,u=r.links,p=r.kbs,f=r.tutorials,_={slug:"kb-articles",action:"acfw_search_help_kb_articles",placeholder:n.search_placeholder};return'\n    <div class="header">\n      <div class="logo">\n        <a href="'+("https://advancedcouponsplugin.com/?utm_source="+(i?"acfwp":"acfwf")+"&utm_medium=help_modal&utm_campaign=help_brand_link_"+a)+'" target="_blank"><img src="'+o+'acfw-logo.png" alt="Advanced Coupons logo" /></a>\n      </div>\n      '+(i?"":'\n        <div class="upgrade-link">\n          <a href="'+("https://advancedcouponsplugin.com/pricing/?utm_source=acfwf&utm_medium=help_modal&utm_campaign=help_modal_"+a+"_upgrade_link")+'" target="_blank">\n            <span>'+n.upgrade_to_premium+'</span>\n            <i class="dashicons dashicons-external"></i>\n          </a>\n        </div>\n      ')+'\n    </div>\n    <main>\n      <h1 class="title">'+d+'</h1>\n      <div class="content">\n        '+l+"\n      </div>\n      "+(s.length?'<div class="video-gallery-placeholder"><img src="'+o+'spinner-2x.gif" alt="Loading videos" /><p>'+n.loading_videos+"</p></div>":"")+"\n    </main>\n    <aside>\n      "+pe({title:n.rel_links,className:"relevant-links",links:u})+"\n      "+pe({title:n.kb_articles,className:"knowledge-base-articles",links:p,search:_})+"\n      "+pe({title:n.tut_guides,className:"tutorials-guides",links:f})+"\n    </aside>\n  "}function _e(t){var e=acfw_edit_coupon.help_modal.images_url,n=acfw_edit_coupon.help_modal.labels;return'\n  <div id="acfw-help-modal-permission-request" data-module="'+t+'">\n    <img src="'+e+'acfw-logo.png" />\n    <p>'+n.permission_request+'</p>\n    <p class="actions">\n      <button class="button-primary allow" type="button">'+n.allow+'</button>\n      <button class="button cancel" type="button">'+n.cancel+"</button>\n    </p>\n  </div>\n  "}function ve(){var t=acfw_edit_coupon.help_modal;return'<div id="acfw-help-modal-placeholder">\n    <img src="'+t.images_url+'spinner-2x.gif" />\n    <p>'+t.labels.loading_content+"</p>\n  </div>"}function he(t){return'\n  <div class="no-video" style="background-image:url('+t.thumbnail+');">\n    <a href="'+t.url+'" rel="noreferer noopener" >\n      <span>'+acfw_edit_coupon.help_modal.labels.no_video+"</span>\n    </a>\n  </div>\n  "}var ge=jQuery,ye=[],be="";function me(t,e){var n=acfw_edit_coupon.help_modal._secure_nonce;t.length&&ge.post(ajaxurl,{action:"acfw_get_help_videos_oembed",urls:t.map((function(t){return t.url})),width:ge(".acfw-help-vex .vex-content main").width(),_nonce:n},(function(n){n=n.map((function(e){var n=t.findIndex((function(t){return t.url===e.url}));return e.title=n>=0?t[n].title:"",e})),ye=n,be=e,we(n)}),"json")}function we(t){var e=ge(".acfw-help-vex .video-gallery-placeholder");e.length&&e.replaceWith(function(t){return'\n  <div class="acfw-help-video-gallery">\n    <div class="videos">\n      '+(t[0].embed?t[0].embed:he(t[0]))+"\n    </div>\n    "+(t.length>1?'\n      <ul class="thumbnails">\n        '+t.map((function(t,e){return"\n            <li "+(0===e?'class="active"':"")+'>\n              <a href="javascript:void(0);" data-videoid="'+t.videoid+'">\n                <img src="'+t.thumbnail+'" title="'+t.title+'" />\n              </a>\n              <span class="title">'+t.title+"</span>\n            </li>\n            "})).join("")+"\n      </ul>\n      ":"")+"\n    \n  </div>\n  "}(t))}function xe(){var t=jQuery(this),e=t.closest("li"),n=t.closest(".acfw-help-video-gallery"),o=n.find(".videos"),i=n.find("ul.thumbnails li"),a=t.data("videoid");if(!e.hasClass("active")){i.removeClass("active"),e.addClass("active");var c=ye.findIndex((function(t){return t.videoid===a}));c>=0&&o.html(ye[c].embed?ye[c].embed.replace("oembed","oembed&autoplay=1"):he(ye[c]))}}var qe=jQuery,ke=[];function je(){var t=acfw_edit_coupon.help_modal.allow_fetch,e=qe(this).closest(".acfw-help-link").data("module");vex.dialog.open({unsafeMessage:'\n      <a class="vex-close" href="javascript:void(0);"></a>\n      '+(t?ve():_e(e))+"\n    ",className:"vex-theme-plain acfw-help-vex",showCloseButton:!1,buttons:{}}),t&&Oe(e)}function Se(t){var e=qe("#acfw-help-modal-placeholder");e.length&&(e.replaceWith(t),qe(".acfw-help-vex").find("main a,aside a").attr("target","_blank").attr("rel","noopener noreferrer nofollow"))}function Oe(t){var e,n=acfw_edit_coupon.help_modal._secure_nonce;if(e=function(t){var e=ke.findIndex((function(e){return e.target===t}));return e>=0?ke[e]:null}(t))return Se(fe(e)),void function(t,e){ye.length&&e===be?we(ye):me(t,e)}(e.left.videos,t);qe.post(ajaxurl,{action:"acfw_fetch_help_data",module:t,_nonce:n},(function(e){ke.push(e),Se(fe(e)),me(e.left.videos,t)}),"json").fail((function(t){Se('\n    <div class="acfw-help-modal-error">\n      <p>'+t.responseJSON.errorMsg+"</p>\n    </div>\n  ")}))}var Ce=jQuery,Qe=null,Ne=null;function Ie(){var t=Ce(this).closest(".search-widget"),e=t.find("input.search-input"),n=t.find(".search-results"),o=acfw_edit_coupon.help_modal,i=o.labels,a=o.images_url,c=o._secure_nonce,d=e.val();if(!d)return clearTimeout(Qe),Qe=null,n.height(0).html(""),void t.removeClass("show-clear");t.addClass("show-clear"),function(t,e,n){Qe&&(clearTimeout(Qe),Qe=null);if(t.term===(null==Ne?void 0:Ne.term))return void n(Ne.results);Qe=setTimeout((function(){e(),Ce.post(ajaxurl,t,n,"json")}),1e3)}({action:e.data("action"),term:e.val(),_nonce:c},(function(){n.height(35).html('<div class="loading"><img src="'+a+'spinner.gif" /></div>')}),(function(e){t.hasClass("show-clear")&&(e.length?(Ne={term:d,results:e},n.html(function(t,e){var n=t.map((function(t){var n=t.url,o=t.title;return'<li><a href="'+function(t,e){return t+"?utm_source=acfwf&utm_medium=help_modal&utm_campaign=kb_search&utm_term="+e}(n,e)+'" rel="noopener noreferrer nofollow" target="_blank">'+o+"</a></li>"})).join("");return"<ul>"+n+"</ul>"}(e,d))):n.html('<div class="no-result">'+i.search_no_results+"</div>"),n.height(n.find("ul,.no-result").height()+3))}))}function Je(){var t=Ce(this).closest(".search-widget"),e=t.find("input.search-input"),n=t.find(".search-results");clearTimeout(Qe),Qe=null,e.val(""),n.height(0).html(""),t.removeClass("show-clear")}var Pe=jQuery;function Ae(){var t=acfw_edit_coupon.help_modal._secure_nonce,e=jQuery(this).closest("#acfw-help-modal-permission-request"),n=e.data("module");e.replaceWith(ve()),Pe.post(ajaxurl,{action:"acfw_save_fetch_help_permission",_nonce:t},(function(){Oe(n),acfw_edit_coupon.help_modal.allow_fetch=!0}),"json")}function Te(){vex.closeAll()}var We=jQuery;var Ee=acfw_edit_coupon.modules,Me=acfw_edit_coupon.upsell;jQuery(document).ready((function(t){var e,n,d,l,r;Ee.indexOf("acfw_cart_conditions_module")>-1&&(ht(gt).on("click","#add-cart-condition-group",b),ht(gt).on("click","a.remove-condition-group",m),ht(gt).on("click",".add-condition-field",W),ht(gt).on("click","a.remove-condition-field",E),ht(gt).on("click",".add-condition-trigger",o),ht(gt).on("click",".cancel-add-condition-field",o),ht(gt).on("click",".acfw-styled-table tfoot .add-table-row",Z),ht(gt).on("click",".acfw-styled-table td.actions a.edit",$),ht(gt).on("click","tr.add-edit-form .actions .condition-product-add",tt),ht(gt).on("click","tr.add-edit-form .actions .cancel",et),ht(gt).on("click",".acfw-styled-table td.actions a.remove",nt),ht(gt).on("click","#save-cart-conditions",G),ht(gt).on("change","input[type='number']",ct),ht(gt).on("change","select.condition-select",dt),ht(gt).on("change","select.has-ordered-before-type",lt),ht(gt).on("change",".wc_input_price",st),ht(gt).on("change","select.custom-taxonomy",a),ht(gt).on("change",".shipping-zone-region-field select.condition-select",c),ht(gt).on("blur",".wc_input_price",rt),ht(gt).on("change","select.value-type",ut),ht("form#post").on("submit",H),ht(gt).find("select").trigger("change"),ht(gt).css("min-height",ht("#coupon_options").height()),ht(gt).on("change","input,select,textarea",(function(){i(!0)})),ht(gt).find(".condition-groups").each((function(){ht(this).find(".condition-group-fields").length&&ht(this).show()})),ht(".acfw-cart-condition-tabs").on("click","li a",ft),setTimeout(yt,500)),Ee.indexOf("acfw_bogo_deals_module")>-1&&(Zt($t).on("click",".acfw-styled-table tfoot .add-table-row",Ht),Zt($t).on("click",".acfw-styled-table td.actions a.edit",Kt),Zt($t).on("click","tr.add-edit-form .actions .cancel",Rt),Zt($t).on("click","tr.add-edit-form .actions .condition-product-add",Vt),Zt($t).on("click",".acfw-styled-table td.actions a.remove",Xt),Zt($t).on("click","button#save-bogo-deals",Wt),Zt($t).on("click","button#clear-bogo-deals",Mt),Zt($t).on("change acfw_load","select#bogo-condition-type,select#bogo-deals-type",It),Zt($t).on("change acfw_fetch_data",".combined-products-form select,.combined-products-form input",Dt),Zt($t).on("change acfw_fetch_data",".any-products-trigger-form input",zt),Zt($t).on("change acfw_fetch_data",".any-products-apply-form input,.any-products-apply-form select",Lt),Zt($t).on("change",".condition-quantity",ne),Zt($t).on("blur",".wc_input_price",s),Zt($t).css("min-height",Zt("#coupon_options").height()),Zt($t).on("change","input[name='bogo_type']",ee),Zt($t).on("click",".acfw-styled-table .actions .remove",ee),Zt($t).find(".notice-option").on("change","input,textarea,select",ee),Zt("form#post").on("submit",Ft),Zt($t).find("select#bogo-condition-type,select#bogo-deals-type").trigger("acfw_load"),Zt("#woocommerce-coupon-data").on("change acfw_load","select#discount_type",te),Zt("#woocommerce-coupon-data select#discount_type").trigger("acfw_load")),Me&&(ae("#usage_limit_coupon_data").on("change","#reset_usage_limit_period",de),ae("#usage_restriction_coupon_data .exclude_coupon_ids_field").on("click change focus","input,select",le),ae("#acfw-auto-apply-coupon").on("change","#acfw_auto_apply_coupon_field",se),ae("#acfw_cart_conditions").on("change",".condition-types",re),ae("#woocommerce-coupon-data").on("change acfw_load","#discount_type",ue),ae("#woocommerce-coupon-data #discount_type").trigger("acfw_load")),(e=oe(".toggle-enable-fields")).on("change",".toggle-trigger-field",ie),e.find(".toggle-trigger-field").trigger("change"),n=document.querySelectorAll("#post-body .acfw-help-link"),d=acfw_edit_coupon.help_modal,l=d.help_text,r=d.images_url,n.forEach((function(t){var e='\n      <a class="acfw-help-modal-trigger" href="javascript:void(0);">'+l+' \n        <img class="acfw-icon" src="'+r+'help-icon.svg" alt="'+l+'" />\n      </a>\n    ';We(t).html(e)})),We("#post-body").on("click",".acfw-help-modal-trigger",je),We("body").on("click",".acfw-help-vex .vex-close",(function(){return vex.closeAll()})),We("body").on("click",".acfw-help-vex .acfw-help-video-gallery ul.thumbnails li a",xe),We("body").on("keyup",".acfw-help-vex .search-widget input.search-input",Ie),We("body").on("click",".acfw-help-vex .search-widget button.clear-search",Je),We("body").on("click",".acfw-help-vex #acfw-help-modal-permission-request button.allow",Ae),We("body").on("click",".acfw-help-vex #acfw-help-modal-permission-request button.cancel",Te)}))})();
//# sourceMappingURL=edit-advanced-coupon.js.map