(()=>{"use strict";function t(){var t=acfw_edit_coupon.cart_condition_fields,n=acfw_edit_coupon.cart_condition_field_groups,o=acfw_edit_coupon.product_table_buttons,e=acfw_edit_coupon.add_new_and_rule,c=Object.keys(t).map((function(n){return t[n]}));return'\n    <div class="condition-group-actions">\n      <div class="add-condition-form" style="display: none;">\n        <select class="condition-types" data-placeholder="Search/select condition fields">\n          <option value="">Search</option>\n          '.concat(n.map((function(t){return function(t,n){var o=t.group,e=t.label,c=n.filter((function(t){return t.group===o||"others"===o&&void 0===t.group}));if(!c.length)return;return'\n    <optgroup label="'.concat(e,'">\n      ').concat(c.map((function(t){return'<option value="'.concat(t.key,'">').concat(t.title,"</option>")})).join(""),"\n    </optgroup>\n  ")}(t,c)})).join(""),'\n        </select>\n        <button type="button" class="add-condition-field button-primary">').concat(o.add,'</button>\n        <button type="button" class="cancel-add-condition-field button">').concat(o.cancel,'</button>\n      </div>\n      <button type="button" class="add-condition-trigger button">\n        <i class="dashicons dashicons-plus"></i>\n        ').concat(e,"\n      </button>\n    </div>\n  ")}var n=jQuery,o=document.querySelector("#acfw_cart_conditions");function e(){var t=n(this),o=t.closest("div.condition-group-actions");t.hasClass("add-condition-trigger")?(o.find(".add-condition-form").show(),jQuery("select.condition-types").select2(),t.hide()):(o.find(".add-condition-form").hide(),o.find(".add-condition-trigger").show())}function c(t){n(o).data("editing",t),n(o).find("#save-cart-conditions").prop("disabled",!t)}function a(){var t=n(this),e=t.closest(".condition-field"),c=e.find("select.condition-value"),a=t.val()+"",i=e.data("selected_terms"),d=n(o).data("custom_tax_options").filter((function(t){return t.slug==a})),l=d.length?d[0].terms:[];if(c.val(null).find("option").remove(),l.length){for(var s=0,r=l;s<r.length;s++){var u=r[s],p=u.name,f=u.term_id,_=new Option(p,f);c.append(_)}c.val(i).trigger("change")}}function i(){var t=n(this),e=t.closest(".condition-field"),c=e.find("select.condition-value"),a=t.val()+"";if(a){var i=e.data("regions"),d=n(o).data("shipping_regions"),l=e.data("zones")[a].regions;if(c.val(null).find("option").remove(),"object"==typeof l&&l.length){for(var s=0,r=l;s<r.length;s++){var u=r[s],p=new Option(d[u],u);c.append(p)}c.val(i).trigger("change")}}}function d(t,n){void 0===n&&(n=""),n||(n="show");var o="show"===n?"block":"none";jQuery(t).css("display",o)}function l(t){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039"};return t.replace(/[&<>"']/g,(function(t){return n[t]}))}function s(){var t=acfw_edit_coupon.decimal_separator,n=jQuery(this),o=n.val()+"";o=="0"+t&&n.val("0"),"0"!=o&&o.substring(0,2)!="0"+t&&(o=(o=o.replace(/^0+/,"")).substring(0,1)==t?"0"+o:o,n.val(o))}function r(t){return"<"==t?1:0}function u(t,n){return t==n?"selected":""}function p(t,n){return t.indexOf(n)>=0?"selected":""}function f(t){void 0===t&&(t="");var n=acfw_edit_coupon.condition_field_options,o=n.exactly,e=n.anyexcept,c=n.morethan,a=n.lessthan;return'\n        <option value="=" '.concat(u(t,"="),">").concat(o,'</option>\n        <option value="!=" ').concat(u(t,"!="),">").concat(e,'</option>\n        <option value=">" ').concat(u(t,">"),">").concat(c,'</option>\n        <option value="<" ').concat(u(t,"<"),">").concat(a,"</option>\n    ")}function _(t){var n=acfw_edit_coupon.decimal_separator;return parseFloat(t.replace(n,"."))}function v(t,n){return"percent"!==t&&"fixed"!==t||0<_(n)}function h(t){void 0===t&&(t="");var n=acfw_edit_coupon.logic_field_options,o=n.and,e=n.or;return'\n        <div class="condition-group-logic">\n            <div class="field-control">\n                <select class="cgroup-logic">\n                    <option value="and" '.concat(u(t,"and"),">").concat(o,'</option>\n                    <option value="or" ').concat(u(t,"or"),">").concat(e,"</option>\n                </select>\n            </div>\n        </div>\n    ")}function g(n){void 0===n&&(n="");var o=acfw_edit_coupon.empty_cart_conditions_field,e=t(),c='<div class="empty-conditions">'.concat(o,"</div>");return'\n        <div class="condition-group '.concat(n?"":"new",'">\n            <a class="remove-condition-group" href="javascript:void(0);">\n                <i class="dashicons dashicons-trash"></i>\n            </a>\n            <div class="condition-group-fields">\n                ').concat(n||c,"\n            </div>\n            ").concat(e,"\n        </div>\n    ")}var y=jQuery;function b(){var t=document.querySelector("#acfw_cart_conditions .condition-data-wrap .condition-groups");y(t).find(".condition-group").length&&y(t).append(h("or")),y(t).find(".no-condition-group").remove(),y(t).append(g()),y(this).blur(),y(t).find(".condition-group.new .add-condition-trigger").trigger("click"),y(t).find(".condition-group").removeClass("new"),c(!0)}function m(){var t=y(this),n=document.querySelector("#acfw_cart_conditions"),o=t.closest(".condition-group"),e=0==o.index()?o.next(".condition-group-logic"):o.prev(".condition-group-logic"),a=acfw_edit_coupon.no_condition_group_msg;o.remove(),e.remove(),y(n).find(".condition-group").length<1&&y(n).find(".condition-groups").append('\n            <div class="no-condition-group">\n                '.concat(a,"\n            </div>\n        ")),c(!0)}function w(t){void 0===t&&(t="");var n=acfw_edit_coupon.logic_field_options,o=n.and,e=n.or;return'<div class="logic-condition-field condition-field" data-type="logic">\n        <div class="field-control">\n            <select class="condition-logic">\n                <option value="and" '.concat(u(t,"and"),">").concat(o,'</option>\n                <option value="or" ').concat(u(t,"or"),">").concat(e,"</option>\n            </select>\n        </div>\n    </div>")}var x=acfw_edit_coupon.cart_condition_fields,q=acfw_edit_coupon.condition_field_options;function k(t){var n=t.value,o=t.condition,e=t.quantity,c=x.product_category,a=c.title,i=c.placeholder,d=c.field,l=x.cart_quantity.field,s=acfw_edit_coupon.condition_label,r=q.exactly,u=q.anyexcept,f=q.morethan,_=q.lessthan,v=o||">";return'\n    <div class="product-category-field condition-field" data-type="product-category">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(a,'</h3>\n        <div class="field-control categories">\n            <label>').concat(d,'</label>\n            <select class="condition-value wc-enhanced-select" multiple data-placeholder="').concat(i,'">\n                ').concat(function(t){void 0===t&&(t=[]);var n=x.product_category.options,o="";for(var e in n)o+='<option value="'.concat(e,'" ').concat(p(t,e),">").concat(n[e],"</option>");return o}(n),'\n            </select>\n        </div>\n        <div class="field-control condition">\n            <label>').concat(s,'</label>\n            <select class="condition-select">\n                <option value="=" ').concat("="==v?"selected":"",">").concat(r,'</option>\n                <option value="!=" ').concat("!="==v?"selected":"",">").concat(u,'</option>\n                <option value=">" ').concat(">"==v?"selected":"",">").concat(f,'</option>\n                <option value="<" ').concat("<"==v?"selected":"",">").concat(_,'</option>\n            </select>\n        </div>\n        <div class="field-control quantity">\n            <label>').concat(l,'</label>\n            <input type="number" class="condition-quantity" value="').concat(e,'" min="').concat("<"==o?1:0,'">\n        </div>\n    </div>\n    ')}var j=acfw_edit_coupon.cart_condition_fields;function S(t){var n=j.customer_logged_in_status.title;return'\n        <div class="customer-logged-in-status-field condition-field" data-type="customer-logged-in-status">\n\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n\n        <h3 class="condition-field-title">'.concat(n,'</h3>\n\n        <div class="field-control">\n            <select class="condition-value">\n                ').concat(function(t){var n=j.customer_logged_in_status.options,o="";for(var e in n)o+='<option value="'.concat(e,'" ').concat(u(e,t),">").concat(n[e],"</option>");return o}(t),"\n            </select>\n        </div>\n    </div>")}var O=acfw_edit_coupon.cart_condition_fields;function C(t){var n=O.customer_user_role,o=n.title,e=n.placeholder;return'\n        <div class="customer-user-role-field condition-field" data-type="customer-user-role">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'.concat(o,'</h3>\n            <div class="field-control">\n                <select class="wc-enhanced-select condition-value" multiple data-placeholder="').concat(e,'">\n                    ').concat(function(t){var n=acfw_edit_coupon.user_role_options,o="";for(var e in n)o+='<option value="'.concat(e,'" ').concat(p(t,e),">").concat(n[e],"</option>");return o}(t),"\n                </select>\n            </div>\n        </div>\n    ")}var Q=acfw_edit_coupon.cart_condition_fields;function N(t){var n=Q.disallowed_customer_user_role,o=n.title,e=n.placeholder;return'\n        <div class="disallowed-customer-user-role-field condition-field" data-type="disallowed-customer-user-role">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'.concat(o,'</h3>\n            <div class="field-control">\n                <select class="wc-enhanced-select condition-value" multiple data-placeholder="').concat(e,'">\n                    ').concat(function(t){var n=acfw_edit_coupon.user_role_options,o="";for(var e in n)o+='<option value="'.concat(e,'" ').concat(p(t,e),">").concat(n[e],"</option>");return o}(t),"\n                </select>\n            </div>\n        </div>\n    ")}var I=acfw_edit_coupon.cart_condition_fields;var J=jQuery,P=acfw_edit_coupon.cart_condition_fields,A=acfw_edit_coupon.premium_cart_condition_fields,T=acfw_edit_coupon.upsell;function W(){var t=J(this),n=t.closest(".condition-group-actions").find("select.condition-types"),o=t.closest(".condition-group"),e=o.find(".condition-group-fields"),a=document.querySelector("#acfw_cart_conditions .acfw-overlay"),i=n.val()+"",l=e.find(".condition-field,.condition-set").length;if(d(a,"show"),A&&A.indexOf(i)>-1)vex.dialog.alert({unsafeMessage:T.cart_condition_field});else{var s=E(i,null,l);s?(e.find(".empty-conditions").remove(),e.show().append(s),e.find(".".concat(i,"-field")).find("input,select").trigger("change"),J("body").trigger("wc-enhanced-select-init"),c(!0)):vex.dialog.alert(acfw_edit_coupon.fail_add_condition_field)}d(a,"hide"),o.find(".condition-group-actions .add-condition-form").hide(),o.find(".condition-group-actions .add-condition-trigger").show()}function M(){var t=J(this).closest(".condition-field,.condition-set"),n=t.closest(".condition-group"),o=0==t.index()?t.next(".logic-condition-field"):t.prev(".logic-condition-field"),e=acfw_edit_coupon.empty_cart_conditions_field;t.remove(),o.remove(),n.find(".condition-field,.condition-set").length<1&&n.find(".condition-group-fields").append('\n            <div class="empty-conditions">\n                '.concat(e,"\n            </div>\n        ")),c(!0)}function E(t,n,o){void 0===n&&(n=null),void 0===o&&(o=0);var e="";switch(t){case"product-category":(n=n||{}).length&&(n={condition:">",value:n,quantity:0}),e+=k(n);break;case"customer-logged-in-status":e+=S(n);break;case"customer-user-role":e+=C(n=n||[]);break;case"disallowed-customer-user-role":e+=N(n=n||[]);break;case"cart-quantity":e+=function(t){var n=t.condition,o=t.value,e=I.cart_quantity,c=e.title,a=e.desc,i=e.field,d=acfw_edit_coupon.condition_label;return'\n    <div class="cart-quantity-field condition-field" data-type="cart-quantity">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(c,"</h3>\n        <label>").concat(a,'</label>\n        <div class="field-control">\n            <label>').concat(d,'</label>\n            <select class="condition-select">\n                ').concat(f(n),'\n            </select>\n        </div>\n        <div class="field-control">\n            <label>').concat(i,'</label>\n            <input class="condition-value" type="number" min="0" value="').concat(o>=0?o:"",'">\n        </div>\n    </div>\n    ')}(n=n||{});break;case"cart-subtotal":e+=function(t){var n=t.condition,o=t.value,e=acfw_edit_coupon.cart_condition_fields,c=acfw_edit_coupon.condition_label,a=e.cart_subtotal,i=a.title,d=a.desc,l=a.field;return'\n    <div class="cart-subtotal-field condition-field" data-type="cart-subtotal">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(i,"</h3>\n        <label>").concat(d,'</label>\n        <div class="field-control">\n            <label>').concat(c,'</label>\n            <select class="condition-select">\n                ').concat(f(n),'\n            </select>\n        </div>\n        <div class="field-control">\n            <label>').concat(l,'</label>\n            <input class="condition-value wc_input_price" type="text" value="').concat(o||"",'">\n        </div>\n    </div>\n    ')}(n=n||{});break;default:var c=t.replace(/-/g,"_");if(P[c]){var a=P[c],i=a.template_callback,d=a.default_data_value;d&&(n=n||d),i&&(e+=i(n,c))}}return e&&o?w()+e:e}function D(t){return acfw_edit_coupon.cart_conditon_field_options.indexOf(t)>-1}var F=jQuery,z=acfw_edit_coupon.cart_condition_fields;function L(t){var n=t.querySelectorAll(".condition-set,.condition-field"),o=[];return t.classList.contains("condition-group-logic")?{type:"group_logic",value:t.querySelector("select").value}:(n.forEach((function(t){return o.push(function(t){var n,o,e,c=t.dataset.type,a={type:c,data:null};switch(c){case"logic":n=t.querySelector("select.condition-logic"),a.data=n.value;break;case"product-category":n=t.querySelector(".condition-value"),o=t.querySelector(".condition-select"),e=t.querySelector(".condition-quantity"),a.data={condition:F(o).val(),value:F(n).val(),quantity:F(e).val()};break;case"customer-logged-in-status":case"customer-user-role":case"disallowed-customer-user-role":n=t.querySelector(".condition-value"),a.data=F(n).val();break;case"cart-quantity":case"cart-subtotal":n=t.querySelector(".condition-select"),o=t.querySelector(".condition-value"),a.data={condition:F(n).val(),value:"cart-subtotal"==c?F(o).val():parseInt(F(o).val())};break;default:var i=c.replace(/-/g,"_");if(z[i]){var d=z[i].scraper_callback;a.data=d(t)}}return a}(t))})),o.length?{type:"group",fields:o}:null)}var U=jQuery,B=woocommerce_admin_meta_boxes.post_id;function G(){var t=document.querySelector("#acfw_cart_conditions"),n=t.querySelectorAll(".condition-groups .condition-group, .condition-groups .condition-group-logic"),o=t.querySelector(".acfw-overlay"),e=acfw_edit_coupon.post_status,a=woocommerce_admin_meta_boxes.post_id,i=[];if(U(t).find(".acfw-styled-table tr.add-edit-form button.cancel").trigger("click"),n.forEach((function(t){var n=L(t);n&&i.push(n)})),!function(t){var n,o,e,c,a,i,d,l,s;if(1===t.length&&(null===(n=t[0].fields)||void 0===n?void 0:n.length)<1)return!0;for(var u="",p=0,f=t;p<f.length;p++)if("group_logic"!==(o=f[p]).type){if(u=o.type,void 0===o.fields||o.fields.length<1)return!1;for(var _=0,v=o.fields;_<v.length;_++){if(a=(e=v[_]).type,void 0===(c=e.data)||""===c||null===c)return!1;if("object"==typeof c&&"number"==typeof c.length?i=c:"product-category"===a?(i=c.value,d=c.condition,l=c.quantity):"object"==typeof c&&void 0===c.length?(i=c.products,d=c.condition,l=c.value):l=c,s=r(d),void 0!==i&&i.length<1||void 0!==d&&!d||!Number.isInteger(l)&&void 0!==l&&!l||Number.isInteger(l)&&l<s||"number"==typeof l&&l<s)return!1}}else{if(!u||"group_logic"===u)return!1;u="group_logic"}return!0}(i))return vex.dialog.alert(acfw_edit_coupon.cart_conditions_invalid),void U(t).addClass("save-error");var l={message:U(t).find(".text-input.non-qualifying-message-field").val(),btn_text:U(t).find(".text-input.non-qualifying-btn-text-field").val(),btn_url:U(t).find(".text-input.non-qualifying-btn-url-field").val()},s=U(t).find(".display-notice-auto-apply-field").is(":checked")?"yes":"";if(l.btn_url&&!/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(l.btn_url))return vex.dialog.alert(acfw_edit_coupon.cart_notice_url_invalid),void U(t).addClass("save-error");d(o,"show"),K({cart_conditions:i,notice_settings:l,auto_apply_display:s},(function(n){"success"==n.status?"publish"!==e&&(U("input[name='post_title']").val()||U("input[name='post_title']").val("coupon-"+a),U("select[name='post_status']").append(new Option("Published","publish")).val("publish"),U("#publishing-action").append('\n                    <input type="hidden" name="publish" value="Publish">\n                '),U("input#publish").click()):n.error_msg&&vex.dialog.alert(n.error_msg),c(!1),U(t).find("#save-cart-conditions").prop("disabled",!0),d(o,"hide")}))}function H(t){var n=document.querySelector("#acfw_cart_conditions");U(n).data("editing")&&(t.preventDefault(),U(n).find("#save-cart-conditions").trigger("click"),setTimeout((function(){U(n).hasClass("save-error")?U(n).removeClass("save-error"):U("form#post").submit()}),1e3))}function K(t,n){return t.action="acfw_save_cart_conditions",t.coupon_id=B,U.post(ajaxurl,t,n,"json")}var R=jQuery,V=acfw_edit_coupon.product_table_buttons,X=acfw_edit_coupon.condition_field_options,Y=acfw_edit_coupon.bogo_form_fields;function Z(){var t=R(this).closest(".acfw-styled-table"),n=t.find("tbody"),o=t.data("exclude");n.find("tr.no-result").remove(),n.append(ct(o)),R("body").trigger("wc-enhanced-select-init")}function $(){var t=R(this),n=t.closest("tr"),o=t.closest("table"),e=n.closest("tbody"),c=n.find("td.product").data("product"),a=o.data("exclude");a.splice(a.indexOf(c.product_id),1),e.find("tr.no-result").remove(),n.replaceWith(ct(a,c)),o.data("exclude",a),o.find(".wc-product-search").data("exclude",a),R("body").trigger("wc-enhanced-select-init")}function tt(){var t=R(this),n=t.closest("tr"),o=t.closest("table.acfw-styled-table"),e=n.find(".wc-product-search"),a=n.find(".condition-select"),i=n.find(".condition-quantity"),d="<"===a.val()?1:0,s=o.data("exclude");if(e.val()&&a.val()&&i.val()&&!(i.val()<d)){var r=parseInt(e.val().toString());if(s.includes(r))vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);else{var u={product_id:r,condition:a.val(),quantity:parseInt(i.val()+""),product_label:e.find("option:selected").text(),condition_label:a.find("option:selected").text()},p='\n        <tr>\n            <td class="product" data-product="'.concat(l(JSON.stringify(u)),'">').concat(u.product_label,'</td>\n            <td class="condition">').concat(u.condition_label,'</td>\n            <td class="quantity">').concat(u.quantity,'</td>\n            <td class="actions">\n                <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n                <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n            </td>\n        </tr>\n    ');s.push(u.product_id),n.replaceWith(p),o.data("exclude",s),o.find(".wc-product-search").data("exclude",s),c(!0)}}else vex.dialog.alert(acfw_edit_coupon.fill_form_propery_error_msg)}function nt(){var t=jQuery(this),n=t.closest("tr"),o=t.closest("table"),e=n.closest("tbody"),c=n.find("td.product").data("product"),a=n.find("td").length,i=o.data("exclude");if(i.includes(c.product_id))vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);else if("object"==typeof c){var d=c.product_id,s=c.product_label,r=c.condition_label,u=c.quantity,p='\n            <tr>\n                <td class="product" data-product="'.concat(l(JSON.stringify(c)),'">').concat(s,'</td>\n                <td class="condition">').concat(r,'</td>\n                <td class="quantity">').concat(u,'</td>\n                <td class="actions">\n                    <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n                    <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n                </td>\n            </tr>\n        ');i.push(d),n.replaceWith(p),o.data("exclude",i),o.find(".wc-product-search").data("exclude",i)}else n.remove(),et(e,a)}function ot(){var t=jQuery(this).closest("tr"),n=t.closest("table"),o=n.find("tbody"),e=t.find("td").length;t.remove();var a=t.find("td.product").data("product"),i=n.data("exclude"),d=i.indexOf(parseInt(a.product_id));-1!==d&&i.splice(d,1),n.data("exclude",i),n.find(".wc-product-search").data("exclude",i),et(o,e),c(!0)}function et(t,n){void 0===n&&(n=3),t.find("tr").length>0||t.append('\n        <tr class="no-result">\n            <td colspan="'.concat(n,'">').concat(acfw_edit_coupon.no_products_added,"</td>\n        </tr>\n    "))}function ct(t,n){void 0===t&&(t=[]),void 0===n&&(n=!1);var o="",e="";if("object"==typeof n){var c=n.product_id,a=n.product_label;o='<option value="'.concat(c,'">').concat(a,"</option>"),e=n.condition}var i=V.add,d=V.edit,s=V.cancel,r=X.exactly,u=X.anyexcept,p=X.morethan,f=X.lessthan,_=Y.type_to_search,v="object"==typeof n?d:i;return'\n        <tr class="add-edit-form adding">\n            <td class="product" data-product="'.concat("object"==typeof n?l(JSON.stringify(n)):0,'">\n                <div class="object-search-wrap">\n                    <select class="product-in-cart wc-product-search"\n                        data-placeholder="').concat(_,'"\n                        data-action="acfw_search_products"\n                        data-exclude="').concat(l(JSON.stringify(t)),'">').concat(o,'</select>\n                </div>\n            </td>\n            <td class="condition">\n                <select class="condition-select">\n                    <option value="=" ').concat("="==e?"selected":"",">").concat(r,'</option>\n                    <option value="!=" ').concat("!="==e?"selected":"",">").concat(u,'</option>\n                    <option value=">" ').concat(">"==e?"selected":"",">").concat(p,'</option>\n                    <option value="<" ').concat("<"==e?"selected":"",">").concat(f,'</option>\n                </select>\n            </td>\n            <td class="quantity">\n                <input type="number" class="condition-quantity" value="').concat("object"==typeof n?n.quantity:1,'" min="').concat("<"==e?1:0,'">\n            </td>\n            <td class="actions">\n                <button type="button" class="condition-product-add button-primary">').concat(v,'</button>\n                <button type="button" class="cancel button">').concat(s,"</button>\n            </td>\n        </tr>\n        ")}var at=jQuery;function it(){var t=at(this),n=parseInt(t.attr("min"));parseFloat(t.val()+"")<n&&t.val(n)}function dt(){var t=at(this),n=t.closest(".condition-field,.condition-set"),o=n.data("type"),e="product-quantity"==o||"has-ordered-before"==o||"product-category"==o?"input.condition-quantity":"input.condition-value",c=n.find(e),a=r(t.val()+"");c.attr("min",a).trigger("change")}function lt(){var t=acfw_edit_coupon.within_a_period_label,n=acfw_edit_coupon.number_of_orders_label,o=at(this),e=o.closest(".cart-quantity-field").find(".condition-type-value label");"within-a-period"==o.val()?e.text(t):e.text(n)}function st(){var t=at(this),n=t.closest(".condition-field").find("select.condition-select"),o=n.val()+"",e=t.val()+"",c=r(o);"."!==acfw_edit_coupon.decimal_separator&&(e=e.replace(acfw_edit_coupon.decimal_separator,".")),!n||parseFloat(e)>c-1||t.val(c)}function rt(){var t=at(this),n=t.val();n=="0"+acfw_edit_coupon.decimal_separator&&t.val("0"),"0"!=n&&n.substring(0,2)!="0"+acfw_edit_coupon.decimal_separator&&(n=(n=n.replace(/^0+/,"")).substring(0,1)==acfw_edit_coupon.decimal_separator?"0"+n:n,t.val(n))}function ut(){var t=at(this),n=t.closest(".condition-field"),o=n.find("select.condition-select"),e=n.find("input.condition-value");switch(t.val()){case"string":e.prop("type","text"),e.removeClass("wc_input_price"),">"!=o.val()&&"<"!=o.val()||o.val("="),o.find("option[value='>'],option[value='<']").prop("disabled",!0);break;case"number":e.prop("type","number"),e.removeClass("wc_input_price"),o.find("option[value='>'],option[value='<']").prop("disabled",!1);break;case"price":e.prop("type","text"),e.addClass("wc_input_price"),o.find("option[value='>'],option[value='<']").prop("disabled",!1)}o.trigger("change")}var pt=jQuery;function ft(){var t=pt(this),n=t.closest(".woocommerce").find("#acfw_cart_conditions"),o=t.data("tab");n.find(".panel").hide(),n.find('.panel[data-tab="'.concat(o,'"]')).show(),function(t){pt(".acfw-cart-condition-tabs li").removeClass("active"),t.closest("li").addClass("active")}(t)}var _t=function(t,n,o,e){return new(o||(o=Promise))((function(c,a){function i(t){try{l(e.next(t))}catch(t){a(t)}}function d(t){try{l(e.throw(t))}catch(t){a(t)}}function l(t){var n;t.done?c(t.value):(n=t.value,n instanceof o?n:new o((function(t){t(n)}))).then(i,d)}l((e=e.apply(t,n||[])).next())}))},vt=function(t,n){var o,e,c,a,i={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return a={next:d(0),throw:d(1),return:d(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function d(a){return function(d){return function(a){if(o)throw new TypeError("Generator is already executing.");for(;i;)try{if(o=1,e&&(c=2&a[0]?e.return:a[0]?e.throw||((c=e.return)&&c.call(e),0):e.next)&&!(c=c.call(e,a[1])).done)return c;switch(e=0,c&&(a=[2&a[0],c.value]),a[0]){case 0:case 1:c=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,e=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(c=i.trys,(c=c.length>0&&c[c.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!c||a[1]>c[0]&&a[1]<c[3])){i.label=a[1];break}if(6===a[0]&&i.label<c[1]){i.label=c[1],c=a;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(a);break}c[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(t,i)}catch(t){a=[6,t],e=0}finally{o=c=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,d])}}},ht=jQuery,gt=document.querySelector("#acfw_cart_conditions");function yt(){var t=this,n=gt.querySelector(".condition-groups"),o=ht(gt).data("cart_conditions");_t(t,void 0,void 0,(function(){var t,e,c,a,i;return vt(this,(function(d){if(t="",o.length)for(e=0,c=o;e<c.length;e++)"group"==(a=c[e]).type?(i=bt(a.fields),t+=g(i)):t+=h(a.value);else t=g();return ht(n).html(t),ht(n).find("input,select").trigger("change"),ht(n).find(".condition-group.new .add-condition-trigger").trigger("click"),ht(n).find(".condition-group").removeClass("new"),[2]}))})).then((function(){setTimeout((function(){return ht("body").trigger("wc-enhanced-select-init")}),1500),c(!1)}))}function bt(t){for(var n="",o="",e=!0,c=0,a=t;c<a.length;c++){var i=a[c],d=i.type,l=i.data;if(D(d))if("logic"!=d){var s=E(d,l);s?(n+=o+s,e=!0):e=!1,o=""}else o=e?w(l):"";else e=!1}return n}function mt(){var t=acfw_edit_coupon.upsell;return t?'\n    <div class="upsell">\n        '.concat(t.bogo_deals_type,"\n    </div>"):""}function wt(t,n){void 0===n&&(n=!1);var o=t.products,e=t.quantity,c=t.discount_type,a=t.discount_value,i=acfw_edit_coupon.bogo_form_fields,d=acfw_edit_coupon.bogo_instructions,s=i.quantity,r=i.products,u=i.price_discount,p=i.type_to_search,f=c?t.discount_type:"override",_=n?function(t,n){void 0===n&&(n="0");var o=acfw_edit_coupon.currency_symbol,e=acfw_edit_coupon.discount_field_options,c=e.override,a=e.percent,i=e.fixed;return'\n    <td class="price">\n        <div>\n        <select class="discount_type">\n            <option value="override" '.concat("override"==t?"selected":"",">").concat(o," : ").concat(c,'</option>\n            <option value="percent" ').concat("percent"==t?"selected":"",">% : ").concat(a,'</option>\n            <option value="fixed" ').concat("fixed"==t?"selected":"",">-").concat(o," : ").concat(i,'</option>\n        </select>\n        <input type="text" class="discount_value short wc_input_price" value="').concat(n,'">\n        </div>\n    </td>\n    ')}(f,a):"",v=n?'<th class="price">'.concat(u,"</th>"):"",h=function(t){if("object"!=typeof t||!t.length)return;for(var n="",o=0,e=t;o<e.length;o++){var c=e[o];n+='<option value="'.concat(c.product_id,'" selected>').concat(c.label,"</option>")}return n}(o),g=n?"".concat(d.apply_default," ").concat(d.multiple_items):d.trigger_default;return'\n      <p class="instructions">'.concat(g,'</p>\n      <table class="acfw-styled-table combined-products-form" \n          data-combined="').concat(l(JSON.stringify(t)),'"\n          data-isdeals="').concat(n,'">\n          <thead>\n              <tr>\n                  <th class="products-list">').concat(r,'</th>\n                  <th class="quantity">').concat(s,"</th>\n                  ").concat(v,'\n              </tr>\n          </thead>\n          <tbody>\n              <tr>\n                  <td class="products-list object">\n                      <select class="combined-products-list wc-product-search"\n                      data-placeholder="').concat(p,'"\n                      data-action="acfw_search_products"\n                      data-exclude="" multiple>').concat(h,'</select>\n                  </td>\n                  <td class="quantity">\n                      <input type="number" class="condition-quantity" value="').concat(e,'" min="1">\n                  </td>\n                  ').concat(_,"\n              </tr>\n          </tbody>\n      </table>\n      ").concat(mt(),"\n    ")}function xt(t){var n=t.category_id,o=t.category_label;return'\n    <td class="category category-'.concat(n,' object" data-category="').concat(l(JSON.stringify(t)),'">\n        ').concat(o,"\n    </td>\n    ")}function qt(t,n){void 0===t&&(t=3),void 0===n&&(n="product");var o=acfw_edit_coupon.no_products_added,e=acfw_edit_coupon.no_categories_added;return'\n    <tr class="no-result">\n        <td colspan="'.concat(t,'">').concat("category"==n?e:o,"</td>\n    </tr>\n    ")}function kt(t,n){return void 0===t&&(t="override"),void 0===n&&(n="0"),'<td class="price">\n        ('.concat(t,") ").concat(n,"\n    </td>")}function jt(t){var n=t.product_id,o=t.product_label;return'\n    <td class="product product-'.concat(n,' object" data-product="').concat(l(JSON.stringify(t)),'">\n        ').concat(o,"\n    </td>\n    ")}function St(t,n){return void 0===t&&(t="override"),void 0===n&&(n="0"),'<td class="price">\n    ('.concat(t,") ").concat(n,"\n  </td>")}function Ot(t,n){return void 0===n&&(n=!1),n?function(t){var n=t.quantity,o=t.discount_type,e=t.discount_value,c=acfw_edit_coupon.currency_symbol,a=acfw_edit_coupon.discount_field_options,i=acfw_edit_coupon.bogo_form_fields,d=acfw_edit_coupon.bogo_instructions,s=a.override,r=a.percent,u=a.fixed,p=i.quantity,f=i.price_discount,_=i.discount_type,v=o?t.discount_type:"override";return'\n    <p class="instructions">'.concat(d.anyproducts_apply,'</p>\n    <table class="acfw-styled-table any-products-apply-form any-products-form" data-anyproducts="').concat(l(JSON.stringify(t)),'">\n      <thead>\n        <tr>\n          <th class="quantity">').concat(p,'</th>\n          <th class="type">').concat(_,'</th>\n          <th class="price">').concat(f,'</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td class="quantity object">\n            <input type="number" class="condition-quantity" value="').concat(null!=n?n:"1",'" min="1">\n          </td>\n          <td class="type">\n            <select class="discount_type">\n              <option value="override" ').concat("override"==v?"selected":"",">").concat(c," : ").concat(s,'</option>\n              <option value="percent" ').concat("percent"==v?"selected":"",">% : ").concat(r,'</option>\n              <option value="fixed" ').concat("fixed"==v?"selected":"",">-").concat(c," : ").concat(u,'</option>\n            </select>\n          </td>\n          <td class="price">\n            <input type="text" class="discount_value short wc_input_price" value="').concat(null!=e?e:"0",'">\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    ').concat(mt(),"\n  ")}(t):function(t){var n=t.quantity,o=acfw_edit_coupon.bogo_instructions,e=acfw_edit_coupon.bogo_form_fields;return'\n    <p class="instructions">'.concat(o.anyproducts_trigger,'</p>\n    <div class="any-products-trigger-form any-products-form" data-anyproducts="').concat(l(JSON.stringify(t)),'">\n      <div class="trigger-field-row trigger-quantity-field-row">\n        <label for="any_products_trigger_qty">').concat(e.trigger_quantity,'</label>\n        <input type="number" id="any_products_trigger_qty" class="condition-quantity" value="').concat(null!=n?n:"1",'" min="1" />\n      </div>\n    </div>\n    ').concat(mt(),"\n  ")}(t)}var Ct=jQuery,Qt=document.querySelector("#acfw_bogo_deals");function Nt(t){Ct(Qt).data("editing",t),Ct(Qt).find("#save-bogo-deals").prop("disabled",!t)}function It(t){var n=Ct(this),o=n.data("block"),e=Qt.querySelector(".bogo-conditions-block"),c=Qt.querySelector(".bogo-product-deals-block"),a=Ct(Qt).data("bogo_deals"),i=a.conditions?a.conditions:null,d=a.deals?a.deals:null,s="conditions"==o?a.conditions_type:a.deals_type,r=null;r="conditions"===o?a.conditions_type==n.val()?i:r:a.deals_type==n.val()?d:r;var u,p,f="deals"==o,_=!1;switch(n.val()){case"combination-products":u=wt(null!=r?r:{},f),_=!0;break;case"product-categories":u=function(t,n,o){void 0===o&&(o=!1);var e=acfw_edit_coupon.add_prod_cat_label,c=acfw_edit_coupon.bogo_form_fields,a=acfw_edit_coupon.bogo_instructions,i=c.quantity,d=c.product_cat,s=o?4:3,r=o?'<th class="price">Price/Discount</th>':"",u=o?"".concat(a.apply_default," ").concat(a.multiple_items):a.trigger_default,p="",f=[];if(t.length>=1&&"product-categories"==n)for(var _=0,v=t;_<v.length;_++){var h=v[_],g=h.category_id,y=h.quantity,b=h.discount_type,m=h.discount_value,w=o?kt(b,m):"";f.push(g),p+="\n                <tr>\n                    ".concat(xt(h),'\n                    <td class="quantity">').concat(y,"</td>\n                    ").concat(w,'\n                    <td class="actions">\n                        <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n                        <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n                    </td>\n                </tr>\n            ')}else p=qt(s,"category");return'\n        <p class="instructions">'.concat(u,'</p>\n        <table class="acfw-styled-table" \n            data-type="category" \n            data-exclude="').concat(l(JSON.stringify(f)),'" \n            data-isdeals="').concat(o,'">\n            <thead>\n                <tr>\n                    <th class="product-cat">').concat(d,'</th>\n                    <th class="quantity">').concat(i,"</th>\n                    ").concat(r,'\n                    <th class="actions"></th>\n                </tr>\n            </thead>\n            <tbody>').concat(p,'</tbody>\n            <tfoot>\n                <tr>\n                    <td colspan="').concat(s,'">\n                        <a class="add-table-row" href="javascript:void(0);">\n                            <i class="dashicons dashicons-plus"></i>\n                            ').concat(e,"\n                        </a>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n        ").concat(mt(),"\n    ")}(null!=r?r:[],s,f),_=!0;break;case"any-products":u=Ot(null!=r?r:{},f),_=!0;break;default:u=function(t,n,o){void 0===o&&(o=!1);var e=acfw_edit_coupon.add_product_label,c=acfw_edit_coupon.bogo_form_fields,a=acfw_edit_coupon.bogo_instructions,i=c.quantity,d=c.product,s=o?"".concat(a.apply_default):a.trigger_default,r=o?4:3,u=o?'<th class="price">Price/Discount</th>':"",p="",f=[];if(t.length>=1&&"specific-products"==n)for(var _=0,v=t;_<v.length;_++){var h=v[_],g=h.quantity,y=h.discount_type,b=h.discount_value,m=o?St(y,b):"";f.push(h.product_id),p+="\n        <tr>\n          ".concat(jt(h),'\n          <td class="quantity">').concat(g,"</td>\n          ").concat(m,'\n          <td class="actions">\n            <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n            <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n          </td>\n        </tr>\n      ')}else p=qt(r);return'\n    <p class="instructions">'.concat(s,'</p>\n    <table class="product-quantity-condition-table acfw-styled-table" \n      data-type="product" data-exclude="').concat(l(JSON.stringify(f)),'" \n      data-isdeals="').concat(o,'">\n      <thead>\n        <tr>\n          <th class="product">').concat(d,'</th>\n          <th class="quantity">').concat(i,"</th>\n          ").concat(u,'\n          <th class="actions"></th>\n        </tr>\n      </thead>\n      <tbody>').concat(p,'</tbody>\n      <tfoot>\n        <tr>\n          <td colspan="').concat(r,'">\n            <a class="add-table-row" href="javascript:void(0);">\n              <i class="dashicons dashicons-plus"></i>\n              ').concat(e,"\n            </a>\n          </td>\n        </tr>\n      </tfoot>\n    </table>\n  ")}(null!=r?r:[],s,f),_=!1}if("conditions"==o)Ct(e).html(u).find("input.condition-quantity").trigger("change"===t.type?"change":"acfw_fetch_data"),p=e;else{var v=Ct(Qt).find(".multiple-items-desc");"specific-products"!==n.val()?v.show():v.hide(),Ct(c).html(u).find("input.condition-quantity").trigger("change"===t.type?"change":"acfw_fetch_data"),p=c}_&&void 0!==acfw_edit_coupon.upsell?Ct(p).addClass("premium-only"):Ct(p).removeClass("premium-only"),Ct("body").trigger("wc-enhanced-select-init"),Ct("body").trigger("init_tooltips")}var Jt=function(){return Jt=Object.assign||function(t){for(var n,o=1,e=arguments.length;o<e;o++)for(var c in n=arguments[o])Object.prototype.hasOwnProperty.call(n,c)&&(t[c]=n[c]);return t},Jt.apply(this,arguments)},Pt=jQuery,At=document.querySelector("#acfw_bogo_deals"),Tt=woocommerce_admin_meta_boxes.post_id;function Wt(){var t,n;Pt("#acfw_bogo_deals").find(".acfw-styled-table tr.add-edit-form button.cancel").trigger("click");var o=acfw_edit_coupon.post_status,e=acfw_edit_coupon.upsell,c=At.querySelectorAll(".bogo-conditions-block table.acfw-styled-table tbody td.object,.bogo-conditions-block .any-products-trigger-form"),a=At.querySelectorAll(".bogo-product-deals-block table.acfw-styled-table tbody td.object"),i=At.querySelector(".acfw-overlay"),l=At.querySelector("input[name='bogo_type']:checked"),s=Pt(At).find("#bogo-condition-type").val(),r=Pt(At).find("#bogo-deals-type").val(),u=Pt(At).find(".notice-option"),p=Mt(c,s),f=Mt(a,r),_=l?l.value:null,h=!1,g=!1;if("any-products"===s&&(h=(null==p?void 0:p.quantity)<1),"any-products"===r&&(g=!(null==f?void 0:f.discount_type)||!(null==f?void 0:f.discount_value)||(null==f?void 0:f.quantity)<1),"combination-products"===s&&(h=!(null===(t=null==p?void 0:p.products)||void 0===t?void 0:t.length)||(null==p?void 0:p.quantity)<1),"combination-products"===r&&(g=!(null===(n=null==f?void 0:f.products)||void 0===n?void 0:n.length)||!(null==f?void 0:f.discount_type)||!(null==f?void 0:f.discount_value)||(null==f?void 0:f.quantity)<1),(null==p?void 0:p.length)<1||(null==f?void 0:f.length)<1||!_||h||g)return vex.dialog.alert(acfw_edit_coupon.bogo_deals_save_error_msg),void Pt(At).addClass("save-error");if(void 0!==e&&("specific-products"!==s||"specific-products"!==r))return vex.dialog.alert(acfw_edit_coupon.bogo_deals_save_error_msg),void Pt(At).addClass("save-error");if(["any-products","combination-products"].includes(r)&&!v(null==f?void 0:f.discount_type,null==f?void 0:f.discount_value))return vex.dialog.alert(acfw_edit_coupon.discount_type_value_error_msg),void Pt(At).addClass("save-error");var y={message:u.find("textarea[name='acfw_bogo_notice_message_text']").val(),button_text:u.find("input[name='acfw_bogo_notice_button_text']").val(),button_url:u.find("input[name='acfw_bogo_notice_button_url']").val(),notice_type:u.find("select[name='acfw_bogo_notice_type']").val()};d(i,"show"),Pt(At).trigger("save_bogo_deals");var b={conditions:p,deals:f,conditions_type:s,deals_type:r,type:_,notice_settings:y};Pt.post(ajaxurl,Jt({action:"acfw_save_bogo_deals",coupon_id:Tt},b),(function(t){"success"==t.status?(Pt(At).data("bogo_deals",b),"publish"!==o&&(Pt("input[name='post_title']").val()||Pt("input[name='post_title']").val("coupon-"+Tt),Pt("select[name='post_status']").append(new Option("Published","publish")).val("publish"),Pt("#publishing-action").append('\n                    <input type="hidden" name="publish" value="Publish">\n                '),Pt("input#publish").click())):t.error_msg&&vex.dialog.alert(t.error_msg),Pt(At).find("#clear-bogo-deals").prop("disabled",!1),Nt(!1),d(i,"hide")}),"json")}function Mt(t,n){var o,e=[];switch(n){case"any-products":e=Pt(t).closest(".any-products-form").data("anyproducts");break;case"combination-products":e=Pt(t).closest("table.combined-products-form").data("combined");break;case"product-categories":t.forEach((function(t){(o=jQuery(t).data("category"))&&e.push(o)}));break;default:t.forEach((function(t){(o=jQuery(t).data("product"))&&e.push(o)}))}return e}function Et(){var t=Pt(this);if(confirm(t.data("prompt"))){var n=At.querySelector(".bogo-conditions-block table.acfw-styled-table tbody"),o=At.querySelector(".bogo-product-deals-block table.acfw-styled-table tbody"),e=At.querySelector(".acfw-overlay"),c=At.querySelector("input[name='bogo_type']:checked");d(e,"show"),Pt.post(ajaxurl,{action:"acfw_clear_bogo_deals",coupon_id:Tt,_wpnonce:t.data("nonce")},(function(a){"success"==a.status?(Pt(n).html(qt(3)),Pt(o).html(qt(4)),Pt(c).prop("checked",!1),t.prop("disabled",!0),Nt(!1),"Published"!=Pt("#post-status-display").text()&&(Pt("input[name='post_title']").val()||Pt("input[name='post_title']").val("coupon-"+Tt),Pt("input#publish").click())):a.error_msg&&vex.dialog.alert(a.error_msg),d(e,"hide")}),"json")}}function Dt(){var t,n,o=Pt(this).closest("table.combined-products-form"),e=o.data("combined"),c=o.find(".wc-product-search option:selected"),a={products:[],quantity:parseInt(o.find("input.condition-quantity").val()+"")};if(o.data("isdeals")){var i=o.find("select.discount_type"),d=o.find("input.discount_value"),l=parseFloat(d.val().toString());if(l<0||isNaN(l))return d.val(e?e.discount_value:""),void vex.dialog.alert(acfw_edit_coupon.fill_form_propery_error_msg);a.discount_type=i.val(),a.discount_value=d.val()}for(n=0;n<c.length;n++)t=Pt(c[n]),a.products.push({product_id:t.val(),label:t.text()});o.data("combined",a),Nt(!0)}function Ft(t){Pt(At).data("editing")&&(t.preventDefault(),Pt(At).find("#save-bogo-deals").trigger("click"),setTimeout((function(){Pt(At).hasClass("save-error")?Pt(At).removeClass("save-error"):Pt("form#post").submit()}),1e3))}function zt(t){var n=Pt(this).closest(".any-products-trigger-form"),o=parseInt(n.find("input#any_products_trigger_qty").val()),e={quantity:o&&!isNaN(o)?o:0};n.data("anyproducts",e),"change"===t.type&&Nt(!0)}function Lt(t){var n=Pt(this).closest(".any-products-apply-form"),o=parseInt(n.find("input.condition-quantity").val()),e=n.find("select.discount_type").val().toString(),c=n.find("input.discount_value").val().toString(),a={quantity:o&&!isNaN(o)?o:0,discount_type:null!=e?e:"",discount_value:null!=c?c:""};n.data("anyproducts",a),"change"===t.type&&Nt(!0)}function Ut(t,n,o,e){void 0===e&&(e=!1);var c=acfw_edit_coupon.bogo_form_fields.type_to_search,a=acfw_edit_coupon.product_table_buttons,i=a.add,d=a.edit,s=a.cancel,r=e.quantity,u="object"==typeof e?function(t,n){var o=n.category_id,e=n.product_id,c=n.category_label,a=n.product_label,i="category"==t?c:a;return'<option value="'.concat("category"==t?o:e,'">').concat(i,"</option>")}(t,e):"",p=o?function(t){var n=acfw_edit_coupon.currency_symbol,o=acfw_edit_coupon.discount_field_options,e=o.override,c=o.percent,a=o.fixed,i=t.discount_type,d=t.discount_value,l="object"==typeof t&&d?d:"0";return'\n    <td class="price">\n        <div>\n        <select class="discount_type">\n            <option value="override" '.concat("override"==i?"selected":"",">").concat(n," : ").concat(e,'</option>\n            <option value="percent" ').concat("percent"==i?"selected":"",">% : ").concat(c,'</option>\n            <option value="fixed" ').concat("fixed"==i?"selected":"",">-").concat(n," : ").concat(a,'</option>\n        </select>\n        <input type="text" class="discount_value short wc_input_price" value="').concat(l,'">\n        </div>\n    </td>\n    ')}(e):"",f="object"==typeof e?d:i;return'\n    <tr class="add-edit-form adding">\n        <td class="product" data-object="'.concat("object"==typeof e?l(JSON.stringify(e)):0,'">\n            <div class="object-search-wrap">\n                <select class="').concat("category"==t?"product-category-in-cart":"product-in-cart",' wc-product-search"\n                    data-placeholder="').concat(c,'"\n                    data-action="').concat("category"==t?"acfw_search_product_category":"acfw_search_products",'"\n                    data-exclude="').concat(l(JSON.stringify(n)),'">').concat(u,'</select>\n            </div>\n        </td>\n        <td class="quantity">\n            <input type="number" class="condition-quantity" value="').concat("object"==typeof e?r:1,'" min="1">\n        </td>\n        ').concat(p,'\n        <td class="actions">\n            <button type="button" class="condition-product-add button-primary">').concat(f,'</button>\n            <button type="button" class="cancel button">').concat(s,"</button>\n        </td>\n    </tr>\n    ")}function Bt(t,n,o){var e=t.quantity,c=t.discount_type,a=t.discount_value,i=o?'<td class="price">('.concat(c,") ").concat(a,"</td>"):"";return"\n    <tr>\n        ".concat(function(t,n){switch(n){case"category":return xt(t);case"product":return jt(t)}}(t,n),'\n        <td class="quantity">').concat(e,"</td>\n        ").concat(i,'\n        <td class="actions">\n            <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n            <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n        </td>\n    </tr>')}var Gt=jQuery;acfw_edit_coupon.bogo_form_fields;function Ht(){var t=Gt(this).closest(".acfw-styled-table"),n=t.find("tbody"),o=t.data("isdeals"),e=t.data("type"),c=t.data("exclude");n.find("tr.no-result").remove(),n.append(Ut(e,c,o)),Gt("body").trigger("wc-enhanced-select-init"),n.find("tr.add-edit-form select.enhanced").trigger("focus")}function Kt(){var t=jQuery(this),n=t.closest("tr"),o=t.closest(".acfw-styled-table"),e=o.find("tbody"),c=o.data("isdeals"),a=o.data("type"),i=n.find(".object").data(a),d=i.category_id,l=i.product_id,s=o.data("exclude"),r="category"==a?d:l;s.splice(s.indexOf(r),1),e.find("tr.no-result").remove(),n.replaceWith(Ut(a,s,c,i)),o.data("exclude",s),o.find(".wc-product-search").data("exclude",s),Gt("body").trigger("wc-enhanced-select-init")}function Rt(){var t=Gt(this),n=t.closest("tr"),o=t.closest("table"),e=n.closest("tbody"),c=o.data("isdeals"),a=n.find("td").length,i=o.data("type"),d=n.find("td.product").data("object"),l=d.category_id,s=d.product_id,r=o.data("exclude"),u="category"==i?l:s;r.includes(u)?vex.dialog.alert(acfw_edit_coupon.product_exists_in_table):"object"==typeof d?(r.push(u),n.replaceWith(Bt(d,i,c)),o.data("exclude",r),o.find(".wc-product-search").data("exclude",r)):(n.remove(),e.find("tr").length<=0&&e.append(qt(a,i)))}function Vt(){var t=Gt(this),n=t.closest("tr"),o=t.closest("table.acfw-styled-table"),e=o.data("isdeals"),c=o.data("type"),a=n.find(".wc-product-search"),i=n.find(".condition-quantity"),d=o.data("exclude");if(!a.val()||!i.val()||i.val()<1)vex.dialog.alert(acfw_edit_coupon.fill_form_propery_error_msg);else if(d.includes(parseInt(a.val().toString())))vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);else{if(e){var l=n.find("input.discount_value").val().toString();if(!v(n.find("select.discount_type").val().toString(),l))return void vex.dialog.alert(acfw_edit_coupon.discount_type_value_error_msg);if(_(l)<0||isNaN(_(l)))return void vex.dialog.alert(acfw_edit_coupon.fill_form_propery_error_msg)}var s=function(t,n,o){var e={};e="category"==n?{category_id:parseInt(t.find(".wc-product-search").val()+""),quantity:parseInt(t.find(".condition-quantity").val()+""),category_label:t.find(".wc-product-search option:selected").text()}:{product_id:parseInt(t.find(".wc-product-search").val()+""),quantity:parseInt(t.find(".condition-quantity").val()+""),product_label:t.find(".wc-product-search option:selected").text()};o&&(e.discount_type=t.find("select.discount_type").val(),e.discount_value=t.find("input.discount_value").val().toString());return e}(n,c,e),r=s.category_id,u=s.product_id;d.push("category"==c?r:u),n.replaceWith(Bt(s,c,e)),o.data("exclude",d),o.find(".wc-product-search").data("exclude",d),Nt(!0)}}function Xt(){var t,n=Gt(this).closest("tr"),o=n.closest("table"),e=n.closest("tbody"),c=n.find("td").length,a=o.data("type"),i=n.find("td.object").data(a),d=o.data("exclude");if("category"===a)t=d.indexOf(parseInt(i.category_id));else t=d.indexOf(parseInt(i.product_id));-1!==t&&d.splice(t,1),o.data("exclude",d),o.find(".wc-product-search").data("exclude",d),n.remove(),e.find("tr").length<=0&&e.append(qt(c,a)),Nt(!0)}var Yt=function(){return Yt=Object.assign||function(t){for(var n,o=1,e=arguments.length;o<e;o++)for(var c in n=arguments[o])Object.prototype.hasOwnProperty.call(n,c)&&(t[c]=n[c]);return t},Yt.apply(this,arguments)},Zt=jQuery,$t=document.querySelector("#acfw_bogo_deals");function tn(){var t=Zt(this),n=t.closest("#general_coupon_data"),o=n.find("p.form-field input");if("acfw_bogo"===t.val()){n.addClass("acfw-bogo-type"),Zt("#acfw_bogo_deals").show();for(var e=0;e<=o.length;e++)["expiry_date","_acfw_coupon_sort_priority","coupon_amount"].includes(Zt(o[e]).prop("name"))||Zt(o[e]).prop("disabled",!0)}else{n.removeClass("acfw-bogo-type"),Zt("#acfw_bogo_deals").hide();for(e=0;e<=o.length;e++)["expiry_date","_acfw_coupon_sort_priority","coupon_amount"].includes(Zt(o[e]).prop("name"))||Zt(o[e]).prop("disabled",!1)}}function nn(){Nt(!0)}function on(){var t=jQuery(this);t.val()<1&&t.val(1)}acfw_edit_coupon=Yt(Yt({},acfw_edit_coupon),{bogo_toggle_editing_mode:Nt});var en=jQuery;function cn(){var t=en(this),n=t.closest(".toggle-enable-fields").find("select,textarea,input:not(.toggle-trigger-field)"),o=!t.prop("checked");n.prop("disabled",o),o?n.closest(".form-field").addClass("disabled"):n.closest(".form-field").removeClass("disabled")}var an=jQuery,dn=!1;function ln(){var t=acfw_edit_coupon.upsell.usage_limits;vex.dialog.alert({unsafeMessage:'<div class="upsell-alert usage-limits">'.concat(t,"</div>")}),an(this).val("none")}function sn(){if(!dn){dn=!0;var t=acfw_edit_coupon.upsell.usage_restriction;vex.dialog.alert({unsafeMessage:'<div class="upsell-alert exclude-coupon">'.concat(t,"</div>"),afterClose:function(){return dn=!1}}),an(this).val("")}}function rn(){var t=acfw_edit_coupon.upsell.auto_apply;vex.dialog.alert({unsafeMessage:'<div class="upsell-alert auto-apply">'.concat(t,"</div>")}),an(this).prop("checked",!1)}function un(){var t=an(this),n=t.closest("#acfw_cart_conditions"),o=t.closest(".add-condition-form"),e=n.data("premium-conditions"),c=n.find(".acfw-dyk-notice-holder"),a=o.find(".acfw-dyk-notice");a.length||(o.append(c.html()),a=o.find(".acfw-dyk-notice")),an.inArray(t.val(),e)>=0?a.show():a.hide()}function pn(){"acfw_bogo"===an(this).val()?an("p.acfw-dyk-notice-general").hide():an("p.acfw-dyk-notice-general").show()}function fn(){var t=an(this),n=t.closest("#acfw_bogo_deals").find(".bogo-auto-add-products-field"),o=n.find("input[type='checkbox']");"specific-products"===t.val()?(o.prop("disabled",!1),n.addClass("show")):(o.prop("disabled",!1),n.removeClass("show"))}function _n(){an(this).prop("checked",!1);var t=acfw_edit_coupon.upsell.bogo_auto_add_get_products;vex.dialog.alert({unsafeMessage:'<div class="upsell-alert usage-limits">'.concat(t,"</div>")}),an(this).val("none")}function vn(t){var n,o,e,c,a=t.title,i=t.className,d=t.links;return acfw_edit_coupon.help_modal.is_premium&&(d=d.filter((function(t){return void 0===(null==t?void 0:t.freeOnly)||!(null==t?void 0:t.freeOnly)}))),'\n    <div class="links-list '.concat(i,'">\n      <h3>').concat(a,"</h3>\n\n      ").concat((null==t?void 0:t.search)?(n=null==t?void 0:t.search,o=n.slug,e=n.action,c=n.placeholder,'\n    <div class="search-widget search-'.concat(o,'">\n      <input class="search-input" type="text" placeholder="').concat(c,'" data-action="').concat(e,'" />\n      <button type="button" class="clear-search dashicons-before dashicons-no-alt"></button>\n      <div class="search-results"></div>\n    </div>\n  ')):"","\n\n      <ul>\n        ").concat(d.map((function(t){return"<li>".concat(function(t){var n=t.title,o=t.url,e=acfw_edit_coupon.help_modal.is_premium;return'<a href="'.concat(e&&(null==t?void 0:t.premiumUrl)?null==t?void 0:t.premiumUrl:o,'">').concat(n,"</a>")}(t),"</li>")})).join(""),"\n      </ul>\n    </div>\n  ")}function hn(t){var n=acfw_edit_coupon.help_modal,o=n.labels,e=n.images_url,c=n.is_premium,a=t.target,i=t.left,d=i.title,l=i.content,s=i.videos,r=t.right,u=r.links,p=r.kbs,f=r.tutorials,_={slug:"kb-articles",action:"acfw_search_help_kb_articles",placeholder:o.search_placeholder},v=c?"acfwp":"acfwf",h="https://advancedcouponsplugin.com/pricing/?utm_source=acfwf&utm_medium=help_modal&utm_campaign=help_modal_".concat(a,"_upgrade_link"),g="https://advancedcouponsplugin.com/?utm_source=".concat(v,"&utm_medium=help_modal&utm_campaign=help_brand_link_").concat(a);return'\n    <div class="header">\n      <div class="logo">\n        <a href="'.concat(g,'" target="_blank"><img src="').concat(e,'acfw-logo.png" alt="Advanced Coupons logo" /></a>\n      </div>\n      ').concat(c?"":'\n        <div class="upgrade-link">\n          <a href="'.concat(h,'" target="_blank">\n            <span>').concat(o.upgrade_to_premium,'</span>\n            <i class="dashicons dashicons-external"></i>\n          </a>\n        </div>\n      '),'\n    </div>\n    <main>\n      <h1 class="title">').concat(d,'</h1>\n      <div class="content">\n        ').concat(l,"\n      </div>\n      ").concat(s.length?'<div class="video-gallery-placeholder"><img src="'.concat(e,'spinner-2x.gif" alt="Loading videos" /><p>').concat(o.loading_videos,"</p></div>"):"","\n    </main>\n    <aside>\n      ").concat(vn({title:o.rel_links,className:"relevant-links",links:u}),"\n      ").concat(vn({title:o.kb_articles,className:"knowledge-base-articles",links:p,search:_}),"\n      ").concat(vn({title:o.tut_guides,className:"tutorials-guides",links:f}),"\n    </aside>\n  ")}function gn(t){var n=acfw_edit_coupon.help_modal.images_url,o=acfw_edit_coupon.help_modal.labels,e=o.permission_request,c=o.allow,a=o.cancel;return'\n  <div id="acfw-help-modal-permission-request" data-module="'.concat(t,'">\n    <img src="').concat(n,'acfw-logo.png" />\n    <p>').concat(e,'</p>\n    <p class="actions">\n      <button class="button-primary allow" type="button">').concat(c,'</button>\n      <button class="button cancel" type="button">').concat(a,"</button>\n    </p>\n  </div>\n  ")}function yn(){var t=acfw_edit_coupon.help_modal,n=t.images_url,o=t.labels;return'<div id="acfw-help-modal-placeholder">\n    <img src="'.concat(n,'spinner-2x.gif" />\n    <p>').concat(o.loading_content,"</p>\n  </div>")}function bn(t){return'\n  <div class="no-video" style="background-image:url('.concat(t.thumbnail,');">\n    <a href="').concat(t.url,'" rel="noreferer noopener" >\n      <span>').concat(acfw_edit_coupon.help_modal.labels.no_video,"</span>\n    </a>\n  </div>\n  ")}var mn=jQuery,wn=[],xn="";function qn(t,n){var o=acfw_edit_coupon.help_modal._secure_nonce;t.length&&mn.post(ajaxurl,{action:"acfw_get_help_videos_oembed",urls:t.map((function(t){return t.url})),width:mn(".acfw-help-vex .vex-content main").width(),_nonce:o},(function(o){o=o.map((function(n){var o=t.findIndex((function(t){return t.url===n.url}));return n.title=o>=0?t[o].title:"",n})),wn=o,xn=n,kn(o)}),"json")}function kn(t){var n=mn(".acfw-help-vex .video-gallery-placeholder");n.length&&n.replaceWith(function(t){return'\n  <div class="acfw-help-video-gallery">\n    <div class="videos">\n      '.concat(t[0].embed?t[0].embed:bn(t[0]),"\n    </div>\n    ").concat(t.length>1?'\n      <ul class="thumbnails">\n        '.concat(t.map((function(t,n){return"\n            <li ".concat(0===n?'class="active"':"",'>\n              <a href="javascript:void(0);" data-videoid="').concat(t.videoid,'">\n                <img src="').concat(t.thumbnail,'" title="').concat(t.title,'" />\n              </a>\n              <span class="title">').concat(t.title,"</span>\n            </li>\n            ")})).join(""),"\n      </ul>\n      "):"","\n    \n  </div>\n  ")}(t))}function jn(){var t=jQuery(this),n=t.closest("li"),o=t.closest(".acfw-help-video-gallery"),e=o.find(".videos"),c=o.find("ul.thumbnails li"),a=t.data("videoid");if(!n.hasClass("active")){c.removeClass("active"),n.addClass("active");var i=wn.findIndex((function(t){return t.videoid===a}));i>=0&&e.html(wn[i].embed?wn[i].embed.replace("oembed","oembed&autoplay=1"):bn(wn[i]))}}var Sn=jQuery,On=[];function Cn(){var t=acfw_edit_coupon.help_modal.allow_fetch,n=Sn(this).closest(".acfw-help-link").data("module");vex.dialog.open({unsafeMessage:'\n      <a class="vex-close" href="javascript:void(0);"></a>\n      '.concat(t?yn():gn(n),"\n    "),className:"vex-theme-plain acfw-help-vex",showCloseButton:!1,buttons:{}}),t&&Nn(n)}function Qn(t){var n=Sn("#acfw-help-modal-placeholder");n.length&&(n.replaceWith(t),Sn(".acfw-help-vex").find("main a,aside a").attr("target","_blank").attr("rel","noopener noreferrer nofollow"))}function Nn(t){var n,o=acfw_edit_coupon.help_modal._secure_nonce;if(n=function(t){var n=On.findIndex((function(n){return n.target===t}));return n>=0?On[n]:null}(t))return Qn(hn(n)),void function(t,n){wn.length&&n===xn?kn(wn):qn(t,n)}(n.left.videos,t);Sn.post(ajaxurl,{action:"acfw_fetch_help_data",module:t,_nonce:o},(function(n){On.push(n),Qn(hn(n)),qn(n.left.videos,t)}),"json").fail((function(t){var n,o;Qn((n=t.responseJSON,o=n.errorMsg,'\n    <div class="acfw-help-modal-error">\n      <p>'.concat(o,"</p>\n    </div>\n  ")))}))}var In=jQuery,Jn=null,Pn=null;function An(){var t=In(this).closest(".search-widget"),n=t.find("input.search-input"),o=t.find(".search-results"),e=acfw_edit_coupon.help_modal,c=e.labels,a=e.images_url,i=e._secure_nonce,d=n.val();if(!d)return clearTimeout(Jn),Jn=null,o.height(0).html(""),void t.removeClass("show-clear");t.addClass("show-clear"),function(t,n,o){Jn&&(clearTimeout(Jn),Jn=null);if(t.term===(null==Pn?void 0:Pn.term))return void o(Pn.results);Jn=setTimeout((function(){n(),In.post(ajaxurl,t,o,"json")}),1e3)}({action:n.data("action"),term:n.val(),_nonce:i},(function(){o.height(35).html('<div class="loading"><img src="'.concat(a,'spinner.gif" /></div>'))}),(function(n){t.hasClass("show-clear")&&(n.length?(Pn={term:d,results:n},o.html(function(t,n){var o=t.map((function(t){var o=t.url,e=t.title;return'<li><a href="'.concat(function(t,n){return"".concat(t,"?utm_source=acfwf&utm_medium=help_modal&utm_campaign=kb_search&utm_term=").concat(n)}(o,n),'" rel="noopener noreferrer nofollow" target="_blank">').concat(e,"</a></li>")})).join("");return"<ul>".concat(o,"</ul>")}(n,d))):o.html('<div class="no-result">'.concat(c.search_no_results,"</div>")),o.height(o.find("ul,.no-result").height()+3))}))}function Tn(){var t=In(this).closest(".search-widget"),n=t.find("input.search-input"),o=t.find(".search-results");clearTimeout(Jn),Jn=null,n.val(""),o.height(0).html(""),t.removeClass("show-clear")}var Wn=jQuery;function Mn(){var t=acfw_edit_coupon.help_modal._secure_nonce,n=jQuery(this).closest("#acfw-help-modal-permission-request"),o=n.data("module");n.replaceWith(yn()),Wn.post(ajaxurl,{action:"acfw_save_fetch_help_permission",_nonce:t},(function(){Nn(o),acfw_edit_coupon.help_modal.allow_fetch=!0}),"json")}function En(){vex.closeAll()}var Dn=jQuery;var Fn=acfw_edit_coupon.modules,zn=acfw_edit_coupon.upsell;jQuery(document).ready((function(t){var n,o,d,l,r;Fn.indexOf("acfw_cart_conditions_module")>-1&&(ht(gt).on("click","#add-cart-condition-group",b),ht(gt).on("click","a.remove-condition-group",m),ht(gt).on("click",".add-condition-field",W),ht(gt).on("click","a.remove-condition-field",M),ht(gt).on("click",".add-condition-trigger",e),ht(gt).on("click",".cancel-add-condition-field",e),ht(gt).on("click",".acfw-styled-table tfoot .add-table-row",Z),ht(gt).on("click",".acfw-styled-table td.actions a.edit",$),ht(gt).on("click","tr.add-edit-form .actions .condition-product-add",tt),ht(gt).on("click","tr.add-edit-form .actions .cancel",nt),ht(gt).on("click",".acfw-styled-table td.actions a.remove",ot),ht(gt).on("click","#save-cart-conditions",G),ht(gt).on("change","input[type='number']",it),ht(gt).on("change","select.condition-select",dt),ht(gt).on("change","select.has-ordered-before-type",lt),ht(gt).on("change",".wc_input_price",st),ht(gt).on("change","select.custom-taxonomy",a),ht(gt).on("change",".shipping-zone-region-field select.condition-select",i),ht(gt).on("blur",".wc_input_price",rt),ht(gt).on("change","select.value-type",ut),ht("form#post").on("submit",H),ht(gt).find("select").trigger("change"),ht(gt).css("min-height",ht("#coupon_options").height()),ht(gt).on("change","input,select,textarea",(function(){c(!0)})),ht(gt).find(".condition-groups").each((function(){ht(this).find(".condition-group-fields").length&&ht(this).show()})),ht(".acfw-cart-condition-tabs").on("click","li a",ft),setTimeout(yt,500)),Fn.indexOf("acfw_bogo_deals_module")>-1&&(Zt($t).on("click",".acfw-styled-table tfoot .add-table-row",Ht),Zt($t).on("click",".acfw-styled-table td.actions a.edit",Kt),Zt($t).on("click","tr.add-edit-form .actions .cancel",Rt),Zt($t).on("click","tr.add-edit-form .actions .condition-product-add",Vt),Zt($t).on("click",".acfw-styled-table td.actions a.remove",Xt),Zt($t).on("click","button#save-bogo-deals",Wt),Zt($t).on("click","button#clear-bogo-deals",Et),Zt($t).on("change acfw_load","select#bogo-condition-type,select#bogo-deals-type",It),Zt($t).on("change acfw_fetch_data",".combined-products-form select,.combined-products-form input",Dt),Zt($t).on("change acfw_fetch_data",".any-products-trigger-form input",zt),Zt($t).on("change acfw_fetch_data",".any-products-apply-form input,.any-products-apply-form select",Lt),Zt($t).on("change",".condition-quantity",on),Zt($t).on("blur",".wc_input_price",s),Zt($t).css("min-height",Zt("#coupon_options").height()),Zt($t).on("change","input[name='bogo_type']",nn),Zt($t).on("click",".acfw-styled-table .actions .remove",nn),Zt($t).find(".notice-option").on("change","input,textarea,select",nn),Zt("form#post").on("submit",Ft),Zt($t).find("select#bogo-condition-type,select#bogo-deals-type").trigger("acfw_load"),Zt("#woocommerce-coupon-data").on("change acfw_load","select#discount_type",tn),Zt("#woocommerce-coupon-data select#discount_type").trigger("acfw_load")),zn&&(an("#usage_limit_coupon_data").on("change","#reset_usage_limit_period",ln),an("#usage_restriction_coupon_data .exclude_coupon_ids_field").on("click change focus","input,select",sn),an("#acfw-auto-apply-coupon").on("change","#acfw_auto_apply_coupon_field",rn),an("#acfw_cart_conditions").on("change",".condition-types",un),an("#woocommerce-coupon-data").on("change acfw_load","#discount_type",pn),an("#acfw_bogo_deals").on("change acfw_load","select#bogo-deals-type",fn),an("#acfw_bogo_deals").on("change","input[name='acfw_bogo_auto_add_products']",_n),an("#woocommerce-coupon-data #discount_type").trigger("acfw_load")),(n=en(".toggle-enable-fields")).on("change",".toggle-trigger-field",cn),n.find(".toggle-trigger-field").trigger("change"),o=document.querySelectorAll("#post-body .acfw-help-link"),d=acfw_edit_coupon.help_modal,l=d.help_text,r=d.images_url,o.forEach((function(t){var n='\n      <a class="acfw-help-modal-trigger" href="javascript:void(0);">'.concat(l,' \n        <img class="acfw-icon" src="').concat(r,'help-icon.svg" alt="').concat(l,'" />\n      </a>\n    ');Dn(t).html(n)})),Dn("#post-body").on("click",".acfw-help-modal-trigger",Cn),Dn("body").on("click",".acfw-help-vex .vex-close",(function(){return vex.closeAll()})),Dn("body").on("click",".acfw-help-vex .acfw-help-video-gallery ul.thumbnails li a",jn),Dn("body").on("keyup",".acfw-help-vex .search-widget input.search-input",An),Dn("body").on("click",".acfw-help-vex .search-widget button.clear-search",Tn),Dn("body").on("click",".acfw-help-vex #acfw-help-modal-permission-request button.allow",Mn),Dn("body").on("click",".acfw-help-vex #acfw-help-modal-permission-request button.cancel",En)}))})();
//# sourceMappingURL=edit-advanced-coupon.js.map