jQuery(document).ready(function(a){"use strict";var d=a(document).find(".infs-sections-group"),e=d.find(".infs-section"),n=e.find(".section-head"),i=n.find(".remove"),t=e.find(".yith-infs-eventype-select"),o=e.find(".yith-infs-loader-select"),s="undefined"!=typeof yith_infs_admin&&yith_infs_admin.block_loader,c="undefined"!=typeof yith_infs_admin&&yith_infs_admin.error_msg,r="undefined"!=typeof yith_infs_admin&&yith_infs_admin.del_msg,f=a("#yith-infs-add-section"),l=a("#yith-infs-add-section-button");l.on("click",function(e){e.preventDefault();var n=a(this),i=n.data("section_id"),e=n.data("section_name"),s=f.val();""==s?c&&n.siblings(".error-input-section").html(c):(l.block({message:null,overlayCSS:{background:"#fff url("+yith_infs_admin.loader+") no-repeat center",opacity:.5,cursor:"none"}}),l.attr("disabled","disabled"),f.attr("disabled","disabled"),a.post(yith_infs_admin.ajaxurl,{action:"yith_infinite_scroll_section",section:s,id:i,name:e,context:"admin"},function(e){f.val(""),a(".error-input-section").remove(),d.append(e);var n=a(".infs-section."+s),i=n.find(".section-head"),t=n.find(".remove"),o=n.find(".yith-infs-eventype-select"),e=n.find(".yith-infs-loader-select");"undefined"!=typeof a.fn.select2&&n.find("select").select2({minimumResultsForSearch:Infinity}),l.unblock(),l.removeAttr("disabled"),f.removeAttr("disabled"),u(i),m(t),h(o),_(e)}))}),a("#yith-infs-add-section").keypress(function(e){13==e.which&&(e.preventDefault(),e.stopPropagation(),l.click())});var u=function(e){e.on("click",function(){var e=a(this);e.parents(".infs-section").toggleClass("open"),e.next(".section-body").slideToggle()})},m=function(e){e.on("click",function(e){e.stopPropagation();var n=a(this),e=n.data("section"),i=n.parents(".infs-section");1==window.confirm(r)&&(s&&i.block({message:null,overlayCSS:{background:"#fff url("+s+") no-repeat center",opacity:.5,cursor:"none"}}),a.post(yith_infs_admin.ajaxurl,{action:"yith_infinite_scroll_section_remove",section:e,context:"admin"},function(e){i.remove()}))})},h=function(e){e.each(function(){var e=a(this),n=e.find("option:selected");p(e,n.val()),e.on("change",function(){n=e.find("option:selected"),p(e,n.val())})})},p=function(e,n){var i=e.parents(".infs-section").find("tr.deps-button"),e=e.parents(".infs-section").find("tr.deps-scroll");"button"==n?(i.show(),e.hide()):"scroll"==n?(i.hide(),e.show()):(i.hide(),e.hide())},_=function(e){e.each(function(){var e=a(this),n=e.find("option:selected"),i=n.data("loader_url"),t=e.closest("td").find("img");i&&t.attr("src",i),e.on("change",function(){n=e.find("option:selected"),i=n.data("loader_url"),t.attr("src",i)})})};a(document).on("click",".upload_img_button",function(e){e.preventDefault();var n,i=a(this);n||(n=wp.media.frames.file_frame=wp.media({title:"Choose Image",button:{text:"Choose Image"},multiple:!1})).on("select",function(){var e=n.state().get("selection").first().toJSON();i.prev(".upload_img_url").val(e.url)}),n.open()}),u(n),m(i),h(t),_(o),"undefined"!=typeof a.fn.select2&&e.find("select").select2({minimumResultsForSearch:Infinity}),"undefined"!=typeof CodeMirror&&CodeMirror.fromTextArea(document.getElementById("yit_infs_options_yith-infs-custom-js"),{lineNumbers:1,showCursorWhenSelecting:!0})});