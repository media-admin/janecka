{"version":3,"file":"yith-wcan-shortcodes.js","mappings":"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","sources":["webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/config.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-filter.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-filter-labels.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-reset-button.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-modal-opener.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-dropdown.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-preset.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-dropdown-premium.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/modules/yith-wcan-preset-premium.js","webpack://yith-woocommerce-ajax-product-filter-premium/./assets/js/shortcodes/index.js"],"sourcesContent":["'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nconst $ = jQuery; // we can do this as WebPack will compact all together inside a closure.\nconst $body = $( 'body' );\n\nexport { $, $body };\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $, $body } from '../config.js';\n\nexport default class YITH_WCAN_Filter {\n\t// currently executing xhr\n\txhr = null;\n\n\t// flag set during ajax call handling\n\tdoingAjax = false;\n\n\t// register original url search param\n\toriginalSearch = location.search;\n\n\t// flag set once init has executed\n\tinitialized = false;\n\n\t// flag set when page has at least one active filter.\n\tfiltered = false;\n\n\t// init object\n\tconstructor() {\n\t\tthis.initPopState();\n\t\tthis.initialized = true;\n\t}\n\n\t// init page reload when popstate event alter filters\n\tinitPopState() {\n\t\tthis.pushUrlToHistory( window.location );\n\n\t\t$( window ).on( 'popstate', function () {\n\t\t\tif ( ! window.history.state?._yithWcan ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\twindow.location.reload( true );\n\t\t} );\n\t}\n\n\t// execute call to filter products in current view\n\tdoFilter( filters, target, preset ) {\n\t\tlet targetUrl,\n\t\t\t$target = target ? $( target ) : $( 'body' ),\n\t\t\tcustomFilters;\n\n\t\t// filter properties\n\t\tcustomFilters = $(\n\t\t\tdocument\n\t\t).triggerHandler( 'yith_wcan_filters_parameters', [ filters ] );\n\n\t\tif ( !! customFilters ) {\n\t\t\tfilters = customFilters;\n\t\t}\n\n\t\t// block elements before filtering\n\t\t$target && this.block( $target );\n\n\t\t// calculate target url\n\t\ttargetUrl = this.buildUrl( filters );\n\n\t\t// if no ajax, simply change page url\n\t\tif ( ! yith_wcan_shortcodes.ajax_filters ) {\n\t\t\tthis.pushUrlToHistory( targetUrl, document.title, filters );\n\n\t\t\twindow.location = targetUrl;\n\t\t\treturn;\n\t\t}\n\n\t\t// start doing ajax\n\t\tthis.doingAjax = true;\n\n\t\treturn this._doAjax( targetUrl ).done( ( response ) => {\n\t\t\ttargetUrl = this.searchAlternativeUrl( response, targetUrl );\n\n\t\t\tthis._beforeFilter( response, filters );\n\n\t\t\tthis.refreshFragments( target, preset, response );\n\t\t\tthis.pushUrlToHistory( targetUrl, response.pageTitle, filters );\n\t\t\tthis.originalSearch = location.search;\n\n\t\t\t$target && this.unblock( $target );\n\n\t\t\tthis._afterFilter( response, filters );\n\n\t\t\tthis.doingAjax = false;\n\t\t} );\n\t}\n\n\t// actions performed before filter\n\t_beforeFilter( response, filters ) {\n\t\t$( document ).trigger( 'yith-wcan-ajax-loading', [\n\t\t\tresponse,\n\t\t\tfilters,\n\t\t] );\n\t}\n\n\t// actions performed after filter\n\t_afterFilter( response, filters ) {\n\t\t$( '.woocommerce-ordering' ).on(\n\t\t\t'change',\n\t\t\t'select.orderby',\n\t\t\tfunction () {\n\t\t\t\t$( this ).closest( 'form' ).submit();\n\t\t\t}\n\t\t);\n\n\t\tthis.filtered = filters && !! Object.keys( filters ).length;\n\t\tthis.filtered\n\t\t\t? $body.addClass( 'filtered' )\n\t\t\t: $body.removeClass( 'filtered' );\n\n\t\t$( window ).trigger( 'scroll' );\n\n\t\t$( document )\n\t\t\t.trigger( 'yith-wcan-ajax-filtered', [ response, filters ] )\n\t\t\t.trigger( 'yith_wcwl_reload_fragments' );\n\t}\n\n\t// build url to show\n\tbuildUrl( filters ) {\n\t\tlet queryParam = yith_wcan_shortcodes.query_param,\n\t\t\tparams = {},\n\t\t\tlocation = window.location,\n\t\t\turl = !! yith_wcan_shortcodes.base_url\n\t\t\t\t? yith_wcan_shortcodes.base_url\n\t\t\t\t: location?.origin + location?.pathname,\n\t\t\tsearch = '',\n\t\t\tself = this;\n\n\t\tconst haveFilters =\n\t\t\ttypeof filters === 'object' && Object.keys( filters ).length;\n\n\t\t// remove filter session from current url, if any\n\t\tif ( !! yith_wcan_shortcodes.session_param ) {\n\t\t\turl = url.replace(\n\t\t\t\tnew RegExp(\n\t\t\t\t\t'/' + yith_wcan_shortcodes.session_param + '/[^/]*/'\n\t\t\t\t),\n\t\t\t\t''\n\t\t\t);\n\t\t}\n\n\t\tif ( haveFilters ) {\n\t\t\tparams[ queryParam ] = 1;\n\t\t}\n\n\t\tif ( !! this.originalSearch ) {\n\t\t\tconst searchParams = this.originalSearch\n\t\t\t\t.replace( '?', '' )\n\t\t\t\t.split( '&' )\n\t\t\t\t.reduce( ( a, v ) => {\n\t\t\t\t\tconst items = v.split( '=' );\n\n\t\t\t\t\tif ( items.length === 2 ) {\n\t\t\t\t\t\tif ( this.isFilterParam( items[ 0 ] ) ) {\n\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ta[ items[ 0 ] ] = items[ 1 ];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn a;\n\t\t\t\t}, {} );\n\n\t\t\tparams = $.extend( params, searchParams );\n\t\t}\n\n\t\tif ( haveFilters ) {\n\t\t\tparams = $.extend( params, filters );\n\t\t}\n\n\t\tsearch = Object.keys( params )\n\t\t\t.reduce( function ( a, i ) {\n\t\t\t\tconst v = params[ i ];\n\n\t\t\t\tif ( ! v || ! i ) {\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\n\t\t\t\ta += self._cleanParam( i ) + '=' + self._cleanParam( v ) + '&';\n\n\t\t\t\treturn a;\n\t\t\t}, '?' )\n\t\t\t.replace( /&$/g, '' )\n\t\t\t.replace( /%2B/g, '+' )\n\t\t\t.replace( /%2C/g, ',' );\n\n\t\tif ( search.length > 1 ) {\n\t\t\turl += search;\n\t\t}\n\n\t\treturn url;\n\t}\n\n\t// retrieves alternative sharing url in response body\n\tsearchAlternativeUrl( response, defaultUrl = '' ) {\n\t\tlet url = defaultUrl,\n\t\t\tmatches;\n\n\t\tif ( -1 === response.indexOf( 'yith_wcan:sharing_url' ) ) {\n\t\t\treturn url;\n\t\t}\n\n\t\tmatches = response.match(\n\t\t\t/<meta name=\"yith_wcan:sharing_url\" content=\"([^\"]*)\">/\n\t\t);\n\t\turl = matches && 1 in matches ? matches[ 1 ] : url;\n\n\t\treturn url;\n\t}\n\n\t// push url to browser history\n\tpushUrlToHistory( url, title, filters ) {\n\t\tif (\n\t\t\t! yith_wcan_shortcodes.change_browser_url ||\n\t\t\tnavigator.userAgent.match( /msie/i )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\twindow.history.pushState(\n\t\t\t{\n\t\t\t\t_yithWcan: true,\n\t\t\t\tpageTitle: title,\n\t\t\t\tfilters,\n\t\t\t},\n\t\t\t'',\n\t\t\turl\n\t\t);\n\t}\n\n\t// replaces elements in the page with refreshed ones\n\trefreshFragments( target, preset, response ) {\n\t\tconst responseDom = document.createElement( 'html' ),\n\t\t\t$response = $( responseDom );\n\n\t\tresponseDom.innerHTML = response;\n\n\t\tif ( target ) {\n\t\t\tlet $preset = $( preset ),\n\t\t\t\t$target = $( target ),\n\t\t\t\t$destination;\n\n\t\t\tif ( $preset.length ) {\n\t\t\t\t$destination = $response.find( preset );\n\n\t\t\t\tif ( $destination.length ) {\n\t\t\t\t\t$preset.replaceWith( $destination.first() );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( $target.length ) {\n\t\t\t\t$destination = $response.find( target );\n\n\t\t\t\tif ( $destination.length ) {\n\t\t\t\t\t$target.replaceWith( $destination.first() );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst content = $( yith_wcan_shortcodes.content );\n\n\t\t\tif ( content.length ) {\n\t\t\t\tcontent.replaceWith(\n\t\t\t\t\t$response.find( yith_wcan_shortcodes.content )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t$( 'body' ).replaceWith( $response.find( 'body' ) );\n\t\t\t}\n\t\t}\n\n\t\t$( document ).trigger( 'yith_wcan_init_shortcodes' );\n\t}\n\n\t// clean url parameters\n\t_cleanParam( param ) {\n\t\tif (\n\t\t\t! yith_wcan_shortcodes?.process_sanitize ||\n\t\t\tyith_wcan_shortcodes?.skip_sanitize\n\t\t) {\n\t\t\treturn param;\n\t\t}\n\n\t\treturn encodeURIComponent( param );\n\t}\n\n\t// executes Ajax calls\n\t_doAjax( url, params ) {\n\t\tif ( this.xhr ) {\n\t\t\tthis.xhr.abort();\n\t\t}\n\n\t\tparams = $.extend(\n\t\t\t{\n\t\t\t\turl,\n\t\t\t\theaders: {\n\t\t\t\t\t'X-YITH-WCAN': 1,\n\t\t\t\t},\n\t\t\t},\n\t\t\tparams\n\t\t);\n\n\t\tthis.xhr = $.ajax( params );\n\n\t\treturn this.xhr;\n\t}\n\n\t// block dom elements\n\tblock( $el ) {\n\t\tif ( typeof $.fn.block === 'undefined' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet background = '#fff center center no-repeat';\n\n\t\tif ( yith_wcan_shortcodes?.loader ) {\n\t\t\tbackground = `url('${ yith_wcan_shortcodes.loader }') ${ background }`;\n\t\t}\n\n\t\t$el.block( {\n\t\t\tmessage: null,\n\t\t\toverlayCSS: {\n\t\t\t\tbackground,\n\t\t\t\topacity: 0.7,\n\t\t\t},\n\t\t} );\n\t}\n\n\t// unblock dom elements\n\tunblock( $el ) {\n\t\tif ( typeof $.fn.unblock === 'undefined' ) {\n\t\t\treturn;\n\t\t}\n\n\t\t$el.unblock();\n\t}\n\n\t// checks if param is one used by layared nav to filter products.\n\tisFilterParam( param ) {\n\t\tlet supportedParams = [\n\t\t\t\t'rating_filter',\n\t\t\t\t'min_price',\n\t\t\t\t'max_price',\n\t\t\t\t'price_ranges',\n\t\t\t\t'onsale_filter',\n\t\t\t\t'instock_filter',\n\t\t\t\t'featured_filter',\n\t\t\t\t'orderby',\n\t\t\t\t'product-page',\n\t\t\t\tyith_wcan_shortcodes.query_param,\n\t\t\t],\n\t\t\tcustomParams;\n\n\t\t// filter properties\n\t\tcustomParams = $(\n\t\t\tdocument\n\t\t).triggerHandler( 'yith_wcan_supported_filters_parameters', [\n\t\t\tsupportedParams,\n\t\t] );\n\n\t\tif ( !! customParams ) {\n\t\t\tsupportedParams = customParams;\n\t\t}\n\n\t\tsupportedParams = supportedParams.concat(\n\t\t\tyith_wcan_shortcodes.supported_taxonomies.map( ( i ) =>\n\t\t\t\ti.replace( 'pa_', 'filter_' )\n\t\t\t)\n\t\t);\n\n\t\tif ( -1 !== supportedParams.indexOf( param ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( -1 !== param.indexOf( 'filter_' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( -1 !== param.indexOf( 'query_type_' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\n\nexport default class YITH_WCAN_Filter_Labels {\n\t// current label set\n\t$label_set = null;\n\n\t// labels of current set\n\t$labels = false;\n\n\t// init object\n\tconstructor( el ) {\n\t\t// current label set\n\t\tthis.$label_set = el;\n\n\t\tthis._initLabels();\n\n\t\tthis.$label_set.data( 'filter_labels', this ).addClass( 'enhanced' );\n\t}\n\n\t// init labels\n\t_initLabels() {\n\t\tconst self = this;\n\n\t\tthis.getLabels().each( function () {\n\t\t\tconst $label = $( this );\n\n\t\t\tself._initLabel( $label );\n\t\t} );\n\t}\n\n\t// init label\n\t_initLabel( $label ) {\n\t\t$label.on( 'click', ( ev ) => {\n\t\t\tif ( this.disableLabel( $label ) ) {\n\t\t\t\tev.preventDefault();\n\t\t\t}\n\t\t} );\n\t}\n\n\t// get labels\n\tgetLabels() {\n\t\tif ( false === this.$labels ) {\n\t\t\tthis.$labels = this.$label_set.find( '.active-filter-label' );\n\t\t}\n\n\t\treturn this.$labels;\n\t}\n\n\t// disable filter\n\tdisableLabel( $label ) {\n\t\tconst properties = $label.data( 'filters' );\n\t\tlet result = false;\n\n\t\t// search for preset\n\t\t$( '.yith-wcan-filters' ).each( function () {\n\t\t\tconst preset = $( this ).data( 'preset' );\n\n\t\t\tresult =\n\t\t\t\tresult ||\n\t\t\t\tpreset.deactivateFilterByProperties( properties, true );\n\t\t} );\n\n\t\treturn result;\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\n\nexport default class YITH_WCAN_Reset_Button {\n\t// current button\n\t$reset = null;\n\n\t// init object\n\tconstructor( el ) {\n\t\t// current button\n\t\tthis.$reset = el;\n\n\t\tthis.$reset.on( 'click', function ( ev ) {\n\t\t\tev.preventDefault();\n\n\t\t\t$( '.yith-wcan-filters' ).each( function () {\n\t\t\t\tconst preset = $( this ).data( 'preset' );\n\n\t\t\t\tpreset.deactivateAllFilters( true );\n\t\t\t\tpreset.closeModal();\n\t\t\t} );\n\t\t} );\n\n\t\tthis.$reset.data( 'reset', this ).addClass( 'enhanced' );\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\n\nexport default class YITH_WCAN_Modal_Opener {\n\t// current button\n\t$button = null;\n\n\t// YITH_WCAN_Preset object\n\tpreset = null;\n\n\t// preset dom node\n\t$preset = null;\n\n\t// is mobile flag\n\tisMobile = false;\n\n\t// init object\n\tconstructor( el ) {\n\t\t// current button\n\t\tthis.$button = el;\n\n\t\tthis._initPreset();\n\t\tthis._initResponsive();\n\t\tthis._initActions();\n\n\t\tthis.$button.data( 'modalOpener', this ).addClass( 'enhanced' );\n\t}\n\n\t// search for related preset\n\t_initPreset() {\n\t\tlet target = this.$button.data( 'target' ),\n\t\t\t$target;\n\n\t\tif ( target ) {\n\t\t\t$target = $( `#${ target }` );\n\t\t} else {\n\t\t\t$target = $( '.yith-wcan-filters' );\n\t\t}\n\n\t\tif ( ! $target.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$preset = $target.first();\n\t\tthis.preset = this.$preset.data( 'preset' );\n\t}\n\n\t// init responsive\n\t_initResponsive() {\n\t\tif ( ! yith_wcan_shortcodes.modal_on_mobile || ! this.preset ) {\n\t\t\tthis.$button.hide();\n\t\t\treturn;\n\t\t}\n\n\t\tconst media = window.matchMedia(\n\t\t\t`(max-width: ${ yith_wcan_shortcodes.mobile_media_query }px)`\n\t\t);\n\n\t\t$( window )\n\t\t\t.on( 'resize', () => {\n\t\t\t\tconst isMobile = !! media.matches;\n\n\t\t\t\tif ( isMobile !== this.isMobile ) {\n\t\t\t\t\tthis.isMobile = isMobile;\n\t\t\t\t\tthis._afterLayoutChange();\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.resize();\n\t}\n\n\t// init actions\n\t_initActions() {\n\t\tif ( ! this.$preset?.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst self = this;\n\n\t\tthis.$button.on( 'click', function ( ev ) {\n\t\t\tev.preventDefault();\n\n\t\t\tself.preset.openModal();\n\t\t} );\n\t}\n\n\t// hide/show button when needed\n\t_afterLayoutChange() {\n\t\tthis.isMobile ? this.$button.show() : this.$button.hide();\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\n\nexport default class YITH_WCAN_Dropdown {\n\t// current button\n\t$originalSelect = null;\n\n\t// main element\n\t$_main = null;\n\n\t// label element\n\t$_label = null;\n\n\t// dropdown\n\t$_dropdown = null;\n\n\t// search input\n\t$_search = null;\n\n\t// show more link\n\t$_showMore = null;\n\n\t// items list\n\t$_items = null;\n\n\t// current page\n\tcurrentPage = 1;\n\n\t// options\n\toptions = {};\n\n\t// init object\n\tconstructor( el, opts ) {\n\t\tthis.$originalSelect = el;\n\n\t\tif ( ! this.$originalSelect.is( 'select' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst defaultPerPage = this.$originalSelect.data( 'per_page' ),\n\t\t\tdefaultOrder = this.$originalSelect.data( 'order' ),\n\t\t\tdefaultAll = this.$originalSelect.data( 'all-label' ),\n\t\t\tdefaults = {\n\t\t\t\tshowSearch: this.$originalSelect.data( 'show_search' ),\n\t\t\t\tpaginate: this.$originalSelect.data( 'paginate' ),\n\t\t\t\tperPage: defaultPerPage ? defaultPerPage : 10,\n\t\t\t\torder: defaultOrder ? defaultOrder : 'ASC',\n\t\t\t\tgetElements: null,\n\t\t\t\tlabels: {\n\t\t\t\t\temptyLabel: defaultAll\n\t\t\t\t\t\t? defaultAll\n\t\t\t\t\t\t: yith_wcan_shortcodes.labels.empty_option,\n\t\t\t\t\tsearchPlaceholder:\n\t\t\t\t\t\tyith_wcan_shortcodes.labels.search_placeholder,\n\t\t\t\t\tnoItemsFound: yith_wcan_shortcodes.labels.no_items,\n\t\t\t\t\tshowMore: yith_wcan_shortcodes.labels.show_more,\n\t\t\t\t},\n\t\t\t};\n\n\t\tthis.options = $.extend( defaults, opts );\n\n\t\tthis._hideSelect();\n\t\tthis._initTemplate();\n\t\tthis._initActions();\n\n\t\tthis.$originalSelect.data( 'dropdown', this ).addClass( 'enhanced' );\n\t}\n\n\t// hide select\n\t_hideSelect() {\n\t\tthis.$originalSelect.hide();\n\t}\n\n\t// create dropdown\n\t_initTemplate() {\n\t\tconst $mainSpan = $( '<div/>', {\n\t\t\t\tclass: 'yith-wcan-dropdown closed',\n\t\t\t} ),\n\t\t\t$labelSpan = $( '<div/>', {\n\t\t\t\tclass: 'dropdown-label',\n\t\t\t\thtml: this.getLabel(),\n\t\t\t} ),\n\t\t\t$dropdownSpan = $( '<div>', {\n\t\t\t\tclass: 'dropdown-wrapper',\n\t\t\t} ),\n\t\t\t$matchingItemsList = $( '<ul/>', {\n\t\t\t\tclass: 'matching-items filter-items',\n\t\t\t} );\n\n\t\t$dropdownSpan.append( $matchingItemsList );\n\t\t$mainSpan.append( $labelSpan ).append( $dropdownSpan );\n\n\t\tif ( this.options.showSearch ) {\n\t\t\tthis._initSearchTemplate( $dropdownSpan );\n\t\t}\n\n\t\tif ( this.options.paginate ) {\n\t\t\tthis._initShowMoreTemplate( $dropdownSpan );\n\t\t}\n\n\t\tthis.$originalSelect.after( $mainSpan );\n\t\tthis.$_main = $mainSpan;\n\t\tthis.$_label = $labelSpan;\n\t\tthis.$_dropdown = $dropdownSpan;\n\t\tthis.$_items = $matchingItemsList;\n\t}\n\n\t// create search field\n\t_initSearchTemplate( $dropdwonSpan ) {\n\t\tconst $container = $( '<div/>', {\n\t\t\t\tclass: 'search-field-container',\n\t\t\t} ),\n\t\t\t$search = $( '<input/>', {\n\t\t\t\tname: 's',\n\t\t\t\tclass: 'search-field',\n\t\t\t\ttype: 'search',\n\t\t\t\tplaceholder: this.options.labels.searchPlaceholder,\n\t\t\t} );\n\n\t\t$container.append( $search ).prependTo( $dropdwonSpan );\n\t\tthis.$_search = $search;\n\t}\n\n\t// create showMore field\n\t_initShowMoreTemplate( $dropdwonSpan ) {\n\t\tconst $showMore = $( '<a/>', {\n\t\t\tclass: 'show-more',\n\t\t\ttext: this.options.labels.showMore.replace(\n\t\t\t\t'%d',\n\t\t\t\tthis.options.perPage\n\t\t\t),\n\t\t} );\n\n\t\t$showMore.on( 'click', this.loadNextPage.bind( this ) ).hide();\n\n\t\t$dropdwonSpan.append( $showMore );\n\t\tthis.$_showMore = $showMore;\n\t}\n\n\t// init actions performed over dropdown elements\n\t_initActions() {\n\t\tconst self = this;\n\n\t\t// main open event\n\t\tthis.$_main?.on( 'click', ( ev ) => {\n\t\t\tev.stopPropagation();\n\t\t\tself.toggleDropdown();\n\t\t} );\n\t\tthis.$_dropdown.on( 'click', ( ev ) => {\n\t\t\tev.stopPropagation();\n\t\t} );\n\n\t\t// search event\n\t\tthis.$_search?.on( 'keyup search', () => {\n\t\t\tself._populateItems();\n\t\t} );\n\n\t\t// select event\n\t\tthis.$_items.on( 'change', ':input', function () {\n\t\t\tlet $li = $( this ).closest( 'li' ),\n\t\t\t\tvalue = $li.data( 'value' ),\n\t\t\t\tisActive = false;\n\n\t\t\tif (\n\t\t\t\t$li.hasClass( 'disabled' ) &&\n\t\t\t\t! self.isValueSelected( value )\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t$li.toggleClass( 'active' );\n\t\t\tisActive = $li.hasClass( 'active' );\n\n\t\t\tself._changeItemStatus( value, isActive );\n\t\t} );\n\t\tthis.$_items.on( 'click', 'li:not(.checkbox) a', function ( ev ) {\n\t\t\tlet $li = $( this ).closest( 'li' ),\n\t\t\t\tvalue = $li.data( 'value' ),\n\t\t\t\tisActive = false;\n\n\t\t\tev.preventDefault();\n\n\t\t\tif (\n\t\t\t\t$li.hasClass( 'disabled' ) &&\n\t\t\t\t! self.isValueSelected( value )\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t$li.toggleClass( 'active' );\n\t\t\tisActive = $li.hasClass( 'active' );\n\n\t\t\tif ( isActive ) {\n\t\t\t\t$li.siblings().removeClass( 'active' );\n\t\t\t}\n\n\t\t\tself._changeItemStatus( value, isActive );\n\t\t} );\n\t\tthis.$_items.on( 'click', 'label > a', function ( ev ) {\n\t\t\tconst input = $( this ).parent().find( ':input' );\n\n\t\t\tev.preventDefault();\n\n\t\t\tif (\n\t\t\t\tinput.is( '[type=\"radio\"]' ) ||\n\t\t\t\tinput.is( '[type=\"checkbox\"]' )\n\t\t\t) {\n\t\t\t\tinput.prop( 'checked', ! input.prop( 'checked' ) );\n\t\t\t}\n\n\t\t\tinput.change();\n\t\t} );\n\n\t\t// select change\n\t\tthis.$originalSelect.on( 'change', ( ev, selfOriginated ) => {\n\t\t\tif ( selfOriginated ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself.$_items.find( 'li' ).each( function () {\n\t\t\t\tconst value = $( this ).data( 'value' );\n\n\t\t\t\tif ( self.isValueSelected( value ) ) {\n\t\t\t\t\tself._selectItem( value );\n\t\t\t\t} else {\n\t\t\t\t\tself._deselectItem( value );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tself.updateLabel();\n\t\t} );\n\n\t\t// close dropdown on external click; do this handler only once for any dropdown in the page\n\t\tif ( ! globalThis?.yith_wcan_dropdown_init ) {\n\t\t\t$( document ).on( 'click', this._closeAllDropdowns );\n\t\t\tglobalThis.yith_wcan_dropdown_init = true;\n\t\t}\n\t}\n\n\t// open dropdown\n\topenDropdown() {\n\t\tthis.$_main?.addClass( 'open' ).removeClass( 'closed' );\n\t\tthis._afterDropdownOpen();\n\t}\n\n\t// close dropdown\n\tcloseDropdown() {\n\t\tthis.$_main?.removeClass( 'open' ).addClass( 'closed' );\n\t}\n\n\t// close all dropdowns\n\t_closeAllDropdowns() {\n\t\tconst dropdowns = $( document )\n\t\t\t.find( 'select.enhanced' )\n\t\t\t.filter( function ( i, select ) {\n\t\t\t\tconst $el = $( select );\n\n\t\t\t\treturn !! $el.data( 'dropdown' );\n\t\t\t} );\n\n\t\tdropdowns.each( function () {\n\t\t\t$( this ).data( 'dropdown' ).closeDropdown();\n\t\t} );\n\t}\n\n\t// close other dropdowns\n\t_closeOtherDropdowns() {\n\t\tconst self = this,\n\t\t\tdropdowns = $( document )\n\t\t\t\t.find( 'select.enhanced' )\n\t\t\t\t.filter( function ( i, select ) {\n\t\t\t\t\tconst $el = $( select );\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t!! $el.data( 'dropdown' ) &&\n\t\t\t\t\t\t! $el.is( self.$originalSelect )\n\t\t\t\t\t);\n\t\t\t\t} );\n\n\t\tdropdowns.each( function () {\n\t\t\t$( this ).data( 'dropdown' ).closeDropdown();\n\t\t} );\n\t}\n\n\t// toggle dropdown\n\ttoggleDropdown() {\n\t\tthis.$_main?.toggleClass( 'open' ).toggleClass( 'closed' );\n\n\t\tif ( this.$_main?.hasClass( 'open' ) ) {\n\t\t\tthis._afterDropdownOpen();\n\t\t}\n\t}\n\n\t// perform operations after dropdown is open\n\t_afterDropdownOpen() {\n\t\tthis._closeOtherDropdowns();\n\n\t\tif ( this.$_search?.length ) {\n\t\t\tthis.$_search.val( '' );\n\t\t}\n\n\t\tthis._populateItems();\n\t}\n\n\t// get elements\n\tgetMatchingElements( search, limit ) {\n\t\tlet matchingElements = [],\n\t\t\t$options = this.getOptions(),\n\t\t\tpromise;\n\n\t\tpromise = new Promise( ( resolve ) => {\n\t\t\t// first of all, search across select option\n\t\t\t$options.each( function () {\n\t\t\t\tconst t = $( this ),\n\t\t\t\t\tvalue = t.val(),\n\t\t\t\t\tlabel = t.html(),\n\t\t\t\t\tregex = new RegExp( '.*' + search + '.*', 'i' ),\n\t\t\t\t\tshow =\n\t\t\t\t\t\t! search || regex.test( value ) || regex.test( label );\n\n\t\t\t\tif ( show ) {\n\t\t\t\t\tmatchingElements.push( {\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\tlabel,\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// then retrieve additional items\n\t\t\tif ( this.options.getElements ) {\n\t\t\t\t// we're expecting key => value pairs\n\t\t\t\tthis.options\n\t\t\t\t\t.getElements( search )\n\t\t\t\t\t.then( ( retrievedElements ) => {\n\t\t\t\t\t\tif ( retrievedElements ) {\n\t\t\t\t\t\t\t// reformat retrieved array\n\t\t\t\t\t\t\tretrievedElements = retrievedElements.reduce(\n\t\t\t\t\t\t\t\t( a, v, i ) => {\n\t\t\t\t\t\t\t\t\ta.push( { label: i, value: v } );\n\t\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t[]\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t// merge found results with options\n\t\t\t\t\t\t\tmatchingElements = $.extend(\n\t\t\t\t\t\t\t\tmatchingElements,\n\t\t\t\t\t\t\t\tretrievedElements\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresolve( this._formatItems( matchingElements, limit ) );\n\t\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tresolve( this._formatItems( matchingElements, limit ) );\n\t\t\t}\n\t\t} );\n\n\t\treturn promise;\n\t}\n\n\t// format items as key/value pairs for further processing\n\t_formatItems( items, limit ) {\n\t\tlet indexes = [],\n\t\t\thasMore = false;\n\n\t\t// remove duplicates and sort array of results\n\t\titems\n\t\t\t.filter( ( v ) => {\n\t\t\t\tif ( -1 === indexes.indexOf( v.value ) ) {\n\t\t\t\t\tindexes.push( v.value );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t} )\n\t\t\t.sort( ( a, b ) => {\n\t\t\t\tconst order = this.options.order,\n\t\t\t\t\tmod = order === 'ASC' ? 1 : -1;\n\n\t\t\t\tif ( a.value < b.value ) {\n\t\t\t\t\treturn -1 * mod;\n\t\t\t\t} else if ( a.value > b.value ) {\n\t\t\t\t\treturn mod;\n\t\t\t\t}\n\n\t\t\t\treturn 0;\n\t\t\t} );\n\n\t\t// paginate when needed\n\t\tif ( limit ) {\n\t\t\thasMore = limit < Object.keys( items ).length;\n\t\t\titems = items.slice( 0, limit );\n\t\t}\n\n\t\treturn {\n\t\t\titems,\n\t\t\thasMore,\n\t\t};\n\t}\n\n\t// generate item to append to items list\n\t_generateItem( value, label ) {\n\t\tlet active = this.isValueSelected( value ),\n\t\t\toption = this.getOptionByValue( value ),\n\t\t\t$item = $( '<li/>', {\n\t\t\t\t'data-value': value,\n\t\t\t\tclass: option.length ? option.attr( 'class' ) : '',\n\t\t\t} ),\n\t\t\t$anchor;\n\n\t\tif ( option.length ) {\n\t\t\tconst template = option.data( 'template' ),\n\t\t\t\tcount = option.data( 'count' );\n\n\t\t\tlabel = template ? template : label;\n\n\t\t\tif ( !! count ) {\n\t\t\t\tlabel += count;\n\t\t\t}\n\t\t}\n\n\t\t$anchor = $( '<a/>', {\n\t\t\thref: option.length ? option.data( 'filter_url' ) : '#',\n\t\t\thtml: label,\n\t\t\t'data-title': option.length ? option.data( 'title' ) : '',\n\t\t} );\n\n\t\tif ( this.$originalSelect.prop( 'multiple' ) ) {\n\t\t\tconst $checkbox = $( '<input/>', {\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tvalue,\n\t\t\t\t} ),\n\t\t\t\t$label = $( '<label>' );\n\n\t\t\t$checkbox.prop( 'checked', active );\n\t\t\t$label.prepend( $checkbox ).append( $anchor );\n\t\t\t$item.append( $label ).addClass( 'checkbox' );\n\t\t} else {\n\t\t\t$item.append( $anchor );\n\t\t}\n\n\t\tactive ? $item.addClass( 'active' ) : $item.removeClass( 'active' );\n\n\t\treturn $item;\n\t}\n\n\t// populate items list\n\t_populateItems( page ) {\n\t\tlet search = this.$_search?.length ? this.$_search.val() : '',\n\t\t\tperPage = this.options.paginate ? this.options.perPage : 0,\n\t\t\tlimit;\n\n\t\tpage = page ? parseInt( page ) : 1;\n\t\tlimit = page * perPage;\n\n\t\tthis.getMatchingElements( search, limit ).then( ( resultSet ) => {\n\t\t\tlet matchingItems = resultSet.items,\n\t\t\t\titems = [],\n\t\t\t\thasMore = false;\n\n\t\t\t// remove all previous items\n\t\t\tthis._emptyItems();\n\t\t\tthis._hideLoadMore();\n\n\t\t\tif ( ! matchingItems.length ) {\n\t\t\t\titems.push(\n\t\t\t\t\t$( '<li/>', { text: this.options.labels.noItemsFound } )\n\t\t\t\t);\n\n\t\t\t\tthis.currentPage = 1;\n\t\t\t} else {\n\t\t\t\tfor ( const v of matchingItems ) {\n\t\t\t\t\tif ( v.value === '' ) {\n\t\t\t\t\t\titems.unshift( this._generateItem( v.value, v.label ) );\n\t\t\t\t\t} else {\n\t\t\t\t\t\titems.push( this._generateItem( v.value, v.label ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.currentPage = page;\n\t\t\t\thasMore = resultSet.hasMore;\n\t\t\t}\n\n\t\t\tthis.$_items.append( items );\n\n\t\t\tthis.$originalSelect.trigger( 'yith_wcan_dropdown_updated' );\n\n\t\t\tif ( hasMore ) {\n\t\t\t\tthis._showLoadMore();\n\t\t\t}\n\t\t} );\n\t}\n\n\t// load next page of items\n\tloadNextPage() {\n\t\tconst page = this.currentPage + 1;\n\n\t\tthis._populateItems( page );\n\t}\n\n\t// set an item as active\n\t_selectItem( value ) {\n\t\treturn this._changeItemStatus( value, true );\n\t}\n\n\t// disable an item\n\t_deselectItem( value ) {\n\t\treturn this._changeItemStatus( value, false );\n\t}\n\n\t// change item status\n\t_changeItemStatus( value, status ) {\n\t\tconst $option = this.$originalSelect.find(\n\t\t\t`option[value=\"${ value }\"]`\n\t\t);\n\n\t\tif ( $option.length ) {\n\t\t\t$option.prop( 'selected', status );\n\n\t\t\tthis.closeDropdown();\n\t\t\tthis.updateLabel();\n\n\t\t\tthis.$originalSelect.trigger( 'change', [ true ] );\n\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t// empty items list\n\t_emptyItems() {\n\t\tthis.$_items.html( '' );\n\t}\n\n\t// show \"Load more\" link\n\t_showLoadMore() {\n\t\tthis.$_showMore.show();\n\t}\n\n\t// hide \"Load more\" link\n\t_hideLoadMore() {\n\t\tthis.$_showMore.hide();\n\t}\n\n\t// returns select label\n\tgetLabel() {\n\t\treturn this.hasSelectedValues()\n\t\t\t? this.getSelectedLabels().join( ', ' )\n\t\t\t: this.options.labels.emptyLabel;\n\t}\n\n\t// update label to match new selection\n\tupdateLabel() {\n\t\tconst label = this.getLabel();\n\n\t\tthis.$_label?.html( label );\n\t}\n\n\t// returns select options\n\tgetOptions() {\n\t\treturn this.$originalSelect.find( 'option' );\n\t}\n\n\t// checks whether select has selected values\n\thasSelectedValues() {\n\t\treturn this.getSelectedOptions().length;\n\t}\n\n\t// checks whether a value is selected\n\tisValueSelected( value ) {\n\t\tconst found = this.getSelectedValues().indexOf( value.toString() );\n\n\t\treturn -1 !== found;\n\t}\n\n\t// retrieve selected options\n\tgetSelectedOptions() {\n\t\treturn this.$originalSelect.find( 'option' ).filter( ':selected' );\n\t}\n\n\t// retrieves an option node by value\n\tgetOptionByValue( value ) {\n\t\treturn this.$originalSelect.find( `option[value=\"${ value }\"]` );\n\t}\n\n\t// retrieve labels for selected options\n\tgetSelectedLabels() {\n\t\tconst labels = [];\n\n\t\tthis.getSelectedOptions().each( function () {\n\t\t\tlet $option = $( this ),\n\t\t\t\ttemplate = $option.data( 'template' );\n\n\t\t\ttemplate = template\n\t\t\t\t? template\n\t\t\t\t: $option.html().replace( /\\([0-9]*\\)/, '' );\n\n\t\t\tlabels.push( template );\n\t\t} );\n\n\t\treturn labels;\n\t}\n\n\t// retrieve values for selected options\n\tgetSelectedValues() {\n\t\tconst values = [];\n\n\t\tthis.getSelectedOptions().each( function () {\n\t\t\tvalues.push( $( this ).val() );\n\t\t} );\n\n\t\treturn values;\n\t}\n\n\tdestroy() {\n\t\t// TBD\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\nimport YITH_WCAN_Dropdown from './yith-wcan-dropdown';\n\nexport default class YITH_WCAN_Preset {\n\t// main preset node\n\tpreset = false;\n\t$preset = false;\n\n\t// target of the filter, if any\n\ttarget = false;\n\t$target = false;\n\n\t// filters node\n\t$filters = false;\n\n\t// filter button\n\t$filterButtons = false;\n\n\t// nodes created just for modal layout\n\tmodalElements = {};\n\n\t// retains current status of filters\n\tactiveFilters = false;\n\n\t// mobile flag\n\tisMobile = false;\n\n\t// slider timeout\n\tsliderTimeout = false;\n\n\t// registers when status has changed\n\toriginalFilters = null;\n\tdirty = false;\n\n\t// init object\n\tconstructor( el ) {\n\t\t// main preset node\n\t\tthis.preset = '#' + el.attr( 'id' );\n\t\tthis.$preset = el;\n\n\t\t// target of the filter, if any\n\t\tthis.target = this.$preset.data( 'target' );\n\t\tthis.$target = this.target ? $( this.target ) : false;\n\n\t\tthis._regiterStatus();\n\t\tthis._initFilterButton();\n\t\tthis._initResponsive();\n\t\tthis._initFilters();\n\t\tthis._initActions();\n\n\t\tthis.$preset\n\t\t\t.data( 'preset', this )\n\t\t\t.addClass( 'enhanced' )\n\t\t\t.trigger( 'yith_wcan_preset_initialized', [ this ] );\n\t}\n\n\t// init filters\n\t_initFilters() {\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tself._initFilter( $filter );\n\t\t} );\n\n\t\tthis.maybeShowClearAllFilters();\n\t}\n\n\t// init filter button\n\t_initFilterButton() {\n\t\tthis.$filterButtons = this.$preset.find( '.apply-filters' );\n\n\t\tif ( ! this.$filterButtons.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// manage filter button\n\t\tthis.$filterButtons\n\t\t\t.on( 'click', ( ev ) => {\n\t\t\t\tev.preventDefault();\n\t\t\t\tthis.filter();\n\t\t\t} )\n\t\t\t.hide();\n\t}\n\n\t// init generic actions\n\t_initActions() {\n\t\tthis.$preset.find( 'form' ).on( 'submit', ( ev ) => {\n\t\t\tev.preventDefault();\n\t\t} );\n\t}\n\n\t// init responsive\n\t_initResponsive() {\n\t\tif ( ! yith_wcan_shortcodes.modal_on_mobile ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst media = window.matchMedia(\n\t\t\t`(max-width: ${ yith_wcan_shortcodes.mobile_media_query }px)`\n\t\t);\n\n\t\t$( window )\n\t\t\t.on( 'resize', () => {\n\t\t\t\tconst isMobile = !! media.matches;\n\n\t\t\t\tif ( isMobile !== this.isMobile ) {\n\t\t\t\t\tthis.isMobile = isMobile;\n\t\t\t\t\tthis._afterLayoutChange();\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.resize();\n\t}\n\n\t// init filter\n\t_initFilter( $filter ) {\n\t\tconst self = this,\n\t\t\thandleChange = function ( ev ) {\n\t\t\t\tconst t = $( this ),\n\t\t\t\t\t$currentFilter = t.closest( '.yith-wcan-filter' ),\n\t\t\t\t\tmultiple = $currentFilter.length\n\t\t\t\t\t\t? 'yes' === $currentFilter.data( 'multiple' )\n\t\t\t\t\t\t: false,\n\t\t\t\t\t$item = t.closest( '.filter-item' ),\n\t\t\t\t\t$items = $item.length\n\t\t\t\t\t\t? $currentFilter.find( '.filter-item' ).not( $item )\n\t\t\t\t\t\t: [];\n\n\t\t\t\tif ( $item.is( '.disabled' ) && ! $item.is( '.active' ) ) {\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tev.preventDefault();\n\n\t\t\t\t$items.length &&\n\t\t\t\t\t! multiple &&\n\t\t\t\t\t$items\n\t\t\t\t\t\t.removeClass( 'active' )\n\t\t\t\t\t\t.children( 'label' )\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t.parent( '.checked' )\n\t\t\t\t\t\t.removeClass( 'checked' );\n\t\t\t\t$item.length && $item.toggleClass( 'active' );\n\n\t\t\t\t// reset active filters.\n\t\t\t\tself.activeFilters = false;\n\n\t\t\t\tself.maybeFilter( $filter );\n\t\t\t\tself.maybeToggleClearAllFilters();\n\t\t\t\tself.maybeToggleClearFilter( $currentFilter );\n\t\t\t};\n\n\t\t// handle filter activation/deactivation by click on label (no input involved)\n\t\t$filter\n\t\t\t.find( '.filter-item' )\n\t\t\t.not( '.checkbox' )\n\t\t\t.not( '.radio' )\n\t\t\t.on( 'click', 'a', function ( ev ) {\n\t\t\t\tconst t = $( this ),\n\t\t\t\t\t$item = t.closest( '.filter-item' );\n\n\t\t\t\tif ( ! $( ev?.delegateTarget ).is( $item ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\thandleChange.call( this, ev );\n\t\t\t} );\n\n\t\t// handle filter activation/deactivation from input change\n\t\t$filter.find( ':input' ).on( 'change', function ( ev ) {\n\t\t\tconst t = $( this ),\n\t\t\t\t$item = t.closest( '.filter-item' );\n\n\t\t\tif ( $item.is( '.disabled' ) && ! $item.is( '.active' ) ) {\n\t\t\t\tt.prop( 'checked', false );\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\thandleChange.call( this, ev );\n\t\t} );\n\n\t\t// handle filter activation/deactivation by click on label (there is an input whose state can be switched)\n\t\t$filter.find( 'label > a' ).on( 'click', function ( ev ) {\n\t\t\tconst t = $( this ),\n\t\t\t\t$item = t.closest( '.filter-item' );\n\n\t\t\tev.preventDefault();\n\n\t\t\tif ( $item.is( '.disabled' ) && ! $item.is( '.active' ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst $input = t.parent().find( ':input' );\n\n\t\t\tif (\n\t\t\t\t$input.is( '[type=\"radio\"]' ) ||\n\t\t\t\t$input.is( '[type=\"checkbox\"]' )\n\t\t\t) {\n\t\t\t\t$input.prop( 'checked', ! $input.prop( 'checked' ) );\n\t\t\t}\n\n\t\t\t$input.change();\n\t\t} );\n\n\t\t// init tooltip\n\t\tthis._initTooltip( $filter );\n\n\t\t// init price slider\n\t\tthis._initPriceSlider( $filter );\n\n\t\t// init dropdown\n\t\tthis._initDropdown( $filter );\n\n\t\t// init collapsable\n\t\tthis._initCollapsable( $filter );\n\n\t\t// init clear anchors\n\t\tthis.maybeShowClearFilter( $filter );\n\n\t\t// init custom inputs\n\t\tif ( this.$preset?.hasClass( 'custom-style' ) ) {\n\t\t\tthis._initCustomInput( $filter );\n\t\t\t$filter.on( 'yith_wcan_dropdown_updated', function () {\n\t\t\t\tconst $dropdown = $( this ),\n\t\t\t\t\t$current = $dropdown.closest( '.yith-wcan-filter' );\n\n\t\t\t\tself._initCustomInput( $current );\n\t\t\t} );\n\t\t}\n\t}\n\n\t// init tooltip\n\t_initTooltip( $filter, position ) {\n\t\t$filter.find( '[data-title]' ).each( function () {\n\t\t\tconst t = $( this );\n\n\t\t\tif ( t.hasClass( 'tooltip-added' ) || ! t.data( 'title' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tt.on( 'mouseenter', function () {\n\t\t\t\tlet th = $( this ),\n\t\t\t\t\ttooltip = null,\n\t\t\t\t\twrapperWidth = th.outerWidth(),\n\t\t\t\t\tleft = 0,\n\t\t\t\t\twidth = 0;\n\n\t\t\t\tif (\n\t\t\t\t\t! position ||\n\t\t\t\t\t( 'top' !== position && 'right' !== position )\n\t\t\t\t) {\n\t\t\t\t\tconst container = th.closest( '.filter-item' );\n\n\t\t\t\t\tposition =\n\t\t\t\t\t\tcontainer.hasClass( 'color' ) ||\n\t\t\t\t\t\tcontainer.hasClass( 'label' )\n\t\t\t\t\t\t\t? 'top'\n\t\t\t\t\t\t\t: 'right';\n\t\t\t\t}\n\n\t\t\t\ttooltip = $( '<span>', {\n\t\t\t\t\tclass: 'yith-wcan-tooltip',\n\t\t\t\t\thtml: th.data( 'title' ),\n\t\t\t\t} );\n\n\t\t\t\tth.append( tooltip );\n\n\t\t\t\twidth = tooltip.outerWidth() + 6;\n\t\t\t\ttooltip.outerWidth( width );\n\n\t\t\t\tif ( 'top' === position ) {\n\t\t\t\t\tleft = ( wrapperWidth - width ) / 2;\n\t\t\t\t} else {\n\t\t\t\t\tleft = wrapperWidth + 15;\n\t\t\t\t}\n\n\t\t\t\ttooltip.css( { left: left.toFixed( 0 ) + 'px' } ).fadeIn( 200 );\n\n\t\t\t\tth.addClass( 'with-tooltip' );\n\t\t\t} ).on( 'mouseleave', function () {\n\t\t\t\tconst th = $( this );\n\n\t\t\t\tth.find( '.yith-wcan-tooltip' ).fadeOut( 200, function () {\n\t\t\t\t\tth.removeClass( 'with-tooltip' )\n\t\t\t\t\t\t.find( '.yith-wcan-tooltip' )\n\t\t\t\t\t\t.remove();\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\tt.addClass( 'tooltip-added' );\n\t\t} );\n\t}\n\n\t// init dropdown\n\t_initDropdown( $filter ) {\n\t\tconst $dropdown = $filter.find( 'select.filter-dropdown' );\n\n\t\tif ( ! $dropdown.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t$dropdown.hasClass( 'select2-hidden-accessible' ) &&\n\t\t\t'undefined' !== typeof $.fn.selectWoo\n\t\t) {\n\t\t\t$dropdown.selectWoo( 'destroy' );\n\t\t}\n\n\t\tthis._initDropdownObject( $dropdown, {\n\t\t\tpaginate: true,\n\t\t\tperPage: yith_wcan_shortcodes.terms_per_page,\n\t\t} );\n\t}\n\n\t// init dropdown object\n\t_initDropdownObject( $dropdown, opts ) {\n\t\treturn new YITH_WCAN_Dropdown( $dropdown, opts );\n\t}\n\n\t// init price slider\n\t_initPriceSlider( $filter ) {\n\t\tif ( ! $filter.hasClass( 'filter-price-slider' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst self = this,\n\t\t\t$container = $filter.find( '.price-slider' ),\n\t\t\t$minInput = $container.find( '.price-slider-min' ),\n\t\t\t$maxInput = $container.find( '.price-slider-max' ),\n\t\t\tmin = parseFloat( $container.data( 'min' ) ),\n\t\t\tmax = parseFloat( $container.data( 'max' ) ),\n\t\t\tcurrentMin = parseFloat( $minInput.val() ),\n\t\t\tcurrentMax = parseFloat( $maxInput.val() ),\n\t\t\tstep = parseFloat( $container.data( 'step' ) ),\n\t\t\thandleSliderChange = function () {\n\t\t\t\tif ( self.sliderTimeout ) {\n\t\t\t\t\tclearTimeout( self.sliderTimeout );\n\t\t\t\t}\n\n\t\t\t\tself.sliderTimeout = setTimeout( () => {\n\t\t\t\t\tself.maybeFilter( $filter );\n\t\t\t\t}, 200 );\n\t\t\t};\n\n\t\t$filter.find( '.price-slider-ui' ).ionRangeSlider( {\n\t\t\tskin: 'round',\n\t\t\ttype: 'double',\n\t\t\tmin,\n\t\t\tmax,\n\t\t\tstep,\n\t\t\tfrom: currentMin,\n\t\t\tto: currentMax,\n\t\t\tmin_interval: step,\n\t\t\tvalues_separator: ' - ',\n\t\t\tprettify: ( v ) => this.formatPrice( v ),\n\t\t\tonChange: ( data ) => {\n\t\t\t\t$minInput.val( data.from );\n\t\t\t\t$maxInput.val( data.to );\n\t\t\t},\n\t\t\tonFinish: handleSliderChange,\n\t\t} );\n\n\t\t$minInput\n\t\t\t.add( $maxInput )\n\t\t\t.off( 'change' )\n\t\t\t.on( 'keyup', () => {\n\t\t\t\tif ( ! $minInput.val() || ! $maxInput.val() ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thandleSliderChange();\n\t\t\t} );\n\t}\n\n\t// init collapsable\n\t_initCollapsable( $filter ) {\n\t\tthis._initTitleCollapsable( $filter );\n\t\tthis._initHierarchyCollapsable( $filter );\n\t}\n\n\t// init toggle on click of the title\n\t_initTitleCollapsable( $filter ) {\n\t\tconst $title = $filter.find( '.collapsable' );\n\n\t\tif ( ! $title.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._initToggle( $title, $title, $filter.find( '.filter-content' ) );\n\t}\n\n\t// init toggle on click of the parent li\n\t_initHierarchyCollapsable( $filter ) {\n\t\tconst $items = $filter.find( '.hierarchy-collapsable' );\n\n\t\tif ( ! $items.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// set parents of currently active term as open\n\t\tconst self = this,\n\t\t\tactive = $filter.find( '.active' );\n\n\t\tif ( active.length ) {\n\t\t\tactive\n\t\t\t\t.parents( '.hierarchy-collapsable' )\n\t\t\t\t.removeClass( 'closed' )\n\t\t\t\t.addClass( 'opened' );\n\n\t\t\tif (\n\t\t\t\tactive.hasClass( 'hierarchy-collapsable' ) &&\n\t\t\t\tyith_wcan_shortcodes.show_current_children\n\t\t\t) {\n\t\t\t\tactive.removeClass( 'closed' ).addClass( 'opened' );\n\t\t\t}\n\t\t}\n\n\t\t$items.each( function () {\n\t\t\tconst $t = $( this ),\n\t\t\t\t$toggle = $( '<span/>', {\n\t\t\t\t\tclass: 'toggle-handle',\n\t\t\t\t} );\n\n\t\t\t$toggle.appendTo( $t );\n\n\t\t\tself._initToggle( $toggle, $t, $t.children( 'ul.filter-items' ) );\n\t\t} );\n\t}\n\n\t// init toggle to generic toggle/target pair\n\t_initToggle( $toggle, $container, $target ) {\n\t\tif ( $container.hasClass( 'closed' ) ) {\n\t\t\t$target.hide();\n\t\t}\n\n\t\t$toggle.off( 'click' ).on( 'click', ( ev ) => {\n\t\t\tev.stopPropagation();\n\t\t\tev.preventDefault();\n\n\t\t\t$target.slideToggle( 400, () => {\n\t\t\t\t$container.toggleClass( 'opened' ).toggleClass( 'closed' );\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// init custom input\n\t_initCustomInput( $filter ) {\n\t\t$filter.find( ':input' ).each( function () {\n\t\t\tlet input = $( this ),\n\t\t\t\ttype = input.attr( 'type' ),\n\t\t\t\tcontainerClass = `${ type }button`,\n\t\t\t\tcontainer;\n\n\t\t\tif ( 'checkbox' !== type && 'radio' !== type ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( input.closest( `.${ containerClass }` ).length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( input.is( ':checked' ) ) {\n\t\t\t\tcontainerClass += ' checked';\n\t\t\t}\n\n\t\t\tcontainer = $( '<span/>', {\n\t\t\t\tclass: containerClass,\n\t\t\t} );\n\n\t\t\tinput.wrap( container ).on( 'change', function () {\n\t\t\t\tconst t = $( this );\n\n\t\t\t\tt.prop( 'checked' )\n\t\t\t\t\t? t.parent().addClass( 'checked' )\n\t\t\t\t\t: t.parent().removeClass( 'checked' );\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// register initial status\n\t_regiterStatus() {\n\t\tthis.originalFilters = this.getFiltersProperties();\n\t}\n\n\t// trigger handling after layout change\n\t_afterLayoutChange() {\n\t\tif ( this.isMobile ) {\n\t\t\tthis.$preset\n\t\t\t\t.addClass( 'filters-modal' )\n\t\t\t\t.attr( 'role', 'dialog' )\n\t\t\t\t.attr( 'tabindex', '-1' )\n\t\t\t\t.hide();\n\n\t\t\tthis._addCloseModalButton();\n\t\t\tthis._addApplyFiltersModalButton();\n\t\t\tthis._switchToCollapsables();\n\n\t\t\tthis.$filterButtons?.hide();\n\t\t} else {\n\t\t\tthis.$preset\n\t\t\t\t.removeClass( 'filters-modal' )\n\t\t\t\t.removeClass( 'open' )\n\t\t\t\t.removeAttr( 'role' )\n\t\t\t\t.removeAttr( 'tabindex' )\n\t\t\t\t.show();\n\n\t\t\t$( 'body' )\n\t\t\t\t.css( 'overflow', 'auto' )\n\t\t\t\t.removeClass( 'yith-wcan-preset-modal-open' );\n\n\t\t\tthis._removeCloseModalButton();\n\t\t\tthis._removeApplyFiltersModalButton();\n\t\t\tthis._switchBackCollapsables();\n\n\t\t\tthis.$filterButtons?.show();\n\t\t}\n\t}\n\n\t// add modal close button\n\t_addCloseModalButton() {\n\t\tconst $closeButton = $( '<a/>', {\n\t\t\tclass: 'close-button',\n\t\t\thtml: '&times;',\n\t\t\t'data-dismiss': 'modal',\n\t\t\t'aria-label': yith_wcan_shortcodes.labels.close,\n\t\t} );\n\n\t\t$closeButton\n\t\t\t.prependTo( this.$preset )\n\t\t\t.on( 'click', this.closeModal.bind( this ) );\n\t\tthis.modalElements.closeButton = $closeButton;\n\t}\n\n\t// remove modal close button\n\t_removeCloseModalButton() {\n\t\tthis.modalElements?.closeButton?.remove();\n\t}\n\n\t// show main filter button for the modal\n\t_addApplyFiltersModalButton() {\n\t\tconst $filterButton = $( '<button/>', {\n\t\t\tclass: 'apply-filters main-modal-button',\n\t\t\thtml: yith_wcan_shortcodes.labels.show_results,\n\t\t\t'data-dismiss': 'modal',\n\t\t} );\n\n\t\t$filterButton.appendTo( this.$preset ).on( 'click', () => {\n\t\t\tthis.filter();\n\t\t\tthis.closeModal();\n\t\t} );\n\t\tthis.modalElements.applyFiltersButton = $filterButton;\n\t}\n\n\t// hide main filter button for the modal\n\t_removeApplyFiltersModalButton() {\n\t\tthis.modalElements?.applyFiltersButton?.remove();\n\t}\n\n\t// convert all filters to collapsable\n\t_switchToCollapsables() {\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this ),\n\t\t\t\t$title = $filter.find( '.filter-title' );\n\n\t\t\tif ( ! $title.length || $title.hasClass( 'collapsable' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$title.addClass( 'collapsable' ).data( 'disable-collapse', true );\n\n\t\t\tself._initTitleCollapsable( $filter );\n\t\t} );\n\t}\n\n\t// switch back filters to their previous collapsable state\n\t_switchBackCollapsables() {\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this ),\n\t\t\t\t$title = $filter.find( '.filter-title' );\n\n\t\t\tif (\n\t\t\t\t! $title.length ||\n\t\t\t\t! $title.hasClass( 'collapsable' ) ||\n\t\t\t\t! $title.data( 'disable-collapse' )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$title\n\t\t\t\t.removeClass( 'collapsable' )\n\t\t\t\t.removeData( 'disable-collapse', true )\n\t\t\t\t.off( 'click' );\n\n\t\t\t$filter.find( '.filter-content' ).show();\n\t\t} );\n\t}\n\n\t// close all collpasable before showing modal\n\t_openAllCollapsables() {\n\t\tthis.$filters\n\t\t\t.not( '.no-title' )\n\t\t\t.not( ( i, v ) => {\n\t\t\t\treturn this.isFilterActive( $( v ) );\n\t\t\t} )\n\t\t\t.find( '.filter-content' )\n\t\t\t.show()\n\t\t\t.end()\n\t\t\t.find( '.filter-title' )\n\t\t\t.removeClass( 'closed' )\n\t\t\t.addClass( 'opened' );\n\t}\n\n\t// close all collpasable before showing modal\n\t_closeAllCollapsables() {\n\t\tthis.$filters\n\t\t\t.not( '.no-title' )\n\t\t\t.not( ( i, v ) => {\n\t\t\t\treturn this.isFilterActive( $( v ) );\n\t\t\t} )\n\t\t\t.find( '.filter-content' )\n\t\t\t.hide()\n\t\t\t.end()\n\t\t\t.find( '.filter-title' )\n\t\t\t.addClass( 'closed' )\n\t\t\t.removeClass( 'opened' );\n\t}\n\n\t// update status change flag, if filters have changed\n\tmaybeRegisterStatusChange() {\n\t\tconst currentFilters = this.getFiltersProperties(),\n\t\t\tcurrentStr = JSON.stringify( currentFilters ),\n\t\t\toriginalStr = JSON.stringify( this.originalFilters );\n\n\t\tthis.dirty = currentStr !== originalStr;\n\t}\n\n\t// apply filters when possible\n\tmaybeFilter( $initiator ) {\n\t\t// register status change\n\t\tthis.maybeRegisterStatusChange();\n\n\t\t// filter, or show filter button.\n\t\tif ( yith_wcan_shortcodes.instant_filters && ! this.isMobile ) {\n\t\t\tthis.filter();\n\t\t} else if (\n\t\t\t! yith_wcan_shortcodes.instant_filters &&\n\t\t\t! this.isMobile\n\t\t) {\n\t\t\tthis.dirty\n\t\t\t\t? this.$filterButtons?.show()\n\t\t\t\t: this.$filterButtons?.hide();\n\t\t} else if ( this.isMobile && this.dirty ) {\n\t\t\tthis.$preset.addClass( 'with-filter-button' );\n\t\t\tthis.modalElements.applyFiltersButton?.show();\n\t\t}\n\t}\n\n\t// main filtering method\n\tfilter() {\n\t\tconst filter = window?.product_filter;\n\n\t\tfilter\n\t\t\t?.doFilter( this.getFiltersProperties(), this.target, this.preset )\n\t\t\t?.done( () => {\n\t\t\t\tlet newPreset = $( this.preset );\n\n\t\t\t\tif (\n\t\t\t\t\t! this.isMobile &&\n\t\t\t\t\tnewPreset.length &&\n\t\t\t\t\tyith_wcan_shortcodes.scroll_top\n\t\t\t\t) {\n\t\t\t\t\tlet targetOffset = newPreset.offset().top;\n\n\t\t\t\t\tif ( !! yith_wcan_shortcodes.scroll_target ) {\n\t\t\t\t\t\tconst scrollTarget = $(\n\t\t\t\t\t\t\tyith_wcan_shortcodes.scroll_target\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\ttargetOffset = scrollTarget.length\n\t\t\t\t\t\t\t? scrollTarget.offset().top\n\t\t\t\t\t\t\t: targetOffset;\n\t\t\t\t\t}\n\t\t\t\t\t$( 'body, html' ).animate( {\n\t\t\t\t\t\tscrollTop: targetOffset - 100,\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t// register new filters, clear status flag\n\t\t\t\tthis.originalFilters = this.getFiltersProperties();\n\t\t\t\tthis.dirty = false;\n\t\t\t} );\n\n\t\tif ( this.isMobile ) {\n\t\t\tthis.$preset.removeClass( 'with-filter-button' );\n\t\t\tthis.modalElements.applyFiltersButton?.hide();\n\t\t\tthis.closeModal();\n\t\t}\n\t}\n\n\t// get all filter nodes\n\tgetFilters() {\n\t\tif ( false === this.$filters ) {\n\t\t\tthis.$filters = this.$preset.find( '.yith-wcan-filter' );\n\t\t}\n\n\t\treturn this.$filters;\n\t}\n\n\t// retrieves all filters that we want to apply\n\tgetActiveFilters() {\n\t\tif ( false === this.activeFilters ) {\n\t\t\tthis.activeFilters = this.getFiltersProperties();\n\t\t}\n\n\t\treturn this.activeFilters;\n\t}\n\n\t// check whether there is any filter active\n\tisAnyFilterActive() {\n\t\treturn !! Object.keys( this.getActiveFilters() ).length;\n\t}\n\n\t// checks whether current filter is active\n\tisFilterActive( $filter ) {\n\t\tlet filterType = $filter.data( 'filter-type' ),\n\t\t\tactive,\n\t\t\tfilteredActive;\n\n\t\tswitch ( filterType ) {\n\t\t\tcase 'tax':\n\t\t\tcase 'review':\n\t\t\tcase 'price_range':\n\t\t\t\tconst $dropdown = $filter.find( '.filter-dropdown' );\n\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tconst val = $dropdown.val();\n\n\t\t\t\t\tactive = 'object' === typeof val ? !! val?.length : !! val;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t// if we use type other than dropdown, fallthrough\n\t\t\tcase 'stock_sale':\n\t\t\t\tactive = $filter.find( '.filter-item' ).filter( '.active' )\n\t\t\t\t\t.length;\n\t\t\t\tbreak;\n\t\t\tcase 'price_slider':\n\t\t\t\tconst step = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider' ).data( 'step' )\n\t\t\t\t\t),\n\t\t\t\t\tmin = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider' ).data( 'min' )\n\t\t\t\t\t),\n\t\t\t\t\tmax = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider' ).data( 'max' )\n\t\t\t\t\t),\n\t\t\t\t\tcurrentMin = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider-min' ).val()\n\t\t\t\t\t),\n\t\t\t\t\tcurrentMax = parseFloat(\n\t\t\t\t\t\t$filter.find( '.price-slider-max' ).val()\n\t\t\t\t\t);\n\n\t\t\t\tactive =\n\t\t\t\t\tMath.abs( currentMin - min ) >= step ||\n\t\t\t\t\tMath.abs( currentMax - max ) >= step;\n\t\t\t\tbreak;\n\t\t\tcase 'orderby':\n\t\t\t\tactive =\n\t\t\t\t\t'menu_order' !== $filter.find( '.filter-order-by' ).val();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tactive = false;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tfilteredActive = $filter.triggerHandler( 'yith_wcan_is_filter_active', [\n\t\t\tactive,\n\t\t\tthis,\n\t\t] );\n\t\tactive =\n\t\t\ttypeof filteredActive !== 'undefined' ? filteredActive : active;\n\n\t\treturn active;\n\t}\n\n\t// count the number of active items per filter\n\tcountActiveItems( $filter ) {\n\t\tlet filterType = $filter.data( 'filter-type' ),\n\t\t\tcount;\n\n\t\tswitch ( filterType ) {\n\t\t\tcase 'tax':\n\t\t\tcase 'review':\n\t\t\tcase 'price_range':\n\t\t\t\tconst $dropdown = $filter.find( '.filter-dropdown' );\n\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tconst val = $dropdown.val();\n\n\t\t\t\t\tcount = 'object' === typeof val ? val?.length : +!! val;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t// if we use type other than dropdown, fallthrough\n\t\t\tcase 'stock_sale':\n\t\t\t\tcount = $filter.find( '.filter-items' ).find( '.active' )\n\t\t\t\t\t.length;\n\t\t\t\tbreak;\n\t\t\tcase 'orderby':\n\t\t\t\tif ( this.isFilterActive( $filter ) ) {\n\t\t\t\t\tcount = 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_slider':\n\t\t\tdefault:\n\t\t\t\tcount = 0;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn count;\n\t}\n\n\t// retrieves filter properties for the filter\n\tgetFilterProperties( $filter ) {\n\t\tlet filterType = $filter.data( 'filter-type' ),\n\t\t\tmultiple = 'yes' === $filter.data( 'multiple' ),\n\t\t\t$dropdown = $filter.find( '.filter-dropdown' ),\n\t\t\tproperties = {},\n\t\t\tfilteredProperties,\n\t\t\t$active;\n\n\t\tswitch ( filterType ) {\n\t\t\tcase 'tax':\n\t\t\t\tlet activeTerms = [],\n\t\t\t\t\ttaxonomy = $filter.data( 'taxonomy' ),\n\t\t\t\t\tisAttr = 0 === taxonomy.indexOf( 'filter' ),\n\t\t\t\t\trelation = $filter.data( 'relation' );\n\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( multiple ) {\n\t\t\t\t\t\tactiveTerms = $dropdown.val();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tactiveTerms.push( $dropdown.val() );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$active = $filter\n\t\t\t\t\t\t.find( '.filter-item' )\n\t\t\t\t\t\t.filter( '.active' )\n\t\t\t\t\t\t.children( 'a, label' );\n\n\t\t\t\t\tactiveTerms = $active.get().reduce( function ( a, v ) {\n\t\t\t\t\t\tlet val;\n\n\t\t\t\t\t\tv = $( v );\n\t\t\t\t\t\tval = v.is( 'label' )\n\t\t\t\t\t\t\t? v.find( ':input' ).val()\n\t\t\t\t\t\t\t: v.data( 'term-slug' );\n\n\t\t\t\t\t\tif ( ! val ) {\n\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ta.push( val );\n\n\t\t\t\t\t\treturn a;\n\t\t\t\t\t}, activeTerms );\n\t\t\t\t}\n\n\t\t\t\tif ( ! multiple ) {\n\t\t\t\t\tproperties[ taxonomy ] = activeTerms.pop();\n\t\t\t\t} else {\n\t\t\t\t\tconst glue = ! isAttr && 'and' === relation ? '+' : ',';\n\t\t\t\t\tproperties[ taxonomy ] = activeTerms.join( glue );\n\t\t\t\t}\n\n\t\t\t\tif ( isAttr ) {\n\t\t\t\t\tproperties[\n\t\t\t\t\t\ttaxonomy.replace( 'filter_', 'query_type_' )\n\t\t\t\t\t] = relation;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'review':\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tproperties.rating_filter = $dropdown.val();\n\t\t\t\t} else {\n\t\t\t\t\t$active = $filter\n\t\t\t\t\t\t.find( '.filter-item' )\n\t\t\t\t\t\t.filter( '.active' )\n\t\t\t\t\t\t.children( 'a, label' );\n\n\t\t\t\t\tif ( ! multiple ) {\n\t\t\t\t\t\t$active = $active.first();\n\t\t\t\t\t\tproperties.rating_filter = $active.is( 'label' )\n\t\t\t\t\t\t\t? $active.find( ':input' ).val()\n\t\t\t\t\t\t\t: $active.data( 'rating' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tproperties.rating_filter = $active\n\t\t\t\t\t\t\t.get()\n\t\t\t\t\t\t\t.reduce( function ( a, v ) {\n\t\t\t\t\t\t\t\tlet val;\n\n\t\t\t\t\t\t\t\tv = $( v );\n\t\t\t\t\t\t\t\tval = v.is( 'label' )\n\t\t\t\t\t\t\t\t\t? v.find( ':input' ).val()\n\t\t\t\t\t\t\t\t\t: v.data( 'rating' );\n\n\t\t\t\t\t\t\t\tif ( ! val ) {\n\t\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ta.push( val );\n\n\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t}, [] )\n\t\t\t\t\t\t\t.join( ',' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_range':\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( multiple ) {\n\t\t\t\t\t\tproperties.price_ranges = $dropdown.val().join( ',' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tproperties.min_price = $dropdown\n\t\t\t\t\t\t\t.val()\n\t\t\t\t\t\t\t.split( '-' )[ 0 ];\n\t\t\t\t\t\tproperties.max_price = $dropdown\n\t\t\t\t\t\t\t.val()\n\t\t\t\t\t\t\t.split( '-' )[ 1 ];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$active = $filter\n\t\t\t\t\t\t.find( '.filter-item' )\n\t\t\t\t\t\t.filter( '.active' )\n\t\t\t\t\t\t.children( 'a, label' );\n\n\t\t\t\t\tif ( multiple ) {\n\t\t\t\t\t\tproperties.price_ranges = $active\n\t\t\t\t\t\t\t.get()\n\t\t\t\t\t\t\t.reduce( ( a, v ) => {\n\t\t\t\t\t\t\t\tlet min = $( v ).data( 'range-min' ),\n\t\t\t\t\t\t\t\t\tmax = $( v ).data( 'range-max' );\n\n\t\t\t\t\t\t\t\ta += ( max ? `${ min }-${ max }` : min ) + ',';\n\n\t\t\t\t\t\t\t\treturn a;\n\t\t\t\t\t\t\t}, '' )\n\t\t\t\t\t\t\t.replace( /^(.*),$/, '$1' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tproperties.min_price = parseFloat(\n\t\t\t\t\t\t\t$active.first().data( 'range-min' )\n\t\t\t\t\t\t);\n\t\t\t\t\t\tproperties.max_price = parseFloat(\n\t\t\t\t\t\t\t$active.first().data( 'range-max' )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_slider':\n\t\t\t\tproperties.min_price = parseFloat(\n\t\t\t\t\t$filter.find( '.price-slider-min' ).val()\n\t\t\t\t);\n\t\t\t\tproperties.max_price = parseFloat(\n\t\t\t\t\t$filter.find( '.price-slider-max' ).val()\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase 'stock_sale':\n\t\t\t\tif ( $filter.find( '.filter-on-sale' ).is( '.active' ) ) {\n\t\t\t\t\tproperties.onsale_filter = 1;\n\t\t\t\t}\n\t\t\t\tif ( $filter.find( '.filter-in-stock' ).is( '.active' ) ) {\n\t\t\t\t\tproperties.instock_filter = 1;\n\t\t\t\t}\n\t\t\t\tif ( $filter.find( '.filter-featured' ).is( '.active' ) ) {\n\t\t\t\t\tproperties.featured_filter = 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'orderby':\n\t\t\t\tproperties.orderby = $filter.find( '.filter-order-by' ).val();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\tfilteredProperties = $filter.triggerHandler(\n\t\t\t'yith_wcan_filter_properties',\n\t\t\t[ properties, self ]\n\t\t);\n\t\tproperties =\n\t\t\ttypeof filteredProperties !== 'undefined'\n\t\t\t\t? filteredProperties\n\t\t\t\t: properties;\n\n\t\treturn properties;\n\t}\n\n\t// retrieves properties for all filters of the preset\n\tgetFiltersProperties() {\n\t\tlet properties = {};\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tif ( self.isFilterActive( $filter ) ) {\n\t\t\t\tconst filterProperties = self.getFilterProperties( $filter );\n\n\t\t\t\tproperties = self.mergeProperties(\n\t\t\t\t\tproperties,\n\t\t\t\t\tfilterProperties,\n\t\t\t\t\t$filter\n\t\t\t\t);\n\t\t\t}\n\t\t} );\n\n\t\treturn properties;\n\t}\n\n\t// retrieve filters matching any of the properties passed\n\tgetFiltersByProperties( properties ) {\n\t\tconst self = this;\n\n\t\treturn this.getFilters().filter( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tif ( self.isFilterActive( $filter ) ) {\n\t\t\t\tlet filterProperties = self.getFilterProperties( $filter ),\n\t\t\t\t\thasProp = false;\n\n\t\t\t\tfor ( const prop in properties ) {\n\t\t\t\t\tif (\n\t\t\t\t\t\t[ 'min_price', 'max_price', 'price_ranges' ].includes(\n\t\t\t\t\t\t\tprop\n\t\t\t\t\t\t) &&\n\t\t\t\t\t\t( filterProperties.min_price ||\n\t\t\t\t\t\t\tfilterProperties.price_ranges )\n\t\t\t\t\t) {\n\t\t\t\t\t\thasProp = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else if ( filterProperties[ prop ] ) {\n\t\t\t\t\t\thasProp = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn hasProp;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t} );\n\t}\n\n\t// show clear selection anchor\n\tmaybeToggleClearFilter( $filter ) {\n\t\tif ( ! this.isFilterActive( $filter ) ) {\n\t\t\tthis.maybeHideClearFilter( $filter );\n\t\t} else {\n\t\t\tthis.maybeShowClearFilter( $filter );\n\t\t}\n\t}\n\n\t// show clear all selections anchor\n\tmaybeToggleClearAllFilters() {\n\t\tif ( ! this.isAnyFilterActive() ) {\n\t\t\tthis.maybeHideClearAllFilters();\n\t\t} else {\n\t\t\tthis.maybeShowClearAllFilters();\n\t\t}\n\t}\n\n\t// show clear selection anchor\n\tmaybeShowClearFilter( $filter ) {\n\t\tif (\n\t\t\t! this.isFilterActive( $filter ) ||\n\t\t\t! yith_wcan_shortcodes.show_clear_filter\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove clear selection link if already added.\n\t\t$filter.find( '.clear-selection' ).remove();\n\n\t\t// add new clear selection link.\n\t\t$( '<a/>', {\n\t\t\tclass: 'clear-selection',\n\t\t\ttext: yith_wcan_shortcodes.labels.clear_selection,\n\t\t\trole: 'button',\n\t\t} )\n\t\t\t.prependTo( $filter.find( '.filter-content' ) )\n\t\t\t.on( 'click', ( ev ) => {\n\t\t\t\tev.preventDefault();\n\n\t\t\t\tthis.deactivateFilter(\n\t\t\t\t\t$filter,\n\t\t\t\t\tfalse,\n\t\t\t\t\tyith_wcan_shortcodes.instant_filters\n\t\t\t\t);\n\t\t\t\tthis.maybeHideClearFilter( $filter );\n\n\t\t\t\tif ( yith_wcan_shortcodes.instant_filters ) {\n\t\t\t\t\tthis.closeModal();\n\t\t\t\t}\n\t\t\t} );\n\t}\n\n\t// show clearAll anchor, when on mobile layout\n\tmaybeShowClearAllFilters() {\n\t\tif ( ! this.isAnyFilterActive() || ! this.isMobile ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove clear selection link if already added.\n\t\tthis.$preset.find( '.clear-selection' ).remove();\n\n\t\t// add new clear selection link.\n\t\t$( '<a/>', {\n\t\t\tclass: 'clear-selection',\n\t\t\ttext: yith_wcan_shortcodes.labels.clear_all_selections,\n\t\t\trole: 'button',\n\t\t} )\n\t\t\t.prependTo( this.$preset.find( '.filters-container' ) )\n\t\t\t.on( 'click', ( ev ) => {\n\t\t\t\tev.preventDefault();\n\n\t\t\t\tthis.deactivateAllFilters(\n\t\t\t\t\tyith_wcan_shortcodes.instant_filters\n\t\t\t\t);\n\t\t\t\tthis.maybeHideClearAllFilters();\n\n\t\t\t\tif ( yith_wcan_shortcodes.instant_filters ) {\n\t\t\t\t\tthis.closeModal();\n\t\t\t\t}\n\t\t\t} );\n\t}\n\n\t// hide clear selection anchor\n\tmaybeHideClearFilter( $filter ) {\n\t\tif (\n\t\t\tthis.isFilterActive( $filter ) ||\n\t\t\t! yith_wcan_shortcodes.show_clear_filter\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove clear selection link.\n\t\t$filter.find( '.clear-selection' ).remove();\n\t}\n\n\t// show clearAll anchor, when on mobile layout\n\tmaybeHideClearAllFilters() {\n\t\tif ( this.isAnyFilterActive() ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove clear selection link.\n\t\tthis.$preset\n\t\t\t.find( '.filters-container' )\n\t\t\t.children( '.clear-selection' )\n\t\t\t.remove();\n\t}\n\n\t// deactivate filter\n\tdeactivateFilter( $filter, properties, doFilter ) {\n\t\tconst filterType = $filter.data( 'filter-type' ),\n\t\t\t$items = $filter.find( '.filter-item' ),\n\t\t\t$activeItems = $items.filter( '.active' ),\n\t\t\t$dropdown = $filter.find( '.filter-dropdown' );\n\n\t\tswitch ( filterType ) {\n\t\t\tcase 'tax':\n\t\t\t\tconst taxonomy = $filter.data( 'taxonomy' );\n\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( ! properties ) {\n\t\t\t\t\t\t$dropdown.find( 'option' ).prop( 'selected', false );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$dropdown.find( 'option' ).each( function () {\n\t\t\t\t\t\t\tconst $option = $( this );\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t$option.val().toString() ===\n\t\t\t\t\t\t\t\tproperties[ taxonomy ].toString()\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t$option.prop( 'selected', false );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$dropdown.change();\n\t\t\t\t} else if ( ! properties ) {\n\t\t\t\t\t$activeItems.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t$activeItems.removeClass( 'active' );\n\t\t\t\t} else {\n\t\t\t\t\t$activeItems.each( function () {\n\t\t\t\t\t\tlet $item = $( this ),\n\t\t\t\t\t\t\t$label = $item.children( 'label' ),\n\t\t\t\t\t\t\t$anchor = $item.children( 'a' ),\n\t\t\t\t\t\t\tvalue;\n\n\t\t\t\t\t\tvalue = $label.length\n\t\t\t\t\t\t\t? $label.find( ':input' ).val()\n\t\t\t\t\t\t\t: $anchor.data( 'term-slug' );\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tvalue.toString() ===\n\t\t\t\t\t\t\tproperties[ taxonomy ].toString()\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t$item.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t\t\t$item.removeClass( 'active' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'review':\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( ! properties ) {\n\t\t\t\t\t\t$dropdown.find( 'option' ).prop( 'selected', false );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$dropdown.find( 'option' ).each( function () {\n\t\t\t\t\t\t\tconst $option = $( this );\n\n\t\t\t\t\t\t\tif ( $option.val() === properties.rating_filter ) {\n\t\t\t\t\t\t\t\t$option.prop( 'selected', false );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$dropdown.change();\n\t\t\t\t} else if ( ! properties ) {\n\t\t\t\t\t$activeItems.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t$activeItems.removeClass( 'active' );\n\t\t\t\t} else {\n\t\t\t\t\t$activeItems.each( function () {\n\t\t\t\t\t\tlet $item = $( this ),\n\t\t\t\t\t\t\t$label = $item.children( 'label' ),\n\t\t\t\t\t\t\t$anchor = $item.children( 'a' ),\n\t\t\t\t\t\t\tvalue;\n\n\t\t\t\t\t\tvalue = $label.length\n\t\t\t\t\t\t\t? $label.find( ':input' ).val()\n\t\t\t\t\t\t\t: $anchor.data( 'rating' );\n\n\t\t\t\t\t\tif ( value === properties.rating_filter ) {\n\t\t\t\t\t\t\t$item.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t\t\t$item.removeClass( 'active' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_range':\n\t\t\t\tif ( $dropdown.length ) {\n\t\t\t\t\tif ( ! properties ) {\n\t\t\t\t\t\t$dropdown.find( 'option' ).prop( 'selected', false );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$dropdown.find( 'option' ).each( function () {\n\t\t\t\t\t\t\tconst $option = $( this ),\n\t\t\t\t\t\t\t\tformattedRange =\n\t\t\t\t\t\t\t\t\tproperties.min_price +\n\t\t\t\t\t\t\t\t\t( properties.max_price\n\t\t\t\t\t\t\t\t\t\t? `-${ properties.max_price }`\n\t\t\t\t\t\t\t\t\t\t: '' );\n\n\t\t\t\t\t\t\tif ( $option.val() === formattedRange ) {\n\t\t\t\t\t\t\t\t$option.prop( 'selected', false );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\t$dropdown.change();\n\t\t\t\t} else if ( ! properties ) {\n\t\t\t\t\t$activeItems.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t$activeItems.removeClass( 'active' );\n\t\t\t\t} else {\n\t\t\t\t\t$activeItems.each( function () {\n\t\t\t\t\t\tlet $item = $( this ),\n\t\t\t\t\t\t\t$label = $item.children( 'label' ),\n\t\t\t\t\t\t\t$anchor = $item.children( 'a' ),\n\t\t\t\t\t\t\tformattedRange,\n\t\t\t\t\t\t\tvalue;\n\n\t\t\t\t\t\tvalue = $label.length\n\t\t\t\t\t\t\t? $label.find( ':input' ).val()\n\t\t\t\t\t\t\t: $anchor.data( 'min_price' ) +\n\t\t\t\t\t\t\t  ( $anchor.data( 'max_price' )\n\t\t\t\t\t\t\t\t\t? '-' + $anchor.data( 'max_price' )\n\t\t\t\t\t\t\t\t\t: '' );\n\n\t\t\t\t\t\tif ( properties.min_price ) {\n\t\t\t\t\t\t\tformattedRange =\n\t\t\t\t\t\t\t\tproperties.min_price +\n\t\t\t\t\t\t\t\t( properties.max_price\n\t\t\t\t\t\t\t\t\t? '-' + properties.max_price\n\t\t\t\t\t\t\t\t\t: '' );\n\t\t\t\t\t\t} else if ( properties.price_ranges ) {\n\t\t\t\t\t\t\tformattedRange = properties.price_ranges;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( value === formattedRange ) {\n\t\t\t\t\t\t\t$item.children( 'label' ).children( 'a' ).click();\n\t\t\t\t\t\t\t$item.removeClass( 'active' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'price_slider':\n\t\t\t\tconst $priceSlider = $filter.find( '.price-slider' );\n\n\t\t\t\t$filter\n\t\t\t\t\t.find( '.price-slider-min' )\n\t\t\t\t\t.val( $priceSlider.data( 'min' ) );\n\t\t\t\t$filter\n\t\t\t\t\t.find( '.price-slider-max' )\n\t\t\t\t\t.val( $priceSlider.data( 'max' ) )\n\t\t\t\t\t.change();\n\t\t\t\tbreak;\n\t\t\tcase 'orderby':\n\t\t\t\t$filter.find( 'select' ).val( 'menu_order' );\n\t\t\t\tbreak;\n\t\t\tcase 'stock_sale':\n\t\t\t\tif ( ! properties ) {\n\t\t\t\t\t$filter\n\t\t\t\t\t\t.find( '.filter-in-stock' )\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t.change();\n\t\t\t\t\t$filter\n\t\t\t\t\t\t.find( '.filter-on-sale' )\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t.change();\n\t\t\t\t\t$filter\n\t\t\t\t\t\t.find( '.filter-featured' )\n\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t.change();\n\n\t\t\t\t\t$items.removeClass( 'active' );\n\t\t\t\t} else {\n\t\t\t\t\tif ( properties?.instock_filter ) {\n\t\t\t\t\t\t$filter\n\t\t\t\t\t\t\t.find( '.filter-in-stock' )\n\t\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t\t.change()\n\t\t\t\t\t\t\t.closest( '.filter-item' )\n\t\t\t\t\t\t\t.removeClass( 'active' );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( properties?.onsale_filter ) {\n\t\t\t\t\t\t$filter\n\t\t\t\t\t\t\t.find( '.filter-on-sale' )\n\t\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t\t.change()\n\t\t\t\t\t\t\t.closest( '.filter-item' )\n\t\t\t\t\t\t\t.removeClass( 'active' );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( properties?.featured_filter ) {\n\t\t\t\t\t\t$filter\n\t\t\t\t\t\t\t.find( '.filter-featured' )\n\t\t\t\t\t\t\t.find( ':input' )\n\t\t\t\t\t\t\t.prop( 'checked', false )\n\t\t\t\t\t\t\t.change()\n\t\t\t\t\t\t\t.closest( '.filter-item' )\n\t\t\t\t\t\t\t.removeClass( 'active' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t$items.removeClass( 'active' );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.activeFilters = false;\n\n\t\tif ( doFilter ) {\n\t\t\tthis.filter();\n\t\t}\n\t}\n\n\t// deactivate all filters\n\tdeactivateAllFilters( doFilter ) {\n\t\tconst self = this,\n\t\t\t$filters = this.getFilters();\n\n\t\t$filters.each( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tself.deactivateFilter( $filter );\n\t\t} );\n\n\t\tthis.activeFilters = false;\n\n\t\tif ( doFilter ) {\n\t\t\tthis.filter();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t// deactivate filters that matches a specific set of properties\n\tdeactivateFilterByProperties( properties, doFilter ) {\n\t\tconst self = this,\n\t\t\t$filters = this.getFiltersByProperties( properties );\n\n\t\tif ( ! $filters.length ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t$filters.each( function () {\n\t\t\tconst $filter = $( this );\n\n\t\t\tself.deactivateFilter( $filter, properties, doFilter );\n\t\t} );\n\n\t\treturn true;\n\t}\n\n\t// open filters as a modal, when in mobile layout\n\topenModal() {\n\t\tif ( ! this.isMobile ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( yith_wcan_shortcodes.toggles_open_on_modal ) {\n\t\t\tthis._openAllCollapsables();\n\t\t} else {\n\t\t\tthis._closeAllCollapsables();\n\t\t}\n\n\t\t$( 'body' )\n\t\t\t.css( 'overflow', 'hidden' )\n\t\t\t.addClass( 'yith-wcan-preset-modal-open' );\n\n\t\tthis.$preset.show();\n\n\t\tsetTimeout( () => {\n\t\t\tthis.$preset.addClass( 'open' );\n\t\t}, 100 );\n\t}\n\n\t// close filters modal, when in mobile layout\n\tcloseModal() {\n\t\tif ( ! this.isMobile ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$preset.removeClass( 'open' );\n\n\t\tsetTimeout( () => {\n\t\t\tthis.$preset.hide();\n\t\t\t$( 'body' )\n\t\t\t\t.css( 'overflow', 'auto' )\n\t\t\t\t.removeClass( 'yith-wcan-preset-modal-open' );\n\t\t}, 300 );\n\t}\n\n\t// utility that formats the price according to store configuration.\n\tformatPrice( price ) {\n\t\tif ( 'undefined' !== typeof accounting ) {\n\t\t\tprice = accounting.formatMoney( price, {\n\t\t\t\tsymbol: yith_wcan_shortcodes.currency_format.symbol,\n\t\t\t\tdecimal: yith_wcan_shortcodes.currency_format.decimal,\n\t\t\t\tthousand: yith_wcan_shortcodes.currency_format.thousand,\n\t\t\t\tprecision: 0,\n\t\t\t\tformat: yith_wcan_shortcodes.currency_format.format,\n\t\t\t} );\n\t\t}\n\n\t\treturn price;\n\t}\n\n\t// utility that merges together sets of filter properties\n\tmergeProperties( set1, set2, $filter ) {\n\t\t// search for common properties\n\t\tfor ( const prop in set2 ) {\n\t\t\tif ( ! set2.hasOwnProperty( prop ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif ( !! set1[ prop ] ) {\n\t\t\t\tswitch ( prop ) {\n\t\t\t\t\tcase 'rating_filter':\n\t\t\t\t\tcase 'min_price':\n\t\t\t\t\tcase 'max_price':\n\t\t\t\t\tcase 'onsale_filter':\n\t\t\t\t\tcase 'instock_filter':\n\t\t\t\t\tcase 'orderby':\n\t\t\t\t\t\t// just override default value\n\t\t\t\t\t\tset1[ prop ] = set2[ prop ];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif ( 0 === prop.indexOf( 'query_type_' ) ) {\n\t\t\t\t\t\t\t// query_type param\n\t\t\t\t\t\t\tset1[ prop ] = set2[ prop ];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// we're dealing with taxonomy\n\t\t\t\t\t\t\tconst isAttr = 0 === prop.indexOf( 'filter_' ),\n\t\t\t\t\t\t\t\tglue = isAttr ? ',' : '+';\n\n\t\t\t\t\t\t\tlet newValue =\n\t\t\t\t\t\t\t\tset1[ prop ].replace( ',', glue ) +\n\t\t\t\t\t\t\t\tglue +\n\t\t\t\t\t\t\t\tset2[ prop ].replace( ',', glue );\n\n\t\t\t\t\t\t\tnewValue = newValue\n\t\t\t\t\t\t\t\t.split( glue )\n\t\t\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t\t\t( value, index, arr ) =>\n\t\t\t\t\t\t\t\t\t\tarr.indexOf( value ) === index\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.join( glue );\n\n\t\t\t\t\t\t\tset1[ prop ] = newValue;\n\n\t\t\t\t\t\t\tif ( isAttr ) {\n\t\t\t\t\t\t\t\tconst queryTypeParam = prop.replace(\n\t\t\t\t\t\t\t\t\t'filter_',\n\t\t\t\t\t\t\t\t\t'query_type_'\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tset1[ queryTypeParam ] = 'and';\n\t\t\t\t\t\t\t\tset2[ queryTypeParam ] = 'and';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdelete set2[ prop ];\n\t\t\t}\n\t\t}\n\n\t\t$.extend( set1, set2 );\n\n\t\treturn set1;\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\nimport YITH_WCAN_Dropdown from './yith-wcan-dropdown';\n\nexport default class YITH_WCAN_Dropdown_Premium extends YITH_WCAN_Dropdown {\n\t// preset DOM\n\t$preset = false;\n\n\t// retrieve preset containing, if any\n\tgetPreset() {\n\t\tif ( this.preset ) {\n\t\t\treturn this.preset;\n\t\t}\n\n\t\tthis.$preset = this.$originalSelect.closest( '.yith-wcan-filters' );\n\n\t\tif ( ! this.$preset.length ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.$preset;\n\t}\n\n\t// create dropdown\n\t_initTemplate() {\n\t\tif ( ! this.getPreset()?.hasClass( 'horizontal' ) ) {\n\t\t\tsuper._initTemplate();\n\t\t} else {\n\t\t\tconst $dropdownSpan = $( '<div>', {\n\t\t\t\t\tclass: 'dropdown-wrapper',\n\t\t\t\t} ),\n\t\t\t\t$matchingItemsList = $( '<ul/>', {\n\t\t\t\t\tclass: 'matching-items filter-items',\n\t\t\t\t} );\n\n\t\t\t$dropdownSpan.append( $matchingItemsList );\n\n\t\t\tif ( this.options.showSearch ) {\n\t\t\t\tthis._initSearchTemplate( $dropdownSpan );\n\t\t\t}\n\n\t\t\tif ( this.options.paginate ) {\n\t\t\t\tthis._initShowMoreTemplate( $dropdownSpan );\n\t\t\t}\n\n\t\t\tthis.$originalSelect.after( $dropdownSpan );\n\t\t\tthis.$_main = null;\n\t\t\tthis.$_label = null;\n\t\t\tthis.$_dropdown = $dropdownSpan;\n\t\t\tthis.$_items = $matchingItemsList;\n\n\t\t\tthis._populateItems();\n\t\t}\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport { $ } from '../config.js';\nimport YITH_WCAN_Preset from './yith-wcan-preset';\nimport YITH_WCAN_Dropdown_Premium from './yith-wcan-dropdown-premium';\n\nexport default class YITH_WCAN_Preset_Premium extends YITH_WCAN_Preset {\n\t// init object\n\tconstructor( el ) {\n\t\tsuper( el );\n\n\t\tif ( this.isHorizontal() && ! globalThis.yith_wcan_backdrop_init ) {\n\t\t\tthis._initBackdropClick();\n\t\t\tglobalThis.yith_wcan_backdrop_init = true;\n\t\t}\n\t}\n\n\t// handles click outside of toggles, to close them in horizontal mode\n\t_initBackdropClick() {\n\t\tconst isHorizontal = this.isHorizontal();\n\n\t\tif ( isHorizontal ) {\n\t\t\t$( document ).on( 'click', () => {\n\t\t\t\tif ( this.isMobile ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.maybeCloseAllHorizontalToggles();\n\t\t\t} );\n\t\t}\n\t}\n\n\t// check if preset has horizontal layout\n\tisHorizontal() {\n\t\treturn this.$preset?.hasClass( 'horizontal' );\n\t}\n\n\t// apply filters when possible\n\tmaybeFilter( $initiator ) {\n\t\tconst $filter = $initiator.closest( '.yith-wcan-filter' );\n\n\t\t// register status change\n\t\tthis.maybeRegisterStatusChange();\n\n\t\tif (\n\t\t\tthis.isHorizontal() &&\n\t\t\t! this.isMobile &&\n\t\t\tthis.isHorizontalToggle( $filter.find( '.filter-title' ) )\n\t\t) {\n\t\t\t// show count when necessary\n\t\t\tthis.maybeUpdateFiltersCount( $filter );\n\n\t\t\t// skip filtering when started from anything but Save and Clear buttons, in horizontal mode.\n\t\t\tif (\n\t\t\t\t! $initiator.hasClass( 'apply-filters' ) &&\n\t\t\t\t! $initiator.hasClass( 'clear-selection' )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tsuper.maybeFilter();\n\t}\n\n\t// show clear selection anchor\n\tmaybeShowClearFilter( $filter ) {\n\t\tif (\n\t\t\t! this.isFilterActive( $filter ) ||\n\t\t\t! yith_wcan_shortcodes.show_clear_filter\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ! this.isHorizontal() || this.isMobile ) {\n\t\t\tsuper.maybeShowClearFilter( $filter );\n\t\t} else {\n\t\t\t// remove clear selection link if already added.\n\t\t\t$filter.find( '.clear-selection' ).remove();\n\n\t\t\t// add new clear selection link.\n\t\t\tconst $clearButton = $( '<a/>', {\n\t\t\t\tclass: 'clear-selection button',\n\t\t\t\ttext: yith_wcan_shortcodes.labels.clear_selection,\n\t\t\t\trole: 'button',\n\t\t\t} );\n\n\t\t\t$clearButton\n\t\t\t\t.prependTo( $filter.find( '.filter-content-footer' ) )\n\t\t\t\t.on( 'click', ( ev ) => {\n\t\t\t\t\tev.preventDefault();\n\n\t\t\t\t\tthis.deactivateFilter(\n\t\t\t\t\t\t$filter,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tyith_wcan_shortcodes.instant_filters\n\t\t\t\t\t);\n\t\t\t\t\tthis.maybeUpdateFiltersCount( $filter );\n\t\t\t\t\tthis.maybeHideClearFilter( $filter );\n\t\t\t\t\tthis.maybeFilter( $clearButton );\n\n\t\t\t\t\tthis.maybeCloseHorizontalToggle(\n\t\t\t\t\t\t$filter.find( '.filter-title.collapsable' )\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t}\n\t}\n\n\t// init filter\n\t_initFilter( $filter ) {\n\t\tsuper._initFilter( $filter );\n\t\tthis.maybeUpdateFiltersCount( $filter );\n\t}\n\n\t// init tooltip\n\t_initTooltip( $filter, position ) {\n\t\tif ( this.isHorizontal() ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsuper._initTooltip( $filter, position );\n\t}\n\n\t// trigger handling after layout change\n\t_afterLayoutChange() {\n\t\tsuper._afterLayoutChange();\n\n\t\tif ( this.isMobile ) {\n\t\t\tthis._removeAllHorizontalTogglesFooter();\n\t\t} else {\n\t\t\tthis._addAllHorizontalTogglesFooter();\n\t\t}\n\t}\n\n\t// init dropdown object\n\t_initDropdownObject( $dropdown, opts ) {\n\t\treturn new YITH_WCAN_Dropdown_Premium( $dropdown, opts );\n\t}\n\n\t// init toggle to generic toggle/target pair\n\t_initToggle( $toggle, $container, $target ) {\n\t\tconst isHorizontal = this.isHorizontal();\n\n\t\tif ( $container.hasClass( 'closed' ) ) {\n\t\t\t$target.hide();\n\t\t}\n\n\t\tif ( isHorizontal ) {\n\t\t\tthis._addHorizontalToggleFooter( $toggle );\n\t\t}\n\n\t\t$toggle.off( 'click' ).on( 'click', ( ev ) => {\n\t\t\tev.stopPropagation();\n\n\t\t\tif (\n\t\t\t\tisHorizontal &&\n\t\t\t\t! this.isMobile &&\n\t\t\t\t$toggle.hasClass( 'filter-title' )\n\t\t\t) {\n\t\t\t\t// first of all, close other toggles.\n\t\t\t\tthis.maybeCloseAllHorizontalToggles( $target );\n\n\t\t\t\t// now open current one.\n\t\t\t\t$target.toggle( 0, () => {\n\t\t\t\t\t$container.toggleClass( 'opened' ).toggleClass( 'closed' );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t$target.slideToggle( 400, () => {\n\t\t\t\t\t$container.toggleClass( 'opened' ).toggleClass( 'closed' );\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\n\t\tif ( isHorizontal ) {\n\t\t\t$target.on( 'click', ( ev ) => {\n\t\t\t\tev.stopPropagation();\n\t\t\t} );\n\t\t}\n\t}\n\n\t// check if a specific toggle should be shown in Horizontal mode\n\tisHorizontalToggle( $toggle ) {\n\t\tif ( ! this.isHorizontal() ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn $toggle.is( '.collapsable' );\n\t}\n\n\t// close toggle for horizontal layout\n\tmaybeCloseHorizontalToggle( $toggle ) {\n\t\tconst $content = $toggle.next( '.filter-content' );\n\n\t\tif (\n\t\t\t! $content.length ||\n\t\t\t! this.isHorizontal() ||\n\t\t\tthis.isMobile ||\n\t\t\t! $toggle.hasClass( 'filter-title' ) ||\n\t\t\t! this.isHorizontalToggle( $toggle )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t$content.hide();\n\t\t$toggle.toggleClass( 'opened' ).toggleClass( 'closed' );\n\t}\n\n\t// close all Horizontal toggles\n\tmaybeCloseAllHorizontalToggles( $exclude ) {\n\t\t$( '.yith-wcan-filters.enhanced' )\n\t\t\t.find( '.filter-title.collapsable' )\n\t\t\t.next( '.filter-content' )\n\t\t\t.not( $exclude )\n\t\t\t.hide()\n\t\t\t.prev( '.filter-title' )\n\t\t\t.removeClass( 'opened' )\n\t\t\t.addClass( 'closed' );\n\t}\n\n\t// add filter content footer for horizontal layout\n\t_addHorizontalToggleFooter( $toggle ) {\n\t\tconst $content = $toggle.next( '.filter-content' );\n\n\t\tif (\n\t\t\t! $content.length ||\n\t\t\t! this.isHorizontal() ||\n\t\t\tthis.isMobile ||\n\t\t\t! $toggle.hasClass( 'filter-title' ) ||\n\t\t\t! this.isHorizontalToggle( $toggle )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst $currentFilter = $toggle.closest( '.yith-wcan-filter' ),\n\t\t\t$footer = $( '<div/>', {\n\t\t\t\tclass: 'filter-content-footer',\n\t\t\t} ),\n\t\t\t$applyFilterButton = $( '<a/>', {\n\t\t\t\tclass: 'apply-filters button alt',\n\t\t\t\ttext: yith_wcan_shortcodes.labels.save,\n\t\t\t} );\n\n\t\t$applyFilterButton.on( 'click', () => {\n\t\t\tthis.maybeFilter( $applyFilterButton );\n\t\t\tthis.maybeCloseAllHorizontalToggles( $toggle );\n\t\t} );\n\n\t\t$footer.append( $applyFilterButton ).appendTo( $content );\n\t}\n\n\t// add filter content footer for all horizontal toggles\n\t_addAllHorizontalTogglesFooter() {\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this ),\n\t\t\t\t$toggle = $filter.find( '.filter-title.collapsable' );\n\n\t\t\tif ( ! $toggle.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself._addHorizontalToggleFooter( $toggle );\n\t\t} );\n\t}\n\n\t// remove filter content footer for horizontal layout\n\t_removeHorizontalToggleFooter( $toggle ) {\n\t\tconst $content = $toggle.next( '.filter-content' );\n\n\t\tif ( ! $content.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t$content.find( '.filter-content-footer' ).remove();\n\t}\n\n\t// add filter content footer for all horizontal toggles\n\t_removeAllHorizontalTogglesFooter() {\n\t\tconst self = this;\n\n\t\tthis.getFilters().each( function () {\n\t\t\tconst $filter = $( this ),\n\t\t\t\t$toggle = $filter.find( '.filter-title.collapsable' );\n\n\t\t\tif ( ! $toggle.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself._removeHorizontalToggleFooter( $toggle );\n\t\t} );\n\t}\n\n\t// show filters count\n\tmaybeUpdateFiltersCount( $filter ) {\n\t\tconst $toggle = $filter.find( '.filter-title.collapsable' );\n\n\t\t// remove current count\n\t\t$toggle.find( '.filter-count' ).remove();\n\n\t\tif (\n\t\t\t! $toggle.length ||\n\t\t\t! this.isHorizontalToggle( $toggle ) ||\n\t\t\t! this.isFilterActive( $filter )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst count = this.countActiveItems( $filter );\n\n\t\t// if there is any filter active, show count\n\t\tif ( ! count ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst $counter = $( '<span/>', {\n\t\t\tclass: 'filter-count',\n\t\t\ttext: count,\n\t\t} );\n\n\t\t$toggle.append( $counter );\n\t}\n}\n","'use strict';\n\n/* global globalThis, jQuery, yith_wcan_shortcodes, accounting */\n\nimport YITH_WCAN_Filter from './modules/yith-wcan-filter';\nimport YITH_WCAN_Filter_Labels from './modules/yith-wcan-filter-labels';\nimport YITH_WCAN_Reset_Button from './modules/yith-wcan-reset-button';\nimport YITH_WCAN_Modal_Opener from './modules/yith-wcan-modal-opener';\nimport YITH_WCAN_Preset from './modules/yith-wcan-preset-premium';\n\njQuery( function ( $ ) {\n\t$( document )\n\t\t.on(\n\t\t\t'yith_wcan_init_shortcodes yith_plugin_fw_gutenberg_success_do_shortcode',\n\t\t\tfunction () {\n\t\t\t\t$( '.yith-wcan-filters' )\n\t\t\t\t\t.not( '.enhanced' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\tnew YITH_WCAN_Preset( $( this ) );\n\t\t\t\t\t} );\n\n\t\t\t\t$( '.yith-wcan-active-filters' )\n\t\t\t\t\t.not( '.enhanced' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\tnew YITH_WCAN_Filter_Labels( $( this ) );\n\t\t\t\t\t} );\n\n\t\t\t\t$( '.yith-wcan-reset-filters' )\n\t\t\t\t\t.not( '.enhanced' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\tnew YITH_WCAN_Reset_Button( $( this ) );\n\t\t\t\t\t} );\n\n\t\t\t\t$( '.yith-wcan-filters-opener' )\n\t\t\t\t\t.not( '.enhanced' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\tnew YITH_WCAN_Modal_Opener( $( this ) );\n\t\t\t\t\t} );\n\t\t\t}\n\t\t)\n\t\t.trigger( 'yith_wcan_init_shortcodes' );\n\n\tglobalThis.product_filter = new YITH_WCAN_Filter();\n} );\n"],"names":["$","jQuery","$body","YITH_WCAN_Filter","location","search","initPopState","initialized","pushUrlToHistory","window","on","history","state","_yithWcan","reload","filters","target","preset","targetUrl","$target","customFilters","document","triggerHandler","block","buildUrl","yith_wcan_shortcodes","ajax_filters","title","doingAjax","_doAjax","done","response","searchAlternativeUrl","_beforeFilter","refreshFragments","pageTitle","originalSearch","unblock","_afterFilter","trigger","closest","submit","filtered","Object","keys","length","addClass","removeClass","queryParam","query_param","params","url","base_url","origin","pathname","self","haveFilters","session_param","replace","RegExp","searchParams","split","reduce","a","v","items","isFilterParam","extend","i","_cleanParam","defaultUrl","matches","indexOf","match","change_browser_url","navigator","userAgent","pushState","responseDom","createElement","$response","innerHTML","$preset","$destination","find","replaceWith","first","content","param","process_sanitize","skip_sanitize","encodeURIComponent","xhr","abort","headers","ajax","$el","fn","background","loader","message","overlayCSS","opacity","supportedParams","customParams","concat","supported_taxonomies","map","YITH_WCAN_Filter_Labels","el","$label_set","_initLabels","data","getLabels","each","$label","_initLabel","ev","disableLabel","preventDefault","$labels","properties","result","deactivateFilterByProperties","YITH_WCAN_Reset_Button","$reset","deactivateAllFilters","closeModal","YITH_WCAN_Modal_Opener","$button","_initPreset","_initResponsive","_initActions","modal_on_mobile","hide","media","matchMedia","mobile_media_query","isMobile","_afterLayoutChange","resize","openModal","show","YITH_WCAN_Dropdown","opts","$originalSelect","is","defaultPerPage","defaultOrder","defaultAll","defaults","showSearch","paginate","perPage","order","getElements","labels","emptyLabel","empty_option","searchPlaceholder","search_placeholder","noItemsFound","no_items","showMore","show_more","options","_hideSelect","_initTemplate","$mainSpan","$labelSpan","html","getLabel","$dropdownSpan","$matchingItemsList","append","_initSearchTemplate","_initShowMoreTemplate","after","$_main","$_label","$_dropdown","$_items","$dropdwonSpan","$container","$search","name","type","placeholder","prependTo","$_search","$showMore","text","loadNextPage","bind","$_showMore","stopPropagation","toggleDropdown","_populateItems","$li","value","isActive","hasClass","isValueSelected","toggleClass","_changeItemStatus","siblings","input","parent","prop","change","selfOriginated","_selectItem","_deselectItem","updateLabel","globalThis","yith_wcan_dropdown_init","_closeAllDropdowns","_afterDropdownOpen","dropdowns","filter","select","closeDropdown","_closeOtherDropdowns","val","limit","matchingElements","$options","getOptions","promise","Promise","resolve","t","label","regex","test","push","then","retrievedElements","_formatItems","indexes","hasMore","sort","b","mod","slice","active","option","getOptionByValue","$item","attr","$anchor","template","count","href","$checkbox","prepend","page","parseInt","getMatchingElements","resultSet","matchingItems","_emptyItems","_hideLoadMore","currentPage","unshift","_generateItem","_showLoadMore","status","$option","hasSelectedValues","getSelectedLabels","join","getSelectedOptions","found","getSelectedValues","toString","values","YITH_WCAN_Preset","_regiterStatus","_initFilterButton","_initFilters","getFilters","$filter","_initFilter","maybeShowClearAllFilters","$filterButtons","handleChange","$currentFilter","multiple","$items","not","children","activeFilters","maybeFilter","maybeToggleClearAllFilters","maybeToggleClearFilter","delegateTarget","call","$input","_initTooltip","_initPriceSlider","_initDropdown","_initCollapsable","maybeShowClearFilter","_initCustomInput","$dropdown","$current","position","th","tooltip","wrapperWidth","outerWidth","left","width","container","css","toFixed","fadeIn","fadeOut","remove","selectWoo","_initDropdownObject","terms_per_page","$minInput","$maxInput","min","parseFloat","max","currentMin","currentMax","step","handleSliderChange","sliderTimeout","clearTimeout","setTimeout","ionRangeSlider","skin","from","to","min_interval","values_separator","prettify","formatPrice","onChange","onFinish","add","off","_initTitleCollapsable","_initHierarchyCollapsable","$title","_initToggle","parents","show_current_children","$t","$toggle","appendTo","slideToggle","containerClass","wrap","originalFilters","getFiltersProperties","_addCloseModalButton","_addApplyFiltersModalButton","_switchToCollapsables","removeAttr","_removeCloseModalButton","_removeApplyFiltersModalButton","_switchBackCollapsables","$closeButton","close","modalElements","closeButton","$filterButton","show_results","applyFiltersButton","removeData","$filters","isFilterActive","end","currentFilters","currentStr","JSON","stringify","originalStr","dirty","$initiator","maybeRegisterStatusChange","instant_filters","product_filter","doFilter","newPreset","scroll_top","targetOffset","offset","top","scroll_target","scrollTarget","animate","scrollTop","getActiveFilters","filterType","filteredActive","Math","abs","filteredProperties","$active","activeTerms","taxonomy","isAttr","relation","get","pop","glue","rating_filter","price_ranges","min_price","max_price","onsale_filter","instock_filter","featured_filter","orderby","filterProperties","getFilterProperties","mergeProperties","hasProp","includes","maybeHideClearFilter","isAnyFilterActive","maybeHideClearAllFilters","show_clear_filter","clear_selection","role","deactivateFilter","clear_all_selections","$activeItems","click","formattedRange","$priceSlider","getFiltersByProperties","toggles_open_on_modal","_openAllCollapsables","_closeAllCollapsables","price","accounting","formatMoney","symbol","currency_format","decimal","thousand","precision","format","set1","set2","hasOwnProperty","newValue","index","arr","queryTypeParam","YITH_WCAN_Dropdown_Premium","getPreset","YITH_WCAN_Preset_Premium","isHorizontal","yith_wcan_backdrop_init","_initBackdropClick","maybeCloseAllHorizontalToggles","isHorizontalToggle","maybeUpdateFiltersCount","$clearButton","maybeCloseHorizontalToggle","_removeAllHorizontalTogglesFooter","_addAllHorizontalTogglesFooter","_addHorizontalToggleFooter","toggle","$content","next","$exclude","prev","$footer","$applyFilterButton","save","_removeHorizontalToggleFooter","countActiveItems","$counter"],"sourceRoot":""}