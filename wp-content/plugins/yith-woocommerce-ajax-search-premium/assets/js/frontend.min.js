jQuery(function(d){"use strict";var e=d(".yith-s"),t="undefined"!=typeof woocommerce_params&&"undefined"!=typeof woocommerce_params.ajax_loader_url?woocommerce_params.ajax_loader_url:yith_wcas_params.loading,a=""==e.data("loader-icon")?t:e.data("loader-icon"),p=e.data("min-chars");e.each(function(){var n=d(this),o=n.closest("form"),i=!1,r=o.find(".search_categories"),s=o.find(".yit_wcas_post_type"),e=o.find("#yith-searchsubmit"),c=0<o.find('[name="lang"]').length?o.find('[name="lang"]').val():"",l=void 0===n.data("append-to")?n.closest(".yith-ajaxsearchform-container"):n.closest(n.data("append-to")),t=yith_wcas_params.ajax_url.toString().replace("%%endpoint%%","yith_ajax_search_products");e.on("click",function(){if(r.length)o.submit();else if(""==o.find(".yith-s").val())return!1;return!0}),n.yithautocomplete({minChars:p,maxHeight:"auto",appendTo:l,triggerSelectOnValidInput:!1,serviceUrl:t+"&post_type="+s.val()+"&lang="+c+"&action=yith_ajax_search_products",onSearchStart:function(){n.css({"background-image":"url("+a+")","background-repeat":"no-repeat","background-position":"center right"})},onSearchComplete:function(){n.css("background-image","none"),d(window).trigger("resize"),n.trigger("focus"),d(document).trigger("yith_wcas_done")},onSelect:function(e){-1!=e.id&&(d(this).val(""),window.location.href=e.url)},beforeRender:function(){var e,t,a;"true"==yith_wcas_params.show_all&&i&&(a={s:n.val(),post_type:o.find(".yit_wcas_post_type").val()},0<o.find(".search_categories").length&&(a.product_cat=o.find(".search_categories").val()),t=-1!==(e=o.attr("action")).indexOf("?")?"&":"?",a='<div class="link-result"><a href="'+(e+t+d.param(a))+'">'+yith_wcas_params.show_all_text+"</a></div>",l.find(".autocomplete-suggestions").append(a))},transformResult:function(e){return e="string"==typeof e?JSON.parse(e):e,i=e.results,e},formatResult:function(e,t){for(var a="("+d.YithAutocomplete.utils.escapeRegExChars(t)+")",n=t.split(" ").filter(function(e){return 0!=e.length}),o=0;o<n.length;o++)n[o]="("+d.YithAutocomplete.utils.escapeRegExChars(n[o])+")";t="";"undefined"!=typeof e.img&&(t+=e.img),t+='<div class="yith_wcas_result_content"><div class="title">';for(var i=e.value,i=d("<div>").html(i).html(),o=0;o<n.length;o++)3<n[o].length&&(i=i.replace(new RegExp(n[o]+"(?![^<]*>|[^<>]*<\\/)","gi"),"<strong>$1</strong>"));return t+=i,t+="</div>","undefined"!=typeof e.sku&&(t+=e.sku),"undefined"!=typeof e.product_categories&&(t+=" "+e.product_categories),"undefined"!=typeof e.div_badge_open&&(t+=e.div_badge_open),"undefined"!=typeof e.on_sale&&(t+=e.on_sale),"undefined"!=typeof e.outofstock&&(t+=e.outofstock),"undefined"!=typeof e.featured&&(t+=e.featured),"undefined"!=typeof e.div_badge_close&&(t+=e.div_badge_close),"undefined"!=typeof e.price&&""!=e.price&&(t+=" "+yith_wcas_params.price_label+" "+e.price),"undefined"!=typeof e.excerpt&&(t+=" "+e.excerpt.replace(new RegExp(a,"gi"),"<strong>$1</strong>")),t+="</div>"}}),r.length&&r.on("change",function(e){var t=n.yithautocomplete(),a=yith_wcas_params.ajax_url.toString().replace("%%endpoint%%","yith_ajax_search_products");""!=r.val()?t.setOptions({serviceUrl:a+"&product_cat="+r.val()+"&lang="+c}):t.setOptions({serviceUrl:a+"&lang="+c}),t.hide(),t.onValueChange()}),s.length&&("any"==s.val()?r.prop("disabled",!0):r.prop("disabled",!1),s.on("change",function(e){var t=n.yithautocomplete(),a=yith_wcas_params.ajax_url.toString().replace("%%endpoint%%","yith_ajax_search_products");"any"==s.val()?r.prop("disabled",!0):r.prop("disabled",!1),""!=s.val()?t.setOptions({serviceUrl:a+"&post_type="+s.val()+"&lang="+c}):t.setOptions({serviceUrl:a+"&lang="+c}),t.hide(),t.onValueChange()}))})});